var duckdb=(()=>{var im=Object.create;var fi=Object.defineProperty,sm=Object.defineProperties,om=Object.getOwnPropertyDescriptor,am=Object.getOwnPropertyDescriptors,cm=Object.getOwnPropertyNames,ju=Object.getOwnPropertySymbols,um=Object.getPrototypeOf,Gu=Object.prototype.hasOwnProperty,lm=Object.prototype.propertyIsEnumerable;var Yu=(r,t,e)=>t in r?fi(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Rr=(r,t)=>{for(var e in t||(t={}))Gu.call(t,e)&&Yu(r,e,t[e]);if(ju)for(var e of ju(t))lm.call(t,e)&&Yu(r,e,t[e]);return r},hi=(r,t)=>sm(r,am(t)),$u=r=>fi(r,"__esModule",{value:!0});var dm=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var un=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),ln=(r,t)=>{for(var e in t)fi(r,e,{get:t[e],enumerable:!0})},Xu=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of cm(t))!Gu.call(r,i)&&(e||i!=="default")&&fi(r,i,{get:()=>t[i],enumerable:!(n=om(t,i))||n.enumerable});return r},Ku=(r,t)=>Xu($u(fi(r!=null?im(um(r)):{},"default",!t&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),fm=(r=>(t,e)=>r&&r.get(t)||(e=Xu($u({}),t,1),r&&r.set(t,e),e))(typeof WeakMap!="undefined"?new WeakMap:0);var _l=un((ub,ls)=>{var Ju,qu,Zu,Qu,tl,el,rl,nl,il,cs,jo,sl,ol,al,Bn,cl,ul,ll,dl,fl,hl,pl,ml,us;(function(r){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(n){r(e(t,e(n)))}):typeof ls=="object"&&typeof ls.exports=="object"?r(e(t,e(ls.exports))):r(e(t));function e(n,i){return n!==t&&(typeof Object.create=="function"?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(s,o){return n[s]=i?i(s,o):o}}})(function(r){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])};Ju=function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function s(){this.constructor=n}n.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)},qu=Object.assign||function(n){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])}return n},Zu=function(n,i){var s={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.indexOf(o)<0&&(s[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(n);u<o.length;u++)i.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(n,o[u])&&(s[o[u]]=n[o[u]]);return s},Qu=function(n,i,s,o){var u=arguments.length,a=u<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,i,s,o);else for(var m=n.length-1;m>=0;m--)(h=n[m])&&(a=(u<3?h(a):u>3?h(i,s,a):h(i,s))||a);return u>3&&a&&Object.defineProperty(i,s,a),a},tl=function(n,i){return function(s,o){i(s,o,n)}},el=function(n,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,i)},rl=function(n,i,s,o){function u(a){return a instanceof s?a:new s(function(h){h(a)})}return new(s||(s=Promise))(function(a,h){function m(I){try{S(o.next(I))}catch(Z){h(Z)}}function g(I){try{S(o.throw(I))}catch(Z){h(Z)}}function S(I){I.done?a(I.value):u(I.value).then(m,g)}S((o=o.apply(n,i||[])).next())})},nl=function(n,i){var s={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,u,a,h;return h={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function m(S){return function(I){return g([S,I])}}function g(S){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,u&&(a=S[0]&2?u.return:S[0]?u.throw||((a=u.return)&&a.call(u),0):u.next)&&!(a=a.call(u,S[1])).done)return a;switch(u=0,a&&(S=[S[0]&2,a.value]),S[0]){case 0:case 1:a=S;break;case 4:return s.label++,{value:S[1],done:!1};case 5:s.label++,u=S[1],S=[0];continue;case 7:S=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(S[0]===6||S[0]===2)){s=0;continue}if(S[0]===3&&(!a||S[1]>a[0]&&S[1]<a[3])){s.label=S[1];break}if(S[0]===6&&s.label<a[1]){s.label=a[1],a=S;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(S);break}a[2]&&s.ops.pop(),s.trys.pop();continue}S=i.call(n,s)}catch(I){S=[6,I],u=0}finally{o=a=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},il=function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&us(i,n,s)},us=Object.create?function(n,i,s,o){o===void 0&&(o=s),Object.defineProperty(n,o,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]},cs=function(n){var i=typeof Symbol=="function"&&Symbol.iterator,s=i&&n[i],o=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},jo=function(n,i){var s=typeof Symbol=="function"&&n[Symbol.iterator];if(!s)return n;var o=s.call(n),u,a=[],h;try{for(;(i===void 0||i-- >0)&&!(u=o.next()).done;)a.push(u.value)}catch(m){h={error:m}}finally{try{u&&!u.done&&(s=o.return)&&s.call(o)}finally{if(h)throw h.error}}return a},sl=function(){for(var n=[],i=0;i<arguments.length;i++)n=n.concat(jo(arguments[i]));return n},ol=function(){for(var n=0,i=0,s=arguments.length;i<s;i++)n+=arguments[i].length;for(var o=Array(n),u=0,i=0;i<s;i++)for(var a=arguments[i],h=0,m=a.length;h<m;h++,u++)o[u]=a[h];return o},al=function(n,i,s){if(s||arguments.length===2)for(var o=0,u=i.length,a;o<u;o++)(a||!(o in i))&&(a||(a=Array.prototype.slice.call(i,0,o)),a[o]=i[o]);return n.concat(a||Array.prototype.slice.call(i))},Bn=function(n){return this instanceof Bn?(this.v=n,this):new Bn(n)},cl=function(n,i,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=s.apply(n,i||[]),u,a=[];return u={},h("next"),h("throw"),h("return"),u[Symbol.asyncIterator]=function(){return this},u;function h(X){o[X]&&(u[X]=function(ht){return new Promise(function(lt,vt){a.push([X,ht,lt,vt])>1||m(X,ht)})})}function m(X,ht){try{g(o[X](ht))}catch(lt){Z(a[0][3],lt)}}function g(X){X.value instanceof Bn?Promise.resolve(X.value.v).then(S,I):Z(a[0][2],X)}function S(X){m("next",X)}function I(X){m("throw",X)}function Z(X,ht){X(ht),a.shift(),a.length&&m(a[0][0],a[0][1])}},ul=function(n){var i,s;return i={},o("next"),o("throw",function(u){throw u}),o("return"),i[Symbol.iterator]=function(){return this},i;function o(u,a){i[u]=n[u]?function(h){return(s=!s)?{value:Bn(n[u](h)),done:u==="return"}:a?a(h):h}:a}},ll=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n[Symbol.asyncIterator],s;return i?i.call(n):(n=typeof cs=="function"?cs(n):n[Symbol.iterator](),s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s);function o(a){s[a]=n[a]&&function(h){return new Promise(function(m,g){h=n[a](h),u(m,g,h.done,h.value)})}}function u(a,h,m,g){Promise.resolve(g).then(function(S){a({value:S,done:m})},h)}},dl=function(n,i){return Object.defineProperty?Object.defineProperty(n,"raw",{value:i}):n.raw=i,n};var e=Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i};fl=function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var s in n)s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)&&us(i,n,s);return e(i,n),i},hl=function(n){return n&&n.__esModule?n:{default:n}},pl=function(n,i,s,o){if(s==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?n!==i||!o:!i.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?o:s==="a"?o.call(n):o?o.value:i.get(n)},ml=function(n,i,s,o,u){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?n!==i||!u:!i.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?u.call(n,s):u?u.value=s:i.set(n,s),s},r("__extends",Ju),r("__assign",qu),r("__rest",Zu),r("__decorate",Qu),r("__param",tl),r("__metadata",el),r("__awaiter",rl),r("__generator",nl),r("__exportStar",il),r("__createBinding",us),r("__values",cs),r("__read",jo),r("__spread",sl),r("__spreadArrays",ol),r("__spreadArray",al),r("__await",Bn),r("__asyncGenerator",cl),r("__asyncDelegator",ul),r("__asyncValues",ll),r("__makeTemplateObject",dl),r("__importStar",fl),r("__importDefault",hl),r("__classPrivateFieldGet",pl),r("__classPrivateFieldSet",ml)})});var dc=un(()=>{});var _f=un(()=>{});var yf=un(()=>{});var bf=un(()=>{});var gf=un(()=>{});var Ff=un((exports,module)=>{(function(){"use strict";var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&typeof module=="object"&&module.exports,AMD=typeof define=="function"&&define.amd,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(r){return Object.prototype.toString.call(r)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(r){return typeof r=="object"&&r.buffer&&r.buffer.constructor===ArrayBuffer});var createOutputMethod=function(r,t){return function(e){return new Sha256(t,!0).update(e)[r]()}},createMethod=function(r){var t=createOutputMethod("hex",r);NODE_JS&&(t=nodeWrap(t,r)),t.create=function(){return new Sha256(r)},t.update=function(i){return t.create().update(i)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createOutputMethod(n,r)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(r){if(typeof r=="string")return crypto.createHash(algorithm).update(r,"utf8").digest("hex");if(r==null)throw new Error(ERROR);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(r)).digest("hex"):method(r)};return nodeMethod},createHmacOutputMethod=function(r,t){return function(e,n){return new HmacSha256(e,t,!0).update(n)[r]()}},createHmacMethod=function(r){var t=createHmacOutputMethod("hex",r);t.create=function(i){return new HmacSha256(i,r)},t.update=function(i,s){return t.create(i).update(s)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createHmacOutputMethod(n,r)}return t};function Sha256(r,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=r}Sha256.prototype.update=function(r){if(!this.finalized){var t,e=typeof r;if(e!=="string"){if(e==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);t=!0}for(var n,i=0,s,o=r.length,u=this.blocks;i<o;){if(this.hashed&&(this.hashed=!1,u[0]=this.block,u[16]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0),t)for(s=this.start;i<o&&s<64;++i)u[s>>2]|=r[i]<<SHIFT[s++&3];else for(s=this.start;i<o&&s<64;++i)n=r.charCodeAt(i),n<128?u[s>>2]|=n<<SHIFT[s++&3]:n<2048?(u[s>>2]|=(192|n>>6)<<SHIFT[s++&3],u[s>>2]|=(128|n&63)<<SHIFT[s++&3]):n<55296||n>=57344?(u[s>>2]|=(224|n>>12)<<SHIFT[s++&3],u[s>>2]|=(128|n>>6&63)<<SHIFT[s++&3],u[s>>2]|=(128|n&63)<<SHIFT[s++&3]):(n=65536+((n&1023)<<10|r.charCodeAt(++i)&1023),u[s>>2]|=(240|n>>18)<<SHIFT[s++&3],u[s>>2]|=(128|n>>12&63)<<SHIFT[s++&3],u[s>>2]|=(128|n>>6&63)<<SHIFT[s++&3],u[s>>2]|=(128|n&63)<<SHIFT[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=u[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,t=this.lastByteIndex;r[16]=this.block,r[t>>2]|=EXTRA[t&3],this.block=r[16],t>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var r=this.h0,t=this.h1,e=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,u=this.h7,a=this.blocks,h,m,g,S,I,Z,X,ht,lt,vt,x;for(h=16;h<64;++h)I=a[h-15],m=(I>>>7|I<<25)^(I>>>18|I<<14)^I>>>3,I=a[h-2],g=(I>>>17|I<<15)^(I>>>19|I<<13)^I>>>10,a[h]=a[h-16]+m+a[h-7]+g<<0;for(x=t&e,h=0;h<64;h+=4)this.first?(this.is224?(ht=300032,I=a[0]-1413257819,u=I-150054599<<0,n=I+24177077<<0):(ht=704751109,I=a[0]-210244248,u=I-1521486534<<0,n=I+143694565<<0),this.first=!1):(m=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),g=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),ht=r&t,S=ht^r&e^x,X=i&s^~i&o,I=u+g+X+K[h]+a[h],Z=m+S,u=n+I<<0,n=I+Z<<0),m=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),g=(u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7),lt=n&r,S=lt^n&t^ht,X=u&i^~u&s,I=o+g+X+K[h+1]+a[h+1],Z=m+S,o=e+I<<0,e=I+Z<<0,m=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),g=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),vt=e&n,S=vt^e&r^lt,X=o&u^~o&i,I=s+g+X+K[h+2]+a[h+2],Z=m+S,s=t+I<<0,t=I+Z<<0,m=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),g=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),x=t&e,S=x^t&n^vt,X=s&o^~s&u,I=i+g+X+K[h+3]+a[h+3],Z=m+S,i=r+I<<0,r=I+Z<<0;this.h0=this.h0+r<<0,this.h1=this.h1+t<<0,this.h2=this.h2+e<<0,this.h3=this.h3+n<<0,this.h4=this.h4+i<<0,this.h5=this.h5+s<<0,this.h6=this.h6+o<<0,this.h7=this.h7+u<<0},Sha256.prototype.hex=function(){this.finalize();var r=this.h0,t=this.h1,e=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,u=this.h7,a=HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15];return this.is224||(a+=HEX_CHARS[u>>28&15]+HEX_CHARS[u>>24&15]+HEX_CHARS[u>>20&15]+HEX_CHARS[u>>16&15]+HEX_CHARS[u>>12&15]+HEX_CHARS[u>>8&15]+HEX_CHARS[u>>4&15]+HEX_CHARS[u&15]),a},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var r=this.h0,t=this.h1,e=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,u=this.h7,a=[r>>24&255,r>>16&255,r>>8&255,r&255,t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,o>>24&255,o>>16&255,o>>8&255,o&255];return this.is224||a.push(u>>24&255,u>>16&255,u>>8&255,u&255),a},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(this.is224?28:32),t=new DataView(r);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),r};function HmacSha256(r,t,e){var n,i=typeof r;if(i==="string"){var s=[],o=r.length,u=0,a;for(n=0;n<o;++n)a=r.charCodeAt(n),a<128?s[u++]=a:a<2048?(s[u++]=192|a>>6,s[u++]=128|a&63):a<55296||a>=57344?(s[u++]=224|a>>12,s[u++]=128|a>>6&63,s[u++]=128|a&63):(a=65536+((a&1023)<<10|r.charCodeAt(++n)&1023),s[u++]=240|a>>18,s[u++]=128|a>>12&63,s[u++]=128|a>>6&63,s[u++]=128|a&63);r=s}else if(i==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);r.length>64&&(r=new Sha256(t,!0).update(r).array());var h=[],m=[];for(n=0;n<64;++n){var g=r[n]||0;h[n]=92^g,m[n]=54^g}Sha256.call(this,t,e),this.update(m),this.oKeyPad=h,this.inner=!0,this.sharedMemory=e}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var r=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(r),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&define(function(){return exports}))})()});var rb={};ln(rb,{registerWorker:()=>Of});var yl=Ku(_l(),1),{__extends:lb,__assign:db,__rest:bl,__decorate:fb,__param:hb,__metadata:pb,__awaiter:A,__generator:mb,__exportStar:_b,__createBinding:yb,__values:bb,__read:gb,__spread:wb,__spreadArrays:vb,__spreadArray:Sb,__await:j,__asyncGenerator:ae,__asyncDelegator:Fn,__asyncValues:Oe,__makeTemplateObject:Ib,__importStar:Ab,__importDefault:xb,__classPrivateFieldGet:Bb,__classPrivateFieldSet:Fb}=yl.default;var Jo={};ln(Jo,{compareArrayLike:()=>Ko,joinUint8Arrays:()=>fe,memcpy:()=>Tn,rebaseValueOffsets:()=>bi,toArrayBufferView:()=>Y,toArrayBufferViewAsyncIterator:()=>je,toArrayBufferViewIterator:()=>er,toBigInt64Array:()=>gm,toBigUint64Array:()=>Sm,toFloat32Array:()=>Im,toFloat32ArrayAsyncIterator:()=>Pm,toFloat32ArrayIterator:()=>Om,toFloat64Array:()=>Am,toFloat64ArrayAsyncIterator:()=>Vm,toFloat64ArrayIterator:()=>Mm,toInt16Array:()=>bm,toInt16ArrayAsyncIterator:()=>Um,toInt16ArrayIterator:()=>Fm,toInt32Array:()=>dn,toInt32ArrayAsyncIterator:()=>Lm,toInt32ArrayIterator:()=>Tm,toInt8Array:()=>ym,toInt8ArrayAsyncIterator:()=>km,toInt8ArrayIterator:()=>Bm,toUint16Array:()=>wm,toUint16ArrayAsyncIterator:()=>Nm,toUint16ArrayIterator:()=>Dm,toUint32Array:()=>vm,toUint32ArrayAsyncIterator:()=>Cm,toUint32ArrayIterator:()=>Em,toUint8Array:()=>M,toUint8ArrayAsyncIterator:()=>Xo,toUint8ArrayIterator:()=>$o,toUint8ClampedArray:()=>xm,toUint8ClampedArrayAsyncIterator:()=>Hm,toUint8ClampedArrayIterator:()=>Rm});var hm=new TextDecoder("utf-8"),pi=r=>hm.decode(r),pm=new TextEncoder,kr=r=>pm.encode(r);var[Eb,ds]=(()=>{let r=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw r()}return t.asIntN=()=>{throw r()},t.asUintN=()=>{throw r()},typeof BigInt<"u"?[BigInt,!0]:[t,!1]})(),[mi,Ob]=(()=>{let r=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[_i,Mb]=(()=>{let r=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})();var mm=r=>typeof r=="number",gl=r=>typeof r=="boolean",Nt=r=>typeof r=="function",te=r=>r!=null&&Object(r)===r,ze=r=>te(r)&&Nt(r.then);var We=r=>te(r)&&Nt(r[Symbol.iterator]),Me=r=>te(r)&&Nt(r[Symbol.asyncIterator]),fs=r=>te(r)&&te(r.schema);var hs=r=>te(r)&&"done"in r&&"value"in r;var ps=r=>te(r)&&Nt(r.stat)&&mm(r.fd);var ms=r=>te(r)&&yi(r.body),_s=r=>"_getDOMStream"in r&&"_getNodeStream"in r,wl=r=>te(r)&&Nt(r.abort)&&Nt(r.getWriter)&&!_s(r),yi=r=>te(r)&&Nt(r.cancel)&&Nt(r.getReader)&&!_s(r),vl=r=>te(r)&&Nt(r.end)&&Nt(r.write)&&gl(r.writable)&&!_s(r),ys=r=>te(r)&&Nt(r.read)&&Nt(r.pipe)&&gl(r.readable)&&!_s(r),Sl=r=>te(r)&&Nt(r.clear)&&Nt(r.bytes)&&Nt(r.position)&&Nt(r.setPosition)&&Nt(r.capacity)&&Nt(r.getBufferIdentifier)&&Nt(r.createLong);var Go=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function _m(r){let t=r[0]?[r[0]]:[],e,n,i,s;for(let o,u,a=0,h=0,m=r.length;++a<m;){if(o=t[h],u=r[a],!o||!u||o.buffer!==u.buffer||u.byteOffset<o.byteOffset){u&&(t[++h]=u);continue}if({byteOffset:e,byteLength:i}=o,{byteOffset:n,byteLength:s}=u,e+i<n||n+s<e){u&&(t[++h]=u);continue}t[h]=new Uint8Array(o.buffer,e,n-e+s)}return t}function Tn(r,t,e=0,n=t.byteLength){let i=r.byteLength,s=new Uint8Array(r.buffer,r.byteOffset,i),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,i));return s.set(o,e),r}function fe(r,t){let e=_m(r),n=e.reduce((m,g)=>m+g.byteLength,0),i,s,o,u=0,a=-1,h=Math.min(t||Number.POSITIVE_INFINITY,n);for(let m=e.length;++a<m;){if(i=e[a],s=i.subarray(0,Math.min(i.length,h-u)),h<=u+s.length){s.length<i.length?e[a]=i.subarray(s.length):s.length===i.length&&a++,o?Tn(o,s,u):o=s;break}Tn(o||(o=new Uint8Array(h)),s,u),u+=s.length}return[o||new Uint8Array(0),e.slice(a),n-(o?o.byteLength:0)]}function Y(r,t){let e=hs(t)?t.value:t;return e instanceof r?r===Uint8Array?new r(e.buffer,e.byteOffset,e.byteLength):e:e?(typeof e=="string"&&(e=kr(e)),e instanceof ArrayBuffer?new r(e):e instanceof Go?new r(e):Sl(e)?Y(r,e.bytes()):ArrayBuffer.isView(e)?e.byteLength<=0?new r(0):new r(e.buffer,e.byteOffset,e.byteLength/r.BYTES_PER_ELEMENT):r.from(e)):new r(0)}var ym=r=>Y(Int8Array,r),bm=r=>Y(Int16Array,r),dn=r=>Y(Int32Array,r),gm=r=>Y(mi,r),M=r=>Y(Uint8Array,r),wm=r=>Y(Uint16Array,r),vm=r=>Y(Uint32Array,r),Sm=r=>Y(_i,r),Im=r=>Y(Float32Array,r),Am=r=>Y(Float64Array,r),xm=r=>Y(Uint8ClampedArray,r),Yo=r=>(r.next(),r);function*er(r,t){let e=function*(i){yield i},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Go?e(t):We(t)?t:e(t);return yield*Yo(function*(i){let s=null;do s=i.next(yield Y(r,s));while(!s.done)}(n[Symbol.iterator]())),new r}var Bm=r=>er(Int8Array,r),Fm=r=>er(Int16Array,r),Tm=r=>er(Int32Array,r),$o=r=>er(Uint8Array,r),Dm=r=>er(Uint16Array,r),Em=r=>er(Uint32Array,r),Om=r=>er(Float32Array,r),Mm=r=>er(Float64Array,r),Rm=r=>er(Uint8ClampedArray,r);function je(r,t){return ae(this,arguments,function*(){if(ze(t))return yield j(yield j(yield*Fn(Oe(je(r,yield j(t))))));let n=function(o){return ae(this,arguments,function*(){yield yield j(yield j(o))})},i=function(o){return ae(this,arguments,function*(){yield j(yield*Fn(Oe(Yo(function*(u){let a=null;do a=u.next(yield a==null?void 0:a.value);while(!a.done)}(o[Symbol.iterator]())))))})},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Go?n(t):We(t)?i(t):Me(t)?t:n(t);return yield j(yield*Fn(Oe(Yo(function(o){return ae(this,arguments,function*(){let u=null;do u=yield j(o.next(yield yield j(Y(r,u))));while(!u.done)})}(s[Symbol.asyncIterator]()))))),yield j(new r)})}var km=r=>je(Int8Array,r),Um=r=>je(Int16Array,r),Lm=r=>je(Int32Array,r),Xo=r=>je(Uint8Array,r),Nm=r=>je(Uint16Array,r),Cm=r=>je(Uint32Array,r),Pm=r=>je(Float32Array,r),Vm=r=>je(Float64Array,r),Hm=r=>je(Uint8ClampedArray,r);function bi(r,t,e){if(r!==0){e=e.slice(0,t+1);for(let n=-1;++n<=t;)e[n]+=r}return e}function Ko(r,t){let e=0,n=r.length;if(n!==t.length)return!1;if(n>0)do if(r[e]!==t[e])return!1;while(++e<n);return!0}var Yt={fromIterable(r){return bs(zm(r))},fromAsyncIterable(r){return bs(Wm(r))},fromDOMStream(r){return bs(jm(r))},fromNodeStream(r){return bs(Ym(r))},toDOMStream(r,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(r,t){throw new Error('"toNodeStream" not available in this environment')}},bs=r=>(r.next(),r);function*zm(r){let t,e=!1,n=[],i,s,o,u=0;function a(){return s==="peek"?fe(n,o)[0]:([i,n,u]=fe(n,o),i)}({cmd:s,size:o}=yield null);let h=$o(r)[Symbol.iterator]();try{do if({done:t,value:i}=Number.isNaN(o-u)?h.next():h.next(o-u),!t&&i.byteLength>0&&(n.push(i),u+=i.byteLength),t||o<=u)do({cmd:s,size:o}=yield a());while(o<u);while(!t)}catch(m){(e=!0)&&typeof h.throw=="function"&&h.throw(m)}finally{e===!1&&typeof h.return=="function"&&h.return(null)}return null}function Wm(r){return ae(this,arguments,function*(){let e,n=!1,i=[],s,o,u,a=0;function h(){return o==="peek"?fe(i,u)[0]:([s,i,a]=fe(i,u),s)}({cmd:o,size:u}=yield yield j(null));let m=Xo(r)[Symbol.asyncIterator]();try{do if({done:e,value:s}=Number.isNaN(u-a)?yield j(m.next()):yield j(m.next(u-a)),!e&&s.byteLength>0&&(i.push(s),a+=s.byteLength),e||u<=a)do({cmd:o,size:u}=yield yield j(h()));while(u<a);while(!e)}catch(g){(n=!0)&&typeof m.throw=="function"&&(yield j(m.throw(g)))}finally{n===!1&&typeof m.return=="function"&&(yield j(m.return(new Uint8Array(0))))}return yield j(null)})}function jm(r){return ae(this,arguments,function*(){let e=!1,n=!1,i=[],s,o,u,a=0;function h(){return o==="peek"?fe(i,u)[0]:([s,i,a]=fe(i,u),s)}({cmd:o,size:u}=yield yield j(null));let m=new Il(r);try{do if({done:e,value:s}=Number.isNaN(u-a)?yield j(m.read()):yield j(m.read(u-a)),!e&&s.byteLength>0&&(i.push(M(s)),a+=s.byteLength),e||u<=a)do({cmd:o,size:u}=yield yield j(h()));while(u<a);while(!e)}catch(g){(n=!0)&&(yield j(m.cancel(g)))}finally{n===!1?yield j(m.cancel()):r.locked&&m.releaseLock()}return yield j(null)})}var Il=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return A(this,void 0,void 0,function*(){let{reader:e,source:n}=this;e&&(yield e.cancel(t).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(t){return A(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let e=yield this.reader.read();return!e.done&&(e.value=M(e)),e})}},qo=(r,t)=>{let e=i=>n([t,i]),n;return[t,e,new Promise(i=>(n=i)&&r.once(t,e))]};function Ym(r){return ae(this,arguments,function*(){let e=[],n="error",i=!1,s=null,o,u,a=0,h=[],m;function g(){return o==="peek"?fe(h,u)[0]:([m,h,a]=fe(h,u),m)}if({cmd:o,size:u}=yield yield j(null),r.isTTY)return yield yield j(new Uint8Array(0)),yield j(null);try{e[0]=qo(r,"end"),e[1]=qo(r,"error");do{if(e[2]=qo(r,"readable"),[n,s]=yield j(Promise.race(e.map(I=>I[2]))),n==="error")break;if((i=n==="end")||(Number.isFinite(u-a)?(m=M(r.read(u-a)),m.byteLength<u-a&&(m=M(r.read()))):m=M(r.read()),m.byteLength>0&&(h.push(m),a+=m.byteLength)),i||u<=a)do({cmd:o,size:u}=yield yield j(g()));while(u<a)}while(!i)}finally{yield j(S(e,n==="error"?s:null))}return yield j(null);function S(I,Z){return m=h=null,new Promise((X,ht)=>{for(let[lt,vt]of I)r.off(lt,vt);try{let lt=r.destroy;lt&&lt.call(r,Z),Z=void 0}catch(lt){Z=lt||Z}finally{Z!=null?ht(Z):X()}})}})}var Wt;(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2",r[r.V3=2]="V3",r[r.V4=3]="V4",r[r.V5=4]="V5"})(Wt||(Wt={}));var It;(function(r){r[r.Sparse=0]="Sparse",r[r.Dense=1]="Dense"})(It||(It={}));var mt;(function(r){r[r.HALF=0]="HALF",r[r.SINGLE=1]="SINGLE",r[r.DOUBLE=2]="DOUBLE"})(mt||(mt={}));var Gt;(function(r){r[r.DAY=0]="DAY",r[r.MILLISECOND=1]="MILLISECOND"})(Gt||(Gt={}));var q;(function(r){r[r.SECOND=0]="SECOND",r[r.MILLISECOND=1]="MILLISECOND",r[r.MICROSECOND=2]="MICROSECOND",r[r.NANOSECOND=3]="NANOSECOND"})(q||(q={}));var ee;(function(r){r[r.YEAR_MONTH=0]="YEAR_MONTH",r[r.DAY_TIME=1]="DAY_TIME",r[r.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(ee||(ee={}));var et;(function(r){r[r.NONE=0]="NONE",r[r.Schema=1]="Schema",r[r.DictionaryBatch=2]="DictionaryBatch",r[r.RecordBatch=3]="RecordBatch",r[r.Tensor=4]="Tensor",r[r.SparseTensor=5]="SparseTensor"})(et||(et={}));var p;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth"})(p||(p={}));var Re;(function(r){r[r.OFFSET=0]="OFFSET",r[r.DATA=1]="DATA",r[r.VALIDITY=2]="VALIDITY",r[r.TYPE=3]="TYPE"})(Re||(Re={}));var wa={};ln(wa,{clampIndex:()=>U_,clampRange:()=>vi,createElementComparator:()=>Yr});function Ye(r){if(r===null)return"null";if(r===void 0)return"undefined";switch(typeof r){case"number":return`${r}`;case"bigint":return`${r}`;case"string":return`"${r}"`}return typeof r[Symbol.toPrimitive]=="function"?r[Symbol.toPrimitive]("string"):ArrayBuffer.isView(r)?r instanceof BigInt64Array||r instanceof BigUint64Array?`[${[...r].map(t=>Ye(t))}]`:`[${r}]`:ArrayBuffer.isView(r)?`[${r}]`:JSON.stringify(r,(t,e)=>typeof e=="bigint"?`${e}`:e)}var Qo={};ln(Qo,{BN:()=>On,bignumToBigInt:()=>gs,bignumToString:()=>Ur,isArrowBigNumSymbol:()=>Al});var Al=Symbol.for("isArrowBigNum");function Ge(r,...t){return t.length===0?Object.setPrototypeOf(Y(this.TypedArray,r),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(r,...t),this.constructor.prototype)}Ge.prototype[Al]=!0;Ge.prototype.toJSON=function(){return`"${Ur(this)}"`};Ge.prototype.valueOf=function(){return xl(this)};Ge.prototype.toString=function(){return Ur(this)};Ge.prototype[Symbol.toPrimitive]=function(r="default"){switch(r){case"number":return xl(this);case"string":return Ur(this);case"default":return gs(this)}return Ur(this)};function Dn(...r){return Ge.apply(this,r)}function En(...r){return Ge.apply(this,r)}function gi(...r){return Ge.apply(this,r)}Object.setPrototypeOf(Dn.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(En.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(gi.prototype,Object.create(Uint32Array.prototype));Object.assign(Dn.prototype,Ge.prototype,{constructor:Dn,signed:!0,TypedArray:Int32Array,BigIntArray:mi});Object.assign(En.prototype,Ge.prototype,{constructor:En,signed:!1,TypedArray:Uint32Array,BigIntArray:_i});Object.assign(gi.prototype,Ge.prototype,{constructor:gi,signed:!0,TypedArray:Uint32Array,BigIntArray:_i});function xl(r){let{buffer:t,byteOffset:e,length:n,signed:i}=r,s=new Int32Array(t,e,n),o=0,u=0,a=s.length,h,m;for(;u<a;)m=s[u++],h=s[u++],i||(h=h>>>0),o+=(m>>>0)+h*Math.pow(u,32);return o}var Ur,gs;ds?(gs=r=>r.byteLength===8?new r.BigIntArray(r.buffer,r.byteOffset,1)[0]:Zo(r),Ur=r=>r.byteLength===8?`${new r.BigIntArray(r.buffer,r.byteOffset,1)[0]}`:Zo(r)):(Ur=Zo,gs=Ur);function Zo(r){let t="",e=new Uint32Array(2),n=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),i=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),s=-1,o=n.length-1;do{for(e[0]=n[s=0];s<o;)n[s++]=e[1]=e[0]/10,e[0]=(e[0]-e[1]*10<<16)+n[s];n[s]=e[1]=e[0]/10,e[0]=e[0]-e[1]*10,t=`${e[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t||"0"}var On=class{static new(t,e){switch(e){case!0:return new Dn(t);case!1:return new En(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case mi:return new Dn(t)}return t.byteLength===16?new gi(t):new En(t)}static signed(t){return new Dn(t)}static unsigned(t){return new En(t)}static decimal(t){return new gi(t)}constructor(t,e){return On.new(t,e)}};var Bl,Fl,Tl,Dl,El,Ol,Ml,Rl,kl,Ul,Ll,Nl,Cl,Pl,Vl,Hl,zl,Wl,jl,F=class{static isNull(t){return(t==null?void 0:t.typeId)===p.Null}static isInt(t){return(t==null?void 0:t.typeId)===p.Int}static isFloat(t){return(t==null?void 0:t.typeId)===p.Float}static isBinary(t){return(t==null?void 0:t.typeId)===p.Binary}static isUtf8(t){return(t==null?void 0:t.typeId)===p.Utf8}static isBool(t){return(t==null?void 0:t.typeId)===p.Bool}static isDecimal(t){return(t==null?void 0:t.typeId)===p.Decimal}static isDate(t){return(t==null?void 0:t.typeId)===p.Date}static isTime(t){return(t==null?void 0:t.typeId)===p.Time}static isTimestamp(t){return(t==null?void 0:t.typeId)===p.Timestamp}static isInterval(t){return(t==null?void 0:t.typeId)===p.Interval}static isList(t){return(t==null?void 0:t.typeId)===p.List}static isStruct(t){return(t==null?void 0:t.typeId)===p.Struct}static isUnion(t){return(t==null?void 0:t.typeId)===p.Union}static isFixedSizeBinary(t){return(t==null?void 0:t.typeId)===p.FixedSizeBinary}static isFixedSizeList(t){return(t==null?void 0:t.typeId)===p.FixedSizeList}static isMap(t){return(t==null?void 0:t.typeId)===p.Map}static isDictionary(t){return(t==null?void 0:t.typeId)===p.Dictionary}static isDenseUnion(t){return F.isUnion(t)&&t.mode===It.Dense}static isSparseUnion(t){return F.isUnion(t)&&t.mode===It.Sparse}get typeId(){return p.NONE}};Bl=Symbol.toStringTag;F[Bl]=(r=>(r.children=null,r.ArrayType=Array,r[Symbol.toStringTag]="DataType"))(F.prototype);var ce=class extends F{toString(){return"Null"}get typeId(){return p.Null}};Fl=Symbol.toStringTag;ce[Fl]=(r=>r[Symbol.toStringTag]="Null")(ce.prototype);var Ot=class extends F{constructor(t,e){super();this.isSigned=t,this.bitWidth=e}get typeId(){return p.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};Tl=Symbol.toStringTag;Ot[Tl]=(r=>(r.isSigned=null,r.bitWidth=null,r[Symbol.toStringTag]="Int"))(Ot.prototype);var ta=class extends Ot{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},ea=class extends Ot{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},hr=class extends Ot{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},ra=class extends Ot{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}},na=class extends Ot{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},ia=class extends Ot{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},sa=class extends Ot{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},oa=class extends Ot{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(ta.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(ea.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(hr.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(ra.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(na.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(ia.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(sa.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(oa.prototype,"ArrayType",{value:BigUint64Array});var he=class extends F{constructor(t){super();this.precision=t}get typeId(){return p.Float}get ArrayType(){switch(this.precision){case mt.HALF:return Uint16Array;case mt.SINGLE:return Float32Array;case mt.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};Dl=Symbol.toStringTag;he[Dl]=(r=>(r.precision=null,r[Symbol.toStringTag]="Float"))(he.prototype);var aa=class extends he{constructor(){super(mt.HALF)}},ca=class extends he{constructor(){super(mt.SINGLE)}},ua=class extends he{constructor(){super(mt.DOUBLE)}};Object.defineProperty(aa.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(ca.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(ua.prototype,"ArrayType",{value:Float64Array});var Lr=class extends F{constructor(){super()}get typeId(){return p.Binary}toString(){return"Binary"}};El=Symbol.toStringTag;Lr[El]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Binary"))(Lr.prototype);var Nr=class extends F{constructor(){super()}get typeId(){return p.Utf8}toString(){return"Utf8"}};Ol=Symbol.toStringTag;Nr[Ol]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Utf8"))(Nr.prototype);var Cr=class extends F{constructor(){super()}get typeId(){return p.Bool}toString(){return"Bool"}};Ml=Symbol.toStringTag;Cr[Ml]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Bool"))(Cr.prototype);var Pr=class extends F{constructor(t,e,n=128){super();this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return p.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};Rl=Symbol.toStringTag;Pr[Rl]=(r=>(r.scale=null,r.precision=null,r.ArrayType=Uint32Array,r[Symbol.toStringTag]="Decimal"))(Pr.prototype);var Vr=class extends F{constructor(t){super();this.unit=t}get typeId(){return p.Date}toString(){return`Date${(this.unit+1)*32}<${Gt[this.unit]}>`}};kl=Symbol.toStringTag;Vr[kl]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Date"))(Vr.prototype);var rr=class extends F{constructor(t,e){super();this.unit=t,this.bitWidth=e}get typeId(){return p.Time}toString(){return`Time${this.bitWidth}<${q[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};Ul=Symbol.toStringTag;rr[Ul]=(r=>(r.unit=null,r.bitWidth=null,r[Symbol.toStringTag]="Time"))(rr.prototype);var Hr=class extends F{constructor(t,e){super();this.unit=t,this.timezone=e}get typeId(){return p.Timestamp}toString(){return`Timestamp<${q[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};Ll=Symbol.toStringTag;Hr[Ll]=(r=>(r.unit=null,r.timezone=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Timestamp"))(Hr.prototype);var zr=class extends F{constructor(t){super();this.unit=t}get typeId(){return p.Interval}toString(){return`Interval<${ee[this.unit]}>`}};Nl=Symbol.toStringTag;zr[Nl]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Interval"))(zr.prototype);var nr=class extends F{constructor(t){super();this.children=[t]}get typeId(){return p.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};Cl=Symbol.toStringTag;nr[Cl]=(r=>(r.children=null,r[Symbol.toStringTag]="List"))(nr.prototype);var _t=class extends F{constructor(t){super();this.children=t}get typeId(){return p.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Pl=Symbol.toStringTag;_t[Pl]=(r=>(r.children=null,r[Symbol.toStringTag]="Struct"))(_t.prototype);var ir=class extends F{constructor(t,e,n){super();this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce((i,s,o)=>(i[s]=o)&&i||i,Object.create(null))}get typeId(){return p.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};Vl=Symbol.toStringTag;ir[Vl]=(r=>(r.mode=null,r.typeIds=null,r.children=null,r.typeIdToChildIndex=null,r.ArrayType=Int8Array,r[Symbol.toStringTag]="Union"))(ir.prototype);var Wr=class extends F{constructor(t){super();this.byteWidth=t}get typeId(){return p.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};Hl=Symbol.toStringTag;Wr[Hl]=(r=>(r.byteWidth=null,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="FixedSizeBinary"))(Wr.prototype);var sr=class extends F{constructor(t,e){super();this.listSize=t,this.children=[e]}get typeId(){return p.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};zl=Symbol.toStringTag;sr[zl]=(r=>(r.children=null,r.listSize=null,r[Symbol.toStringTag]="FixedSizeList"))(sr.prototype);var or=class extends F{constructor(t,e=!1){super();this.children=[t],this.keysSorted=e}get typeId(){return p.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Wl=Symbol.toStringTag;or[Wl]=(r=>(r.children=null,r.keysSorted=null,r[Symbol.toStringTag]="Map_"))(or.prototype);var Gm=(r=>()=>++r)(-1),ke=class extends F{constructor(t,e,n,i){super();this.indices=e,this.dictionary=t,this.isOrdered=i||!1,this.id=n==null?Gm():typeof n=="number"?n:n.low}get typeId(){return p.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};jl=Symbol.toStringTag;ke[jl]=(r=>(r.id=null,r.indices=null,r.isOrdered=null,r.dictionary=null,r[Symbol.toStringTag]="Dictionary"))(ke.prototype);function pe(r){let t=r;switch(r.typeId){case p.Decimal:return r.bitWidth/32;case p.Timestamp:return 2;case p.Date:return 1+t.unit;case p.Interval:return 1+t.unit;case p.FixedSizeList:return t.listSize;case p.FixedSizeBinary:return t.byteWidth;default:return 1}}var O=class{visitMany(t,...e){return t.map((n,i)=>this.visit(n,...e.map(s=>s[i])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return $m(this,t,e)}getVisitFnByTypeId(t,e=!0){return Mn(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}};function $m(r,t,e=!0){return typeof t=="number"?Mn(r,t,e):typeof t=="string"&&t in p?Mn(r,p[t],e):t&&t instanceof F?Mn(r,Yl(t),e):(t==null?void 0:t.type)&&t.type instanceof F?Mn(r,Yl(t.type),e):Mn(r,p.NONE,e)}function Mn(r,t,e=!0){let n=null;switch(t){case p.Null:n=r.visitNull;break;case p.Bool:n=r.visitBool;break;case p.Int:n=r.visitInt;break;case p.Int8:n=r.visitInt8||r.visitInt;break;case p.Int16:n=r.visitInt16||r.visitInt;break;case p.Int32:n=r.visitInt32||r.visitInt;break;case p.Int64:n=r.visitInt64||r.visitInt;break;case p.Uint8:n=r.visitUint8||r.visitInt;break;case p.Uint16:n=r.visitUint16||r.visitInt;break;case p.Uint32:n=r.visitUint32||r.visitInt;break;case p.Uint64:n=r.visitUint64||r.visitInt;break;case p.Float:n=r.visitFloat;break;case p.Float16:n=r.visitFloat16||r.visitFloat;break;case p.Float32:n=r.visitFloat32||r.visitFloat;break;case p.Float64:n=r.visitFloat64||r.visitFloat;break;case p.Utf8:n=r.visitUtf8;break;case p.Binary:n=r.visitBinary;break;case p.FixedSizeBinary:n=r.visitFixedSizeBinary;break;case p.Date:n=r.visitDate;break;case p.DateDay:n=r.visitDateDay||r.visitDate;break;case p.DateMillisecond:n=r.visitDateMillisecond||r.visitDate;break;case p.Timestamp:n=r.visitTimestamp;break;case p.TimestampSecond:n=r.visitTimestampSecond||r.visitTimestamp;break;case p.TimestampMillisecond:n=r.visitTimestampMillisecond||r.visitTimestamp;break;case p.TimestampMicrosecond:n=r.visitTimestampMicrosecond||r.visitTimestamp;break;case p.TimestampNanosecond:n=r.visitTimestampNanosecond||r.visitTimestamp;break;case p.Time:n=r.visitTime;break;case p.TimeSecond:n=r.visitTimeSecond||r.visitTime;break;case p.TimeMillisecond:n=r.visitTimeMillisecond||r.visitTime;break;case p.TimeMicrosecond:n=r.visitTimeMicrosecond||r.visitTime;break;case p.TimeNanosecond:n=r.visitTimeNanosecond||r.visitTime;break;case p.Decimal:n=r.visitDecimal;break;case p.List:n=r.visitList;break;case p.Struct:n=r.visitStruct;break;case p.Union:n=r.visitUnion;break;case p.DenseUnion:n=r.visitDenseUnion||r.visitUnion;break;case p.SparseUnion:n=r.visitSparseUnion||r.visitUnion;break;case p.Dictionary:n=r.visitDictionary;break;case p.Interval:n=r.visitInterval;break;case p.IntervalDayTime:n=r.visitIntervalDayTime||r.visitInterval;break;case p.IntervalYearMonth:n=r.visitIntervalYearMonth||r.visitInterval;break;case p.FixedSizeList:n=r.visitFixedSizeList;break;case p.Map:n=r.visitMap;break}if(typeof n=="function")return n;if(!e)return()=>null;throw new Error(`Unrecognized type '${p[t]}'`)}function Yl(r){switch(r.typeId){case p.Null:return p.Null;case p.Int:{let{bitWidth:t,isSigned:e}=r;switch(t){case 8:return e?p.Int8:p.Uint8;case 16:return e?p.Int16:p.Uint16;case 32:return e?p.Int32:p.Uint32;case 64:return e?p.Int64:p.Uint64}return p.Int}case p.Float:switch(r.precision){case mt.HALF:return p.Float16;case mt.SINGLE:return p.Float32;case mt.DOUBLE:return p.Float64}return p.Float;case p.Binary:return p.Binary;case p.Utf8:return p.Utf8;case p.Bool:return p.Bool;case p.Decimal:return p.Decimal;case p.Time:switch(r.unit){case q.SECOND:return p.TimeSecond;case q.MILLISECOND:return p.TimeMillisecond;case q.MICROSECOND:return p.TimeMicrosecond;case q.NANOSECOND:return p.TimeNanosecond}return p.Time;case p.Timestamp:switch(r.unit){case q.SECOND:return p.TimestampSecond;case q.MILLISECOND:return p.TimestampMillisecond;case q.MICROSECOND:return p.TimestampMicrosecond;case q.NANOSECOND:return p.TimestampNanosecond}return p.Timestamp;case p.Date:switch(r.unit){case Gt.DAY:return p.DateDay;case Gt.MILLISECOND:return p.DateMillisecond}return p.Date;case p.Interval:switch(r.unit){case ee.DAY_TIME:return p.IntervalDayTime;case ee.YEAR_MONTH:return p.IntervalYearMonth}return p.Interval;case p.Map:return p.Map;case p.List:return p.List;case p.Struct:return p.Struct;case p.Union:switch(r.mode){case It.Dense:return p.DenseUnion;case It.Sparse:return p.SparseUnion}return p.Union;case p.FixedSizeBinary:return p.FixedSizeBinary;case p.FixedSizeList:return p.FixedSizeList;case p.Dictionary:return p.Dictionary}throw new Error(`Unrecognized type '${p[r.typeId]}'`)}O.prototype.visitInt8=null;O.prototype.visitInt16=null;O.prototype.visitInt32=null;O.prototype.visitInt64=null;O.prototype.visitUint8=null;O.prototype.visitUint16=null;O.prototype.visitUint32=null;O.prototype.visitUint64=null;O.prototype.visitFloat16=null;O.prototype.visitFloat32=null;O.prototype.visitFloat64=null;O.prototype.visitDateDay=null;O.prototype.visitDateMillisecond=null;O.prototype.visitTimestampSecond=null;O.prototype.visitTimestampMillisecond=null;O.prototype.visitTimestampMicrosecond=null;O.prototype.visitTimestampNanosecond=null;O.prototype.visitTimeSecond=null;O.prototype.visitTimeMillisecond=null;O.prototype.visitTimeMicrosecond=null;O.prototype.visitTimeNanosecond=null;O.prototype.visitDenseUnion=null;O.prototype.visitSparseUnion=null;O.prototype.visitIntervalDayTime=null;O.prototype.visitIntervalYearMonth=null;var la={};ln(la,{float64ToUint16:()=>wi,uint16ToFloat64:()=>ws});var Gl=new Float64Array(1),Rn=new Uint32Array(Gl.buffer);function ws(r){let t=(r&31744)>>10,e=(r&1023)/1024,n=Math.pow(-1,(r&32768)>>15);switch(t){case 31:return n*(e?Number.NaN:1/0);case 0:return n*(e?6103515625e-14*e:0)}return n*Math.pow(2,t-15)*(1+e)}function wi(r){if(r!==r)return 32256;Gl[0]=r;let t=(Rn[1]&2147483648)>>16&65535,e=Rn[1]&2146435072,n=0;return e>=1089470464?Rn[0]>0?e=31744:(e=(e&2080374784)>>16,n=(Rn[1]&1048575)>>10):e<=1056964608?(n=1048576+(Rn[1]&1048575),n=1048576+(n<<(e>>20)-998)>>21,e=0):(e=e-1056964608>>10,n=(Rn[1]&1048575)+512>>10),t|e|n&65535}var N=class extends O{};function z(r){return(t,e,n)=>{if(t.setValid(e,n!=null))return r(t,e,n)}}var Xm=(r,t,e)=>{r[t]=Math.trunc(e/864e5)},da=(r,t,e)=>{r[t]=Math.trunc(e%4294967296),r[t+1]=Math.trunc(e/4294967296)},Km=(r,t,e)=>{r[t]=Math.trunc(e*1e3%4294967296),r[t+1]=Math.trunc(e*1e3/4294967296)},Jm=(r,t,e)=>{r[t]=Math.trunc(e*1e6%4294967296),r[t+1]=Math.trunc(e*1e6/4294967296)},$l=(r,t,e,n)=>{let{[e]:i,[e+1]:s}=t;i!=null&&s!=null&&r.set(n.subarray(0,s-i),i)},qm=({offset:r,values:t},e,n)=>{let i=r+e;n?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},pr=({values:r},t,e)=>{r[t]=e},fa=({values:r},t,e)=>{r[t]=e},Xl=({values:r},t,e)=>{r[t]=wi(e)},Zm=(r,t,e)=>{switch(r.type.precision){case mt.HALF:return Xl(r,t,e);case mt.SINGLE:case mt.DOUBLE:default:return fa(r,t,e)}},vs=({values:r},t,e)=>{Xm(r,t,e.valueOf())},Ss=({values:r},t,e)=>{da(r,t*2,e.valueOf())},ha=({stride:r,values:t},e,n)=>{t.set(n.subarray(0,r),r*e)},Qm=({values:r,valueOffsets:t},e,n)=>$l(r,t,e,n),t_=({values:r,valueOffsets:t},e,n)=>{$l(r,t,e,kr(n))},pa=(r,t,e)=>{r.type.unit===Gt.DAY?vs(r,t,e):Ss(r,t,e)},Is=({values:r},t,e)=>da(r,t*2,e/1e3),As=({values:r},t,e)=>da(r,t*2,e),xs=({values:r},t,e)=>Km(r,t*2,e),Bs=({values:r},t,e)=>Jm(r,t*2,e),ma=(r,t,e)=>{switch(r.type.unit){case q.SECOND:return Is(r,t,e);case q.MILLISECOND:return As(r,t,e);case q.MICROSECOND:return xs(r,t,e);case q.NANOSECOND:return Bs(r,t,e)}},Fs=({values:r},t,e)=>{r[t]=e},Ts=({values:r},t,e)=>{r[t]=e},Ds=({values:r},t,e)=>{r[t]=e},Es=({values:r},t,e)=>{r[t]=e},_a=(r,t,e)=>{switch(r.type.unit){case q.SECOND:return Fs(r,t,e);case q.MILLISECOND:return Ts(r,t,e);case q.MICROSECOND:return Ds(r,t,e);case q.NANOSECOND:return Es(r,t,e)}},ya=({values:r,stride:t},e,n)=>{r.set(n.subarray(0,t),t*e)},e_=(r,t,e)=>{let n=r.children[0],i=r.valueOffsets,s=$t.getVisitFn(n);if(Array.isArray(e))for(let o=-1,u=i[t],a=i[t+1];u<a;)s(n,u++,e[++o]);else for(let o=-1,u=i[t],a=i[t+1];u<a;)s(n,u++,e.get(++o))},r_=(r,t,e)=>{let n=r.children[0],i=r.valueOffsets,s=$t.getVisitFn(n),{[t]:o,[t+1]:u}=i,a=e instanceof Map?e.entries():Object.entries(e);for(let h of a)if(s(n,o,h),++o>=u)break},n_=(r,t)=>(e,n,i,s)=>n&&e(n,r,t[s]),i_=(r,t)=>(e,n,i,s)=>n&&e(n,r,t.get(s)),s_=(r,t)=>(e,n,i,s)=>n&&e(n,r,t.get(i.name)),o_=(r,t)=>(e,n,i,s)=>n&&e(n,r,t[i.name]),a_=(r,t,e)=>{let n=r.type.children.map(s=>$t.getVisitFn(s.type)),i=e instanceof Map?s_(t,e):e instanceof C?i_(t,e):Array.isArray(e)?n_(t,e):o_(t,e);r.type.children.forEach((s,o)=>i(n[o],r.children[o],s,o))},c_=(r,t,e)=>{r.type.mode===It.Dense?Kl(r,t,e):Jl(r,t,e)},Kl=(r,t,e)=>{let n=r.type.typeIdToChildIndex[r.typeIds[t]],i=r.children[n];$t.visit(i,r.valueOffsets[t],e)},Jl=(r,t,e)=>{let n=r.type.typeIdToChildIndex[r.typeIds[t]],i=r.children[n];$t.visit(i,t,e)},u_=(r,t,e)=>{var n;(n=r.dictionary)===null||n===void 0||n.set(r.values[t],e)},ba=(r,t,e)=>{r.type.unit===ee.DAY_TIME?Os(r,t,e):Ms(r,t,e)},Os=({values:r},t,e)=>{r.set(e.subarray(0,2),2*t)},Ms=({values:r},t,e)=>{r[t]=e[0]*12+e[1]%12},l_=(r,t,e)=>{let{stride:n}=r,i=r.children[0],s=$t.getVisitFn(i);if(Array.isArray(e))for(let o=-1,u=t*n;++o<n;)s(i,u+o,e[o]);else for(let o=-1,u=t*n;++o<n;)s(i,u+o,e.get(o))};N.prototype.visitBool=z(qm);N.prototype.visitInt=z(pr);N.prototype.visitInt8=z(pr);N.prototype.visitInt16=z(pr);N.prototype.visitInt32=z(pr);N.prototype.visitInt64=z(pr);N.prototype.visitUint8=z(pr);N.prototype.visitUint16=z(pr);N.prototype.visitUint32=z(pr);N.prototype.visitUint64=z(pr);N.prototype.visitFloat=z(Zm);N.prototype.visitFloat16=z(Xl);N.prototype.visitFloat32=z(fa);N.prototype.visitFloat64=z(fa);N.prototype.visitUtf8=z(t_);N.prototype.visitBinary=z(Qm);N.prototype.visitFixedSizeBinary=z(ha);N.prototype.visitDate=z(pa);N.prototype.visitDateDay=z(vs);N.prototype.visitDateMillisecond=z(Ss);N.prototype.visitTimestamp=z(ma);N.prototype.visitTimestampSecond=z(Is);N.prototype.visitTimestampMillisecond=z(As);N.prototype.visitTimestampMicrosecond=z(xs);N.prototype.visitTimestampNanosecond=z(Bs);N.prototype.visitTime=z(_a);N.prototype.visitTimeSecond=z(Fs);N.prototype.visitTimeMillisecond=z(Ts);N.prototype.visitTimeMicrosecond=z(Ds);N.prototype.visitTimeNanosecond=z(Es);N.prototype.visitDecimal=z(ya);N.prototype.visitList=z(e_);N.prototype.visitStruct=z(a_);N.prototype.visitUnion=z(c_);N.prototype.visitDenseUnion=z(Kl);N.prototype.visitSparseUnion=z(Jl);N.prototype.visitDictionary=z(u_);N.prototype.visitInterval=z(ba);N.prototype.visitIntervalDayTime=z(Os);N.prototype.visitIntervalYearMonth=z(Ms);N.prototype.visitFixedSizeList=z(l_);N.prototype.visitMap=z(r_);var $t=new N;var $e=Symbol.for("parent"),kn=Symbol.for("rowIndex"),fn=class{constructor(t,e){return this[$e]=t,this[kn]=e,new Proxy(this,new Zl)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[kn],e=this[$e],n=e.type.children,i={};for(let s=-1,o=n.length;++s<o;)i[n[s].name]=Mt.visit(e.children[s],t);return i}toString(){return`{${[...this].map(([t,e])=>`${Ye(t)}: ${Ye(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new ql(this[$e],this[kn])}},ql=class{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Mt.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(fn.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[$e]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kn]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var Zl=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[$e].type.children.map(e=>e.name)}has(t,e){return t[$e].type.children.findIndex(n=>n.name===e)!==-1}getOwnPropertyDescriptor(t,e){if(t[$e].type.children.findIndex(n=>n.name===e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];let n=t[$e].type.children.findIndex(i=>i.name===e);if(n!==-1){let i=Mt.visit(t[$e].children[n],t[kn]);return Reflect.set(t,e,i),i}}set(t,e,n){let i=t[$e].type.children.findIndex(s=>s.name===e);return i!==-1?($t.visit(t[$e].children[i],t[kn],n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}};var R=class extends O{};function V(r){return(t,e)=>t.getValid(e)?r(t,e):null}var d_=(r,t)=>864e5*r[t],ga=(r,t)=>4294967296*r[t+1]+(r[t]>>>0),f_=(r,t)=>4294967296*(r[t+1]/1e3)+(r[t]>>>0)/1e3,h_=(r,t)=>4294967296*(r[t+1]/1e6)+(r[t]>>>0)/1e6,Ql=r=>new Date(r),p_=(r,t)=>Ql(d_(r,t)),m_=(r,t)=>Ql(ga(r,t)),__=(r,t)=>null,td=(r,t,e)=>{let{[e]:n,[e+1]:i}=t;return n!=null&&i!=null?r.subarray(n,i):null},y_=({offset:r,values:t},e)=>{let n=r+e;return(t[n>>3]&1<<n%8)!==0},ed=({values:r},t)=>p_(r,t),rd=({values:r},t)=>m_(r,t*2),jr=({stride:r,values:t},e)=>t[r*e],b_=({stride:r,values:t},e)=>ws(t[r*e]),nd=({values:r},t)=>r[t],g_=({stride:r,values:t},e)=>t.subarray(r*e,r*(e+1)),w_=({values:r,valueOffsets:t},e)=>td(r,t,e),v_=({values:r,valueOffsets:t},e)=>{let n=td(r,t,e);return n!==null?pi(n):null},S_=({values:r},t)=>r[t],I_=({type:r,values:t},e)=>r.precision!==mt.HALF?t[e]:ws(t[e]),A_=(r,t)=>r.type.unit===Gt.DAY?ed(r,t):rd(r,t),id=({values:r},t)=>1e3*ga(r,t*2),sd=({values:r},t)=>ga(r,t*2),od=({values:r},t)=>f_(r,t*2),ad=({values:r},t)=>h_(r,t*2),x_=(r,t)=>{switch(r.type.unit){case q.SECOND:return id(r,t);case q.MILLISECOND:return sd(r,t);case q.MICROSECOND:return od(r,t);case q.NANOSECOND:return ad(r,t)}},cd=({values:r},t)=>r[t],ud=({values:r},t)=>r[t],ld=({values:r},t)=>r[t],dd=({values:r},t)=>r[t],B_=(r,t)=>{switch(r.type.unit){case q.SECOND:return cd(r,t);case q.MILLISECOND:return ud(r,t);case q.MICROSECOND:return ld(r,t);case q.NANOSECOND:return dd(r,t)}},F_=({values:r,stride:t},e)=>On.decimal(r.subarray(t*e,t*(e+1))),T_=(r,t)=>{let{valueOffsets:e,stride:n}=r,{[t*n]:i}=e,{[t*n+1]:s}=e,u=r.children[0].slice(i,s-i);return new C([u])},D_=(r,t)=>{let{valueOffsets:e}=r,{[t]:n}=e,{[t+1]:i}=e,s=r.children[0];return new mr(s.slice(n,i-n))},E_=(r,t)=>new fn(r,t),O_=(r,t)=>r.type.mode===It.Dense?fd(r,t):hd(r,t),fd=(r,t)=>{let e=r.type.typeIdToChildIndex[r.typeIds[t]],n=r.children[e];return Mt.visit(n,r.valueOffsets[t])},hd=(r,t)=>{let e=r.type.typeIdToChildIndex[r.typeIds[t]],n=r.children[e];return Mt.visit(n,t)},M_=(r,t)=>{var e;return(e=r.dictionary)===null||e===void 0?void 0:e.get(r.values[t])},R_=(r,t)=>r.type.unit===ee.DAY_TIME?pd(r,t):md(r,t),pd=({values:r},t)=>r.subarray(2*t,2*(t+1)),md=({values:r},t)=>{let e=r[t],n=new Int32Array(2);return n[0]=Math.trunc(e/12),n[1]=Math.trunc(e%12),n},k_=(r,t)=>{let{stride:e}=r,i=r.children[0].slice(t*e,e);return new C([i])};R.prototype.visitNull=V(__);R.prototype.visitBool=V(y_);R.prototype.visitInt=V(S_);R.prototype.visitInt8=V(jr);R.prototype.visitInt16=V(jr);R.prototype.visitInt32=V(jr);R.prototype.visitInt64=V(nd);R.prototype.visitUint8=V(jr);R.prototype.visitUint16=V(jr);R.prototype.visitUint32=V(jr);R.prototype.visitUint64=V(nd);R.prototype.visitFloat=V(I_);R.prototype.visitFloat16=V(b_);R.prototype.visitFloat32=V(jr);R.prototype.visitFloat64=V(jr);R.prototype.visitUtf8=V(v_);R.prototype.visitBinary=V(w_);R.prototype.visitFixedSizeBinary=V(g_);R.prototype.visitDate=V(A_);R.prototype.visitDateDay=V(ed);R.prototype.visitDateMillisecond=V(rd);R.prototype.visitTimestamp=V(x_);R.prototype.visitTimestampSecond=V(id);R.prototype.visitTimestampMillisecond=V(sd);R.prototype.visitTimestampMicrosecond=V(od);R.prototype.visitTimestampNanosecond=V(ad);R.prototype.visitTime=V(B_);R.prototype.visitTimeSecond=V(cd);R.prototype.visitTimeMillisecond=V(ud);R.prototype.visitTimeMicrosecond=V(ld);R.prototype.visitTimeNanosecond=V(dd);R.prototype.visitDecimal=V(F_);R.prototype.visitList=V(T_);R.prototype.visitStruct=V(E_);R.prototype.visitUnion=V(O_);R.prototype.visitDenseUnion=V(fd);R.prototype.visitSparseUnion=V(hd);R.prototype.visitDictionary=V(M_);R.prototype.visitInterval=V(R_);R.prototype.visitIntervalDayTime=V(pd);R.prototype.visitIntervalYearMonth=V(md);R.prototype.visitFixedSizeList=V(k_);R.prototype.visitMap=V(D_);var Mt=new R;var Ue=Symbol.for("keys"),Un=Symbol.for("vals"),mr=class{constructor(t){return this[Ue]=new C([t.children[0]]).memoize(),this[Un]=t.children[1],new Proxy(this,new yd)}[Symbol.iterator](){return new _d(this[Ue],this[Un])}get size(){return this[Ue].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[Ue],e=this[Un],n={};for(let i=-1,s=t.length;++i<s;)n[t.get(i)]=Mt.visit(e,i);return n}toString(){return`{${[...this].map(([t,e])=>`${Ye(t)}: ${Ye(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},_d=class{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Mt.visit(this.vals,t)]})}},yd=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ue].toArray().map(String)}has(t,e){return t[Ue].includes(e)}getOwnPropertyDescriptor(t,e){if(t[Ue].indexOf(e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];let n=t[Ue].indexOf(e);if(n!==-1){let i=Mt.visit(Reflect.get(t,Un),n);return Reflect.set(t,e,i),i}}set(t,e,n){let i=t[Ue].indexOf(e);return i!==-1?($t.visit(Reflect.get(t,Un),i,n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}};Object.defineProperties(mr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ue]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Un]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function U_(r,t,e){let n=r.length,i=t>-1?t:n+t%n;return e?e(r,i):i}var bd;function vi(r,t,e,n){let{length:i=0}=r,s=typeof t!="number"?0:t,o=typeof e!="number"?i:e;return s<0&&(s=(s%i+i)%i),o<0&&(o=(o%i+i)%i),o<s&&(bd=s,s=o,o=bd),o>i&&(o=i),n?n(r,s,o):[s,o]}var gd=r=>r!==r;function Yr(r){if(typeof r!=="object"||r===null)return gd(r)?gd:e=>e===r;if(r instanceof Date){let e=r.valueOf();return n=>n instanceof Date?n.valueOf()===e:!1}return ArrayBuffer.isView(r)?e=>e?Ko(r,e):!1:r instanceof Map?N_(r):Array.isArray(r)?L_(r):r instanceof C?C_(r):P_(r,!0)}function L_(r){let t=[];for(let e=-1,n=r.length;++e<n;)t[e]=Yr(r[e]);return Rs(t)}function N_(r){let t=-1,e=[];for(let n of r.values())e[++t]=Yr(n);return Rs(e)}function C_(r){let t=[];for(let e=-1,n=r.length;++e<n;)t[e]=Yr(r.get(e));return Rs(t)}function P_(r,t=!1){let e=Object.keys(r);if(!t&&e.length===0)return()=>!1;let n=[];for(let i=-1,s=e.length;++i<s;)n[i]=Yr(r[e[i]]);return Rs(n,e)}function Rs(r,t){return e=>{if(!e||typeof e!="object")return!1;switch(e.constructor){case Array:return V_(r,e);case Map:return wd(r,e,e.keys());case mr:case fn:case Object:case void 0:return wd(r,e,t||Object.keys(e))}return e instanceof C?H_(r,e):!1}}function V_(r,t){let e=r.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!r[n](t[n]))return!1;return!0}function H_(r,t){let e=r.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!r[n](t.get(n)))return!1;return!0}function wd(r,t,e){let n=e[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator](),o=0,u=r.length,a=s.next(),h=n.next(),m=i.next();for(;o<u&&!h.done&&!m.done&&!a.done&&!(h.value!==m.value||!r[o](a.value));++o,h=n.next(),m=i.next(),a=s.next());return o===u&&h.done&&m.done&&a.done?!0:(n.return&&n.return(),i.return&&i.return(),s.return&&s.return(),!1)}var va={};ln(va,{BitIterator:()=>Nn,getBit:()=>vd,getBool:()=>Us,packBools:()=>hn,popcnt_array:()=>Sd,popcnt_bit_range:()=>Si,popcnt_uint32:()=>ks,setBool:()=>z_,truncateBitmap:()=>Ln});function Us(r,t,e,n){return(e&1<<n)!==0}function vd(r,t,e,n){return(e&1<<n)>>n}function z_(r,t,e){return e?!!(r[t>>3]|=1<<t%8)||!0:!(r[t>>3]&=~(1<<t%8))&&!1}function Ln(r,t,e){let n=e.byteLength+7&-8;if(r>0||e.byteLength<n){let i=new Uint8Array(n);return i.set(r%8===0?e.subarray(r>>3):hn(new Nn(e,r,t,null,Us)).subarray(0,n)),i}return e}function hn(r){let t=[],e=0,n=0,i=0;for(let o of r)o&&(i|=1<<n),++n===8&&(t[e++]=i,i=n=0);(e===0||n>0)&&(t[e++]=i);let s=new Uint8Array(t.length+7&-8);return s.set(t),s}var Nn=class{constructor(t,e,n,i,s){this.bytes=t,this.length=n,this.context=i,this.get=s,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function Si(r,t,e){if(e-t<=0)return 0;if(e-t<8){let s=0;for(let o of new Nn(r,t,e-t,r,vd))s+=o;return s}let n=e>>3<<3,i=t+(t%8===0?0:8-t%8);return Si(r,t,i)+Si(r,n,e)+Sd(r,i>>3,n-i>>3)}function Sd(r,t,e){let n=0,i=Math.trunc(t),s=new DataView(r.buffer,r.byteOffset,r.byteLength),o=e===void 0?r.byteLength:i+e;for(;o-i>=4;)n+=ks(s.getUint32(i)),i+=4;for(;o-i>=2;)n+=ks(s.getUint16(i)),i+=2;for(;o-i>=1;)n+=ks(s.getUint8(i)),i+=1;return n}function ks(r){let t=Math.trunc(r);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var W_=-1,nt=class{constructor(t,e,n,i,s,o=[],u){this.type=t,this.children=o,this.dictionary=u,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1));let a;s instanceof nt?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=pe(t),s&&((a=s[0])&&(this.valueOffsets=a),(a=s[1])&&(this.values=a),(a=s[2])&&(this.nullBitmap=a),(a=s[3])&&(this.typeIds=a))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0,{valueOffsets:e,values:n,nullBitmap:i,typeIds:s}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),this.children.reduce((o,u)=>o+u.byteLength,t)}get nullCount(){let t=this._nullCount,e;return t<=W_&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-Si(e,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){let e=this.offset+t;return(this.nullBitmap[e>>3]&1<<e%8)!==0}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){let{nullBitmap:a}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:a,_nullCount:0})}let{nullBitmap:n,offset:i}=this,s=i+t>>3,o=(i+t)%8,u=n[s]>>o&1;return e?u===0&&(n[s]|=1<<o,this._nullCount=this.nullCount+1):u===1&&(n[s]&=~(1<<o),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,i=this._nullCount,s=this,o=this.children){return new nt(t,e,n,i,s,o,this.dictionary)}slice(t,e){let{stride:n,typeId:i,children:s}=this,o=+(this._nullCount===0)-1,u=i===16?n:1,a=this._sliceBuffers(t,e,n,i);return this.clone(this.type,this.offset+t,e,o,a,s.length===0||this.valueOffsets?s:this._sliceChildren(s,u*t,u*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===p.Null)return this.clone(this.type,0,t,0);let{length:e,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);i[e>>3]=(1<<e-(e&-8))-1,n>0&&i.set(Ln(this.offset,e,this.nullBitmap),0);let s=this.buffers;return s[Re.VALIDITY]=i,this.clone(this.type,0,t,n+(t-e),s)}_sliceBuffers(t,e,n,i){let s,{buffers:o}=this;return(s=o[Re.TYPE])&&(o[Re.TYPE]=s.subarray(t,t+e)),(s=o[Re.OFFSET])&&(o[Re.OFFSET]=s.subarray(t,t+e+1))||(s=o[Re.DATA])&&(o[Re.DATA]=i===6?s:s.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map(i=>i.slice(e,n))}};nt.prototype.children=Object.freeze([]);var Cn=class extends O{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:e,["offset"]:n=0,["length"]:i=0}=t;return new nt(e,n,i,0)}visitBool(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length>>3,["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitInt(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitFloat(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitUtf8(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.data),s=M(t.nullBitmap),o=dn(t.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,n,u,a,[o,i,s])}visitBinary(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.data),s=M(t.nullBitmap),o=dn(t.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,n,u,a,[o,i,s])}visitFixedSizeBinary(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitDate(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitTimestamp(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitTime(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitDecimal(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitList(t){let{["type"]:e,["offset"]:n=0,["child"]:i}=t,s=M(t.nullBitmap),o=dn(t.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,n,u,a,[o,void 0,s],[i])}visitStruct(t){let{["type"]:e,["offset"]:n=0,["children"]:i=[]}=t,s=M(t.nullBitmap),{length:o=i.reduce((a,{length:h})=>Math.max(a,h),0),nullCount:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,void 0,s],i)}visitUnion(t){let{["type"]:e,["offset"]:n=0,["children"]:i=[]}=t,s=M(t.nullBitmap),o=Y(e.ArrayType,t.typeIds),{["length"]:u=o.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;if(F.isSparseUnion(e))return new nt(e,n,u,a,[void 0,void 0,s,o],i);let h=dn(t.valueOffsets);return new nt(e,n,u,a,[h,void 0,s,o],i)}visitDictionary(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.indices.ArrayType,t.data),{["dictionary"]:o=new C([new Cn().visit({type:e.dictionary})])}=t,{["length"]:u=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,n,u,a,[void 0,s,i],[],o)}visitInterval(t){let{["type"]:e,["offset"]:n=0}=t,i=M(t.nullBitmap),s=Y(e.ArrayType,t.data),{["length"]:o=s.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,s,i])}visitFixedSizeList(t){let{["type"]:e,["offset"]:n=0,["child"]:i=new Cn().visit({type:e.valueType})}=t,s=M(t.nullBitmap),{["length"]:o=i.length/pe(e),["nullCount"]:u=t.nullBitmap?-1:0}=t;return new nt(e,n,o,u,[void 0,void 0,s],[i])}visitMap(t){let{["type"]:e,["offset"]:n=0,["child"]:i=new Cn().visit({type:e.childType})}=t,s=M(t.nullBitmap),o=dn(t.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,n,u,a,[o,void 0,s],[i])}};function P(r){return new Cn().visit(r)}var Ls=class{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function Ns(r){return r.reduce((t,e)=>t+e.nullCount,0)}function Cs(r){return r.reduce((t,e,n)=>(t[n+1]=t[n]+e.length,t),new Uint32Array(r.length+1))}function Ps(r,t,e,n){let i=[];for(let s=-1,o=r.length;++s<o;){let u=r[s],a=t[s],{length:h}=u;if(a>=n)break;if(e>=a+h)continue;if(a>=e&&a+h<=n){i.push(u);continue}let m=Math.max(0,e-a),g=Math.min(n-a,h);i.push(u.slice(m,g-m))}return i.length===0&&i.push(r[0].slice(0,0)),i}function Sa(r,t,e,n){let i=0,s=0,o=t.length-1;do{if(i>=o-1)return e<t[o]?n(r,i,e-t[i]):null;s=i+Math.trunc((o-i)*.5),e<t[s]?o=s:i=s}while(i<o)}function Ii(r,t){return r.getValid(t)}function Gr(r){function t(e,n,i){return r(e[n],i)}return function(e){let n=this.data;return Sa(n,this._offsets,e,t)}}function Vs(r){let t;function e(n,i,s){return r(n[i],s,t)}return function(n,i){let s=this.data;t=i;let o=Sa(s,this._offsets,n,e);return t=void 0,o}}function Hs(r){let t;function e(n,i,s){let o=s,u=0,a=0;for(let h=i-1,m=n.length;++h<m;){let g=n[h];if(~(u=r(g,t,o)))return a+u;o=0,a+=g.length}return-1}return function(n,i){t=n;let s=this.data,o=typeof i!="number"?e(s,0,0):Sa(s,this._offsets,i,e);return t=void 0,o}}var k=class extends O{};function j_(r,t){return t===null&&r.length>0?0:-1}function Y_(r,t){let{nullBitmap:e}=r;if(!e||r.nullCount<=0)return-1;let n=0;for(let i of new Nn(e,r.offset+(t||0),r.length,e,Us)){if(!i)return n;++n}return-1}function G(r,t,e){if(t===void 0)return-1;if(t===null)return Y_(r,e);let n=Mt.getVisitFn(r),i=Yr(t);for(let s=(e||0)-1,o=r.length;++s<o;)if(i(n(r,s)))return s;return-1}function Id(r,t,e){let n=Mt.getVisitFn(r),i=Yr(t);for(let s=(e||0)-1,o=r.length;++s<o;)if(i(n(r,s)))return s;return-1}k.prototype.visitNull=j_;k.prototype.visitBool=G;k.prototype.visitInt=G;k.prototype.visitInt8=G;k.prototype.visitInt16=G;k.prototype.visitInt32=G;k.prototype.visitInt64=G;k.prototype.visitUint8=G;k.prototype.visitUint16=G;k.prototype.visitUint32=G;k.prototype.visitUint64=G;k.prototype.visitFloat=G;k.prototype.visitFloat16=G;k.prototype.visitFloat32=G;k.prototype.visitFloat64=G;k.prototype.visitUtf8=G;k.prototype.visitBinary=G;k.prototype.visitFixedSizeBinary=G;k.prototype.visitDate=G;k.prototype.visitDateDay=G;k.prototype.visitDateMillisecond=G;k.prototype.visitTimestamp=G;k.prototype.visitTimestampSecond=G;k.prototype.visitTimestampMillisecond=G;k.prototype.visitTimestampMicrosecond=G;k.prototype.visitTimestampNanosecond=G;k.prototype.visitTime=G;k.prototype.visitTimeSecond=G;k.prototype.visitTimeMillisecond=G;k.prototype.visitTimeMicrosecond=G;k.prototype.visitTimeNanosecond=G;k.prototype.visitDecimal=G;k.prototype.visitList=G;k.prototype.visitStruct=G;k.prototype.visitUnion=G;k.prototype.visitDenseUnion=Id;k.prototype.visitSparseUnion=Id;k.prototype.visitDictionary=G;k.prototype.visitInterval=G;k.prototype.visitIntervalDayTime=G;k.prototype.visitIntervalYearMonth=G;k.prototype.visitFixedSizeList=G;k.prototype.visitMap=G;var pn=new k;var U=class extends O{};function H(r){let{type:t}=r;if(r.nullCount===0&&r.stride===1&&(t.typeId===p.Timestamp||t instanceof Ot&&t.bitWidth!==64||t instanceof rr&&t.bitWidth!==64||t instanceof he&&t.precision!==mt.HALF))return new Ls(r.data.length,n=>{let i=r.data[n];return i.values.subarray(0,i.length)[Symbol.iterator]()});let e=0;return new Ls(r.data.length,n=>{let s=r.data[n].length,o=r.slice(e,e+s);return e+=s,new Ad(o)})}var Ad=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};U.prototype.visitNull=H;U.prototype.visitBool=H;U.prototype.visitInt=H;U.prototype.visitInt8=H;U.prototype.visitInt16=H;U.prototype.visitInt32=H;U.prototype.visitInt64=H;U.prototype.visitUint8=H;U.prototype.visitUint16=H;U.prototype.visitUint32=H;U.prototype.visitUint64=H;U.prototype.visitFloat=H;U.prototype.visitFloat16=H;U.prototype.visitFloat32=H;U.prototype.visitFloat64=H;U.prototype.visitUtf8=H;U.prototype.visitBinary=H;U.prototype.visitFixedSizeBinary=H;U.prototype.visitDate=H;U.prototype.visitDateDay=H;U.prototype.visitDateMillisecond=H;U.prototype.visitTimestamp=H;U.prototype.visitTimestampSecond=H;U.prototype.visitTimestampMillisecond=H;U.prototype.visitTimestampMicrosecond=H;U.prototype.visitTimestampNanosecond=H;U.prototype.visitTime=H;U.prototype.visitTimeSecond=H;U.prototype.visitTimeMillisecond=H;U.prototype.visitTimeMicrosecond=H;U.prototype.visitTimeNanosecond=H;U.prototype.visitDecimal=H;U.prototype.visitList=H;U.prototype.visitStruct=H;U.prototype.visitUnion=H;U.prototype.visitDenseUnion=H;U.prototype.visitSparseUnion=H;U.prototype.visitDictionary=H;U.prototype.visitInterval=H;U.prototype.visitIntervalDayTime=H;U.prototype.visitIntervalYearMonth=H;U.prototype.visitFixedSizeList=H;U.prototype.visitMap=H;var Pn=new U;var Ia=(r,t)=>r+t,_r=class extends O{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return 16}visitDate(t,e){return(t.type.unit+1)*4}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===q.SECOND?4:8}visitInterval(t,e){return(t.type.unit+1)*4}visitStruct(t,e){return this.visitMany(t.children,t.children.map(()=>e)).reduce(Ia,0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return this.visitMany(t.children,t.children.map(()=>e)).reduce(Ia,0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+(((n=t.dictionary)===null||n===void 0?void 0:n.getByteLength(t.values[e]))||0)}},G_=({valueOffsets:r},t)=>8+(r[t+1]-r[t]),$_=({valueOffsets:r},t)=>8+(r[t+1]-r[t]),X_=({valueOffsets:r,stride:t,children:e},n)=>{let i=e[0],{[n*t]:s}=r,{[n*t+1]:o}=r,u=Xe.getVisitFn(i.type),a=i.slice(s,o-s),h=8;for(let m=-1,g=o-s;++m<g;)h+=u(a,m);return h},K_=({stride:r,children:t},e)=>{let n=t[0],i=n.slice(e*r,r),s=Xe.getVisitFn(n.type),o=0;for(let u=-1,a=i.length;++u<a;)o+=s(i,u);return o},J_=(r,t)=>r.type.mode===It.Dense?xd(r,t):Bd(r,t),xd=({type:r,children:t,typeIds:e,valueOffsets:n},i)=>{let s=r.typeIdToChildIndex[e[i]];return 8+Xe.visit(t[s],n[i])},Bd=({children:r},t)=>4+Xe.visitMany(r,r.map(()=>t)).reduce(Ia,0);_r.prototype.visitUtf8=G_;_r.prototype.visitBinary=$_;_r.prototype.visitList=X_;_r.prototype.visitFixedSizeList=K_;_r.prototype.visitUnion=J_;_r.prototype.visitDenseUnion=xd;_r.prototype.visitSparseUnion=Bd;var Xe=new _r;var Fd,Td={},Dd={},C=class{constructor(t){var e,n,i;let s=t[0]instanceof C?t.flatMap(u=>u.data):t;if(s.some(u=>!(u instanceof nt)))throw new TypeError("Vector constructor expects an Array of Data instances.");let o=(e=s[0])===null||e===void 0?void 0:e.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{let{get:u,set:a,indexOf:h,byteLength:m}=Td[o.typeId],g=s[0];this.isValid=S=>Ii(g,S),this.get=S=>u(g,S),this.set=(S,I)=>a(g,S,I),this.indexOf=S=>h(g,S),this.getByteLength=S=>m(g,S),this._offsets=[0,g.length];break}default:Object.setPrototypeOf(this,Dd[o.typeId]),this._offsets=Cs(s);break}this.data=s,this.type=o,this.stride=pe(o),this.numChildren=(i=(n=o.children)===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,e)=>t+e.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=Ns(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${p[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return Pn.visit(this)}concat(...t){return new C(this.data.concat(t.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new C(vi(this,t,e,({data:n,_offsets:i},s,o)=>Ps(n,i,s,o)))}toJSON(){return[...this]}toArray(){let{type:t,data:e,length:n,stride:i,ArrayType:s}=this;switch(t.typeId){case p.Int:case p.Float:case p.Decimal:case p.Time:case p.Timestamp:switch(e.length){case 0:return new s;case 1:return e[0].values.subarray(0,n*i);default:return e.reduce((o,{values:u})=>(o.array.set(u,o.offset),o.offset+=u.length,o),{array:new s(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt((e=this.type.children)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new C(this.data.map(({children:e})=>e[t])):null}get isMemoized(){return F.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(F.isDictionary(this.type)){let t=new Ai(this.data[0].dictionary),e=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new C(e)}return new Ai(this)}unmemoize(){if(F.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),e=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new C(e)}return this}};Fd=Symbol.toStringTag;C[Fd]=(r=>{r.type=F.prototype,r.data=[],r.length=0,r.stride=1,r.numChildren=0,r._nullCount=-1,r._byteLength=-1,r._offsets=new Uint32Array([0]),r[Symbol.isConcatSpreadable]=!0;let t=Object.keys(p).map(e=>p[e]).filter(e=>typeof e=="number"&&e!==p.NONE);for(let e of t){let n=Mt.getVisitFnByTypeId(e),i=$t.getVisitFnByTypeId(e),s=pn.getVisitFnByTypeId(e),o=Xe.getVisitFnByTypeId(e);Td[e]={get:n,set:i,indexOf:s,byteLength:o},Dd[e]=Object.create(r,{isValid:{value:Gr(Ii)},get:{value:Gr(Mt.getVisitFnByTypeId(e))},set:{value:Vs($t.getVisitFnByTypeId(e))},indexOf:{value:Hs(pn.getVisitFnByTypeId(e))},getByteLength:{value:Gr(Xe.getVisitFnByTypeId(e))}})}return"Vector"})(C.prototype);var Ai=class extends C{constructor(t){super(t.data);let e=this.get,n=this.set,i=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(o){let u=s[o];if(u!==void 0)return u;let a=e.call(this,o);return s[o]=a,a}}),Object.defineProperty(this,"set",{value(o,u){n.call(this,o,u),s[o]=u}}),Object.defineProperty(this,"slice",{value:(o,u)=>new Ai(i.call(this,o,u))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new C(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function Ed(r){if(!r||r.length<=0)return function(i){return!0};let t="",e=r.filter(n=>n===n);return e.length>0&&(t=`
    switch (x) {${e.map(n=>`
        case ${q_(n)}:`).join("")}
            return false;
    }`),r.length!==e.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function q_(r){return typeof r!="bigint"?Ye(r):ds?`${Ye(r)}n`:`"${Ye(r)}"`}var Aa=(r,t)=>(r*t+63&-64||64)/t,Z_=(r,t=0)=>r.length>=t?r.subarray(0,t):Tn(new r.constructor(t),r,0),mn=class{constructor(t,e=1){this.buffer=t,this.stride=e,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.trunc(t.length/e))}get byteLength(){return Math.trunc(this.length*this.stride*this.BYTES_PER_ELEMENT)}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,e){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let e=this.stride,n=this.length*e,i=this.buffer.length;n>=i&&this._resize(i===0?Aa(n*1,this.BYTES_PER_ELEMENT):Aa(n*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=Aa(t*this.stride,this.BYTES_PER_ELEMENT);let e=Z_(this.buffer,t);return this.clear(),e}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=Tn(new this.ArrayType(t),this.buffer)}};mn.prototype.offset=0;var $r=class extends mn{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,e){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=e,this}},xi=class extends $r{constructor(t=new Uint8Array(0)){super(t,1/8);this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,e){let{buffer:n}=this.reserve(t-this.length+1),i=t>>3,s=t%8,o=n[i]>>s&1;return e?o===0&&(n[i]|=1<<s,++this.numValid):o===1&&(n[i]&=~(1<<s),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},Bi=class extends $r{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,e){let n=this.length-1,i=this.reserve(t-n+1).buffer;return n<t++&&i.fill(i[n],n,t),i[t]=i[t-1]+e,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}};var wt=class{constructor({type:t,nullValues:e}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=e,this.stride=pe(t),this._nulls=new xi,e&&e.length>0&&(this._isValid=Ed(e))}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}toVector(){return new C([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:e,_values:n,_nulls:i,_typeIds:s,children:o}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),o.reduce((u,a)=>u+a.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((e,n)=>e+n.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,e){return this.setValid(t,this.isValid(e))&&this.setValue(t,e),this}setValue(t,e){this._setValue(this,t,e)}setValid(t,e){return this.length=this._nulls.set(t,+e).length,e}addChild(t,e=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,e,n,i,{type:s,length:o,nullCount:u,_typeIds:a,_offsets:h,_values:m,_nulls:g}=this;(e=a==null?void 0:a.flush(o))?i=h==null?void 0:h.flush(o):(i=h==null?void 0:h.flush(o))?t=m==null?void 0:m.flush(h.last()):t=m==null?void 0:m.flush(o),u>0&&(n=g==null?void 0:g.flush(o));let S=this.children.map(I=>I.flush());return this.clear(),P({type:s,length:o,nullCount:u,children:S,child:S[0],data:t,typeIds:e,nullBitmap:n,valueOffsets:i})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,e,n,i;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(e=this._values)===null||e===void 0||e.clear(),(n=this._offsets)===null||n===void 0||n.clear(),(i=this._typeIds)===null||i===void 0||i.clear();for(let s of this.children)s.clear();return this}};wt.prototype.length=1;wt.prototype.stride=1;wt.prototype.children=null;wt.prototype.finished=!1;wt.prototype.nullValues=null;wt.prototype._isValid=()=>!0;var Xt=class extends wt{constructor(t){super(t);this._values=new $r(new this.ArrayType(0),this.stride)}setValue(t,e){let n=this._values;return n.reserve(t-n.length+1),super.setValue(t,e)}},yr=class extends wt{constructor(t){super(t);this._pendingLength=0,this._offsets=new Bi}setValue(t,e){let n=this._pending||(this._pending=new Map),i=n.get(t);i&&(this._pendingLength-=i.length),this._pendingLength+=e instanceof mr?e[Ue].length:e.length,n.set(t,e)}setValid(t,e){return super.setValid(t,e)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,e=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,e),this}};var Vn=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,i){return t.prep(8,24),t.writeInt64(i),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}};var ar=new Int32Array(2),zs=new Float32Array(ar.buffer),Ws=new Float64Array(ar.buffer),Hn=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Ct=class{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?Ct.ZERO:new Ct(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}};Ct.ZERO=new Ct(0,0);var Fi;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(Fi||(Fi={}));var ue=class{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new ue(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new Ct(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new Ct(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return ar[0]=this.readInt32(t),zs[0]}readFloat64(t){return ar[Hn?0:1]=this.readInt32(t),ar[Hn?1:0]=this.readInt32(t+4),Ws[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){zs[0]=e,this.writeInt32(t,ar[0])}writeFloat64(t,e){Ws[0]=e,this.writeInt32(t,ar[Hn?0:1]),this.writeInt32(t+4,ar[Hn?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){let n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);let n=this.readInt32(t),i="",s=0;if(t+=4,e===Fi.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;s<n;){let o,u=this.readUint8(t+s++);if(u<192)o=u;else{let a=this.readUint8(t+s++);if(u<224)o=(u&31)<<6|a&63;else{let h=this.readUint8(t+s++);if(u<240)o=(u&15)<<12|(a&63)<<6|h&63;else{let m=this.readUint8(t+s++);o=(u&7)<<18|(a&63)<<12|(h&63)<<6|m&63}}}o<65536?i+=String.fromCharCode(o):(o-=65536,i+=String.fromCharCode((o>>10)+55296,(o&(1<<10)-1)+56320))}return i}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return Ct.create(t,e)}createScalarList(t,e){let n=[];for(let i=0;i<e;++i)t(i)!==null&&n.push(t(i));return n}createObjList(t,e){let n=[];for(let i=0;i<e;++i){let s=t(i);s!==null&&n.push(s.unpack())}return n}};var Xr=class{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=ue.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);let n=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<n+t+e;){let i=this.bb.capacity();this.bb=Xr.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let n=e<<1,i=ue.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);let n=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);let i=2;this.addInt16(t-this.object_start);let s=(n+i)*2;this.addInt16(s);let o=0,u=this.space;t:for(e=0;e<this.vtables.length;e++){let a=this.bb.capacity()-this.vtables[e];if(s==this.bb.readInt16(a)){for(let h=2;h<s;h+=2)if(this.bb.readInt16(u+h)!=this.bb.readInt16(a+h))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){let i=n?4:0;if(e){let s=e;if(this.prep(this.minalign,4+4+i),s.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let o=4-1;o>=0;o--)this.writeInt8(s.charCodeAt(o))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){let n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(this.bb.readInt16(i+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let i,s=t.charCodeAt(n++);if(s<55296||s>=56320)i=s;else{let o=t.charCodeAt(n++);i=(s<<10)+o+(65536-(55296<<10)-56320)}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(i&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,i=this.space,s=this.bb.bytes();n<e.length;n++)s[i++]=e[n];return this.endVector()}createLong(t,e){return Ct.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let e=[];for(let n=0;n<t.length;++n){let i=t[n];if(i!==null)e.push(this.createObjectOffset(i));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}};var yt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new yt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new yt).__init(t.readInt32(t.position())+t.position(),t)}key(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return yt.startKeyValue(t),yt.addKey(t,e),yt.addValue(t,n),yt.endKeyValue(t)}};var Kr;(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2",r[r.V3=2]="V3",r[r.V4=3]="V4",r[r.V5=4]="V5"})(Kr||(Kr={}));var Jr;(function(r){r[r.Little=0]="Little",r[r.Big=1]="Big"})(Jr||(Jr={}));var Ti;(function(r){r[r.DenseArray=0]="DenseArray"})(Ti||(Ti={}));var Kt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new Kt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new Kt).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return Kt.startInt(t),Kt.addBitWidth(t,e),Kt.addIsSigned(t,n),Kt.endInt(t)}};var Ne=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Ne).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new Ne).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new Kt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Ti.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,Ti.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}};var br=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new br).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new br).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return br.startBinary(t),br.endBinary(t)}};var gr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new gr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new gr).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return gr.startBool(t),gr.endBool(t)}};var Di;(function(r){r[r.DAY=0]="DAY",r[r.MILLISECOND=1]="MILLISECOND"})(Di||(Di={}));var me=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new me).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new me).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Di.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Di.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return me.startDate(t),me.addUnit(t,e),me.endDate(t)}};var Jt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new Jt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new Jt).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,i){return Jt.startDecimal(t),Jt.addPrecision(t,e),Jt.addScale(t,n),Jt.addBitWidth(t,i),Jt.endDecimal(t)}};var qr;(function(r){r[r.SECOND=0]="SECOND",r[r.MILLISECOND=1]="MILLISECOND",r[r.MICROSECOND=2]="MICROSECOND",r[r.NANOSECOND=3]="NANOSECOND"})(qr||(qr={}));var _e=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new _e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new _e).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return _e.startFixedSizeBinary(t),_e.addByteWidth(t,e),_e.endFixedSizeBinary(t)}};var ye=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new ye).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new ye).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return ye.startFixedSizeList(t),ye.addListSize(t,e),ye.endFixedSizeList(t)}};var Ei;(function(r){r[r.HALF=0]="HALF",r[r.SINGLE=1]="SINGLE",r[r.DOUBLE=2]="DOUBLE"})(Ei||(Ei={}));var be=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new be).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new be).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ei.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,Ei.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return be.startFloatingPoint(t),be.addPrecision(t,e),be.endFloatingPoint(t)}};var Oi;(function(r){r[r.YEAR_MONTH=0]="YEAR_MONTH",r[r.DAY_TIME=1]="DAY_TIME",r[r.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Oi||(Oi={}));var ge=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new ge).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new ge).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Oi.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Oi.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return ge.startInterval(t),ge.addUnit(t,e),ge.endInterval(t)}};var wr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new wr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new wr).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return wr.startList(t),wr.endList(t)}};var we=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new we).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new we).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return we.startMap(t),we.addKeysSorted(t,e),we.endMap(t)}};var vr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new vr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new vr).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return vr.startNull(t),vr.endNull(t)}};var Sr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Sr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new Sr).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Sr.startStruct_(t),Sr.endStruct_(t)}};var re=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new re).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new re).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):qr.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,qr.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return re.startTime(t),re.addUnit(t,e),re.addBitWidth(t,n),re.endTime(t)}};var ne=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new ne).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new ne).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):qr.SECOND}timezone(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,qr.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return ne.startTimestamp(t),ne.addUnit(t,e),ne.addTimezone(t,n),ne.endTimestamp(t)}};var Mi;(function(r){r[r.Sparse=0]="Sparse",r[r.Dense=1]="Dense"})(Mi||(Mi={}));var qt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Mi.Sparse}typeIds(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,Mi.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return qt.startUnion(t),qt.addMode(t,e),qt.addTypeIds(t,n),qt.endUnion(t)}};var Ir=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Ir).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new Ir).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Ir.startUtf8(t),Ir.endUtf8(t)}};var bt;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.FloatingPoint=3]="FloatingPoint",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct_=13]="Struct_",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Duration=18]="Duration",r[r.LargeBinary=19]="LargeBinary",r[r.LargeUtf8=20]="LargeUtf8",r[r.LargeList=21]="LargeList"})(bt||(bt={}));var Pt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):bt.NONE}type(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){let e=this.bb.__offset(this.bb_pos,12);return e?(t||new Ne).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){let n=this.bb.__offset(this.bb_pos,14);return n?(e||new Pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,16);return n?(e||new yt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,bt.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}};var xt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new xt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new xt).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Jr.Little}fields(t,e){let n=this.bb.__offset(this.bb_pos,6);return n?(e||new Pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new yt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+t*8):this.bb.createLong(0,0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,Jr.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,i,s){return xt.startSchema(t),xt.addEndianness(t,e),xt.addFields(t,n),xt.addCustomMetadata(t,i),xt.addFeatures(t,s),xt.endSchema(t)}};var ie=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new ie).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new ie).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Kr.V1}schema(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new xt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new Vn).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){let n=this.bb.__offset(this.bb_pos,10);return n?(e||new Vn).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,12);return n?(e||new yt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Kr.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}};var Q=class{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=xa(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,e)=>`${e}: ${t}`).join(", ")} }>`}select(t){let e=new Set(t),n=this.fields.filter(i=>e.has(i.name));return new Q(n,this.metadata)}selectAt(t){let e=t.map(n=>this.fields[n]).filter(Boolean);return new Q(e,this.metadata)}assign(...t){let e=t[0]instanceof Q?t[0]:Array.isArray(t[0])?new Q(t[0]):new Q(t),n=[...this.fields],i=Ys(Ys(new Map,this.metadata),e.metadata),s=e.fields.filter(u=>{let a=n.findIndex(h=>h.name===u.name);return~a?(n[a]=u.clone({metadata:Ys(Ys(new Map,n[a].metadata),u.metadata)}))&&!1:!0}),o=xa(s,new Map);return new Q([...n,...s],i,new Map([...this.dictionaries,...o]))}};Q.prototype.fields=null;Q.prototype.metadata=null;Q.prototype.dictionaries=null;var W=class{constructor(t,e,n=!1,i){this.name=t,this.type=e,this.nullable=n,this.metadata=i||new Map}static new(...t){let[e,n,i,s]=t;return t[0]&&typeof t[0]=="object"&&({name:e}=t[0],n===void 0&&(n=t[0].type),i===void 0&&(i=t[0].nullable),s===void 0&&(s=t[0].metadata)),new W(`${e}`,n,i,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,i,s]=t;return!t[0]||typeof t[0]!="object"?[e=this.name,n=this.type,i=this.nullable,s=this.metadata]=t:{name:e=this.name,type:n=this.type,nullable:i=this.nullable,metadata:s=this.metadata}=t[0],W.new(e,n,i,s)}};W.prototype.type=null;W.prototype.name=null;W.prototype.nullable=null;W.prototype.metadata=null;function Ys(r,t){return new Map([...r||new Map,...t||new Map])}function xa(r,t=new Map){for(let e=-1,n=r.length;++e<n;){let s=r[e].type;if(F.isDictionary(s)){if(!t.has(s.id))t.set(s.id,s.dictionary);else if(t.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&xa(s.children,t)}return t}var Od=Ct,Q_=Xr,ty=ue,Zr=class{constructor(t,e=Wt.V4,n,i){this.schema=t,this.version=e,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(t){t=new ty(M(t));let e=ie.getRootAsFooter(t),n=Q.decode(e.schema());return new Md(n,e)}static encode(t){let e=new Q_,n=Q.encode(e,t.schema);ie.startRecordBatchesVector(e,t.numRecordBatches);for(let o of[...t.recordBatches()].slice().reverse())cr.encode(e,o);let i=e.endVector();ie.startDictionariesVector(e,t.numDictionaries);for(let o of[...t.dictionaryBatches()].slice().reverse())cr.encode(e,o);let s=e.endVector();return ie.startFooter(e),ie.addSchema(e,n),ie.addVersion(e,Wt.V4),ie.addRecordBatches(e,i),ie.addDictionaries(e,s),ie.finishFooterBuffer(e,ie.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}};var Md=class extends Zr{constructor(t,e){super(t,e.version());this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let e=this._footer.recordBatches(t);if(e)return cr.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let e=this._footer.dictionaries(t);if(e)return cr.decode(e)}return null}},cr=class{constructor(t,e,n){this.metaDataLength=t,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof e=="number"?e:e.low}static decode(t){return new cr(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){let{metaDataLength:n}=e,i=new Od(e.offset,0),s=new Od(e.bodyLength,0);return Vn.createBlock(t,i,n,s)}};var dt=Object.freeze({done:!0,value:void 0}),Gs=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},zn=class{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},Ba=class extends zn{constructor(){super();this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return A(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(dt);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Yt.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Yt.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return A(this,void 0,void 0,function*(){return yield this.abort(t),dt})}return(t){return A(this,void 0,void 0,function*(){return yield this.close(),dt})}read(t){return A(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return A(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,n)=>{this.resolvers.push({resolve:e,reject:n})}):Promise.resolve(dt)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var Ar=class extends Ba{write(t){if((t=M(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?pi(this.toUint8Array(!0)):this.toUint8Array(!1).then(pi)}toUint8Array(t=!1){return t?fe(this._values)[0]:(()=>A(this,void 0,void 0,function*(){var e,n;let i=[],s=0;try{for(var o=Oe(this),u;u=yield o.next(),!u.done;){let a=u.value;i.push(a),s+=a.byteLength}}catch(a){e={error:a}}finally{try{u&&!u.done&&(n=o.return)&&(yield n.call(o))}finally{if(e)throw e.error}}return fe(i,s)[0]}))()}},xr=class{constructor(t){t&&(this.source=new Rd(Yt.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},ve=class{constructor(t){t instanceof ve?this.source=t.source:t instanceof Ar?this.source=new Qr(Yt.fromAsyncIterable(t)):ys(t)?this.source=new Qr(Yt.fromNodeStream(t)):yi(t)?this.source=new Qr(Yt.fromDOMStream(t)):ms(t)?this.source=new Qr(Yt.fromDOMStream(t.body)):We(t)?this.source=new Qr(Yt.fromIterable(t)):ze(t)?this.source=new Qr(Yt.fromAsyncIterable(t)):Me(t)&&(this.source=new Qr(Yt.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},Rd=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||dt)}return(t){return Object.create(this.source.return&&this.source.return(t)||dt)}},Qr=class{constructor(t){this.source=t,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(t){return A(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return A(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return A(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,e="read"){return A(this,void 0,void 0,function*(){return yield this.source.next({cmd:e,size:t})})}throw(t){return A(this,void 0,void 0,function*(){let e=this.source.throw&&(yield this.source.throw(t))||dt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}return(t){return A(this,void 0,void 0,function*(){let e=this.source.return&&(yield this.source.return(t))||dt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}};var $s=class extends xr{constructor(t,e){super();this.position=0,this.buffer=M(t),this.size=typeof e>"u"?this.buffer.byteLength:e}readInt32(t){let{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:e,size:n,position:i}=this;return e&&i<n?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),e.subarray(i,this.position)):null}readAt(t,e){let n=this.buffer,i=Math.min(this.size,t+e);return n?n.subarray(t,i):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},_n=class extends ve{constructor(t,e){super();this.position=0,this._handle=t,typeof e=="number"?this.size=e:this._pending=(()=>A(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return A(this,void 0,void 0,function*(){let{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)})}seek(t){return A(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return A(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:e,size:n,position:i}=this;if(e&&i<n){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let s=i,o=0,u=0,a=Math.min(n,s+Math.min(n-s,t)),h=new Uint8Array(Math.max(0,(this.position=a)-s));for(;(s+=u)<a&&(o+=u)<h.byteLength;)({bytesRead:u}=yield e.read(h,o,h.byteLength-o,s));return h}return null})}readAt(t,e){return A(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:n,size:i}=this;if(n&&t+e<i){let s=Math.min(i,t+e),o=new Uint8Array(s-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)})}close(){return A(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return A(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return A(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}};var Ta={};ln(Ta,{BaseInt64:()=>Xs,Int128:()=>Se,Int64:()=>Zt,Uint64:()=>it});function Wn(r){return r<0&&(r=4294967295+r+1),`0x${r.toString(16)}`}var jn=8,Fa=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Xs=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let e=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),i=e[3]*n[3];this.buffer[0]=i&65535;let s=i>>>16;return i=e[2]*n[3],s+=i,i=e[3]*n[2]>>>0,s+=i,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<i?65536:0,this.buffer[1]+=s>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){let e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Wn(this.buffer[1])} ${Wn(this.buffer[0])}`}},it=class extends Xs{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return it.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return it.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){let n=t.length,i=new it(e);for(let s=0;s<n;){let o=jn<n-s?jn:n-s,u=new it(new Uint32Array([Number.parseInt(t.slice(s,s+o),10),0])),a=new it(new Uint32Array([Fa[o],0]));i.times(a),i.plus(u),s+=o}return i}static convertArray(t){let e=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)it.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new it(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new it(new Uint32Array(t.buffer)).plus(e)}},Zt=class extends Xs{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return Zt.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return Zt.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){let n=t.startsWith("-"),i=t.length,s=new Zt(e);for(let o=n?1:0;o<i;){let u=jn<i-o?jn:i-o,a=new Zt(new Uint32Array([Number.parseInt(t.slice(o,o+u),10),0])),h=new Zt(new Uint32Array([Fa[u],0]));s.times(h),s.plus(a),o+=u}return n?s.negate():s}static convertArray(t){let e=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)Zt.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Zt(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Zt(new Uint32Array(t.buffer)).plus(e)}},Se=class{constructor(t){this.buffer=t}high(){return new Zt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Zt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let e=new it(new Uint32Array([this.buffer[3],0])),n=new it(new Uint32Array([this.buffer[2],0])),i=new it(new Uint32Array([this.buffer[1],0])),s=new it(new Uint32Array([this.buffer[0],0])),o=new it(new Uint32Array([t.buffer[3],0])),u=new it(new Uint32Array([t.buffer[2],0])),a=new it(new Uint32Array([t.buffer[1],0])),h=new it(new Uint32Array([t.buffer[0],0])),m=it.multiply(s,h);this.buffer[0]=m.low();let g=new it(new Uint32Array([m.high(),0]));return m=it.multiply(i,h),g.plus(m),m=it.multiply(s,a),g.plus(m),this.buffer[1]=g.low(),this.buffer[3]=g.lessThan(m)?1:0,this.buffer[2]=g.high(),new it(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(it.multiply(n,h)).plus(it.multiply(i,a)).plus(it.multiply(s,u)),this.buffer[3]+=it.multiply(e,h).plus(it.multiply(n,a)).plus(it.multiply(i,u)).plus(it.multiply(s,o)).low(),this}plus(t){let e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${Wn(this.buffer[3])} ${Wn(this.buffer[2])} ${Wn(this.buffer[1])} ${Wn(this.buffer[0])}`}static multiply(t,e){return new Se(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Se(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return Se.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return Se.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){let n=t.startsWith("-"),i=t.length,s=new Se(e);for(let o=n?1:0;o<i;){let u=jn<i-o?jn:i-o,a=new Se(new Uint32Array([Number.parseInt(t.slice(o,o+u),10),0,0,0])),h=new Se(new Uint32Array([Fa[u],0,0,0]));s.times(h),s.plus(a),o+=u}return n?s.negate():s}static convertArray(t){let e=new Uint32Array(t.length*4);for(let n=-1,i=t.length;++n<i;)Se.from(t[n],new Uint32Array(e.buffer,e.byteOffset+4*4*n,4));return e}};var Ks=class extends O{constructor(t,e,n,i){super();this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof W?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return P({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===It.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return P({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}},Da=class extends Ks{constructor(t,e,n,i){super(new Uint8Array(0),e,n,i);this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):hn(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return Y(Uint8Array,Y(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return Y(Uint8Array,Y(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){let{sources:n}=this;return F.isTimestamp(t)?Y(Uint8Array,Zt.convertArray(n[e])):(F.isInt(t)||F.isTime(t))&&t.bitWidth===64?Y(Uint8Array,Zt.convertArray(n[e])):F.isDate(t)&&t.unit===Gt.MILLISECOND?Y(Uint8Array,Zt.convertArray(n[e])):F.isDecimal(t)?Y(Uint8Array,Se.convertArray(n[e])):F.isBinary(t)||F.isFixedSizeBinary(t)?ey(n[e]):F.isBool(t)?hn(n[e]):F.isUtf8(t)?kr(n[e].join("")):Y(Uint8Array,Y(t.ArrayType,n[e].map(i=>+i)))}};function ey(r){let t=r.join(""),e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n>>1]=Number.parseInt(t.slice(n,n+2),16);return e}var Ri=class extends yr{constructor(t){super(t);this._values=new mn(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,M(e))}_flushPending(t,e){let n=this._offsets,i=this._values.reserve(e).buffer,s=0;for(let[o,u]of t)if(u===void 0)n.set(o,0);else{let a=u.length;i.set(u,s),n.set(o,a),s+=a}}};var Ea=class extends wt{constructor(t){super(t);this._values=new xi}setValue(t,e){this._values.set(t,+e)}};var Yn=class extends Xt{};Yn.prototype._setValue=pa;var Js=class extends Yn{};Js.prototype._setValue=vs;var qs=class extends Yn{};qs.prototype._setValue=Ss;var Zs=class extends Xt{};Zs.prototype._setValue=ya;var Oa=class extends wt{constructor({type:t,nullValues:e,dictionaryHashFunction:n}){super({type:new ke(t.dictionary,t.indices,t.id,t.isOrdered)});this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=yn({type:this.type.indices,nullValues:e}),this.dictionary=yn({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,e){let n=this.indices;return e=n.setValid(t,e),this.length=n.length,e}setValue(t,e){let n=this._keysToIndices,i=this.valueToKey(e),s=n[i];return s===void 0&&(n[i]=s=this._dictionaryOffset+this.dictionary.append(e).length-1),this.indices.setValue(t,s)}flush(){let t=this.type,e=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(t);return i.dictionary=e?e.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}};var Qs=class extends Xt{};Qs.prototype._setValue=ha;var Ma=class extends wt{setValue(t,e){let[n]=this.children,i=t*this.stride;for(let s=-1,o=e.length;++s<o;)n.set(i+s,e[s])}addChild(t,e="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let n=this.children.push(t);return this.type=new sr(this.type.listSize,new W(e,t.type,!0)),n}};var Gn=class extends Xt{setValue(t,e){this._values.set(t,e)}},Ra=class extends Gn{setValue(t,e){super.setValue(t,wi(e))}},ka=class extends Gn{},Ua=class extends Gn{};var $n=class extends Xt{};$n.prototype._setValue=ba;var to=class extends $n{};to.prototype._setValue=Os;var eo=class extends $n{};eo.prototype._setValue=Ms;var Je=class extends Xt{setValue(t,e){this._values.set(t,e)}},La=class extends Je{},Na=class extends Je{},Ca=class extends Je{},Pa=class extends Je{},Va=class extends Je{},Ha=class extends Je{},za=class extends Je{},Wa=class extends Je{};var ja=class extends yr{constructor(t){super(t);this._offsets=new Bi}addChild(t,e="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new nr(new W(e,t.type,!0)),this.numChildren-1}_flushPending(t){let e=this._offsets,[n]=this.children;for(let[i,s]of t)if(s===void 0)e.set(i,0);else{let o=s.length,u=e.set(i,o).buffer[i];for(let a=-1;++a<o;)n.set(u+a,s[a])}}};var Ya=class extends yr{set(t,e){return super.set(t,e)}setValue(t,e){let n=e instanceof Map?e:new Map(Object.entries(e)),i=this._pending||(this._pending=new Map),s=i.get(t);s&&(this._pendingLength-=s.size),this._pendingLength+=n.size,i.set(t,n)}addChild(t,e=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new or(new W(e,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let e=this._offsets,[n]=this.children;for(let[i,s]of t)if(s===void 0)e.set(i,0);else{let{[i]:o,[i+1]:u}=e.set(i,s.size).buffer;for(let a of s.entries())if(n.set(o,a),++o>=u)break}}};var Ga=class extends wt{setValue(t,e){}setValid(t,e){return this.length=Math.max(t+1,this.length),e}};var $a=class extends wt{setValue(t,e){let n=this.children;switch(Array.isArray(e)||e.constructor){case!0:return this.type.children.forEach((i,s)=>n[s].set(t,e[s]));case Map:return this.type.children.forEach((i,s)=>n[s].set(t,e.get(i.name)));default:return this.type.children.forEach((i,s)=>n[s].set(t,e[i.name]))}}addChild(t,e=`${this.numChildren}`){let n=this.children.push(t);return this.type=new _t([...this.type.children,new W(e,t.type,!0)]),n}};var tn=class extends Xt{};tn.prototype._setValue=ma;var ro=class extends tn{};ro.prototype._setValue=Is;var no=class extends tn{};no.prototype._setValue=As;var io=class extends tn{};io.prototype._setValue=xs;var so=class extends tn{};so.prototype._setValue=Bs;var en=class extends Xt{};en.prototype._setValue=_a;var oo=class extends en{};oo.prototype._setValue=Fs;var ao=class extends en{};ao.prototype._setValue=Ts;var co=class extends en{};co.prototype._setValue=Ds;var uo=class extends en{};uo.prototype._setValue=Es;var ki=class extends wt{constructor(t){super(t);this._typeIds=new $r(new Int8Array(0),1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,e){return this.set(this.length,t,e)}set(t,e,n){return n===void 0&&(n=this._valueToChildTypeId(this,e,t)),this.setValid(t,this.isValid(e))&&this.setValue(t,e,n),this}setValue(t,e,n){this._typeIds.set(t,n);let i=this.type.typeIdToChildIndex[n],s=this.children[i];s==null||s.set(t,e)}addChild(t,e=`${this.children.length}`){let n=this.children.push(t),{type:{children:i,mode:s,typeIds:o}}=this,u=[...i,new W(e,t.type)];return this.type=new ir(s,[...o,n],u),n}_valueToChildTypeId(t,e,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},Xa=class extends ki{},Ka=class extends ki{constructor(t){super(t);this._offsets=new $r(new Int32Array(0))}setValue(t,e,n){let i=this._typeIds.set(t,n).buffer[t],s=this.getChildAt(this.type.typeIdToChildIndex[i]),o=this._offsets.set(t,s.length).buffer[t];s==null||s.set(o,e)}};var lo=class extends yr{constructor(t){super(t);this._values=new mn(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,kr(e))}_flushPending(t,e){}};lo.prototype._flushPending=Ri.prototype._flushPending;var kd=class extends O{visitNull(){return Ga}visitBool(){return Ea}visitInt(){return Je}visitInt8(){return La}visitInt16(){return Na}visitInt32(){return Ca}visitInt64(){return Pa}visitUint8(){return Va}visitUint16(){return Ha}visitUint32(){return za}visitUint64(){return Wa}visitFloat(){return Gn}visitFloat16(){return Ra}visitFloat32(){return ka}visitFloat64(){return Ua}visitUtf8(){return lo}visitBinary(){return Ri}visitFixedSizeBinary(){return Qs}visitDate(){return Yn}visitDateDay(){return Js}visitDateMillisecond(){return qs}visitTimestamp(){return tn}visitTimestampSecond(){return ro}visitTimestampMillisecond(){return no}visitTimestampMicrosecond(){return io}visitTimestampNanosecond(){return so}visitTime(){return en}visitTimeSecond(){return oo}visitTimeMillisecond(){return ao}visitTimeMicrosecond(){return co}visitTimeNanosecond(){return uo}visitDecimal(){return Zs}visitList(){return ja}visitStruct(){return $a}visitUnion(){return ki}visitDenseUnion(){return Ka}visitSparseUnion(){return Xa}visitDictionary(){return Oa}visitInterval(){return $n}visitIntervalDayTime(){return to}visitIntervalYearMonth(){return eo}visitFixedSizeList(){return Ma}visitMap(){return Ya}},Ud=new kd;function yn(r){let t=r.type,e=new(Ud.getVisitFn(t)())(r);if(t.children&&t.children.length>0){let n=r.children||[],i={nullValues:r.nullValues},s=Array.isArray(n)?(o,u)=>n[u]||i:({name:o})=>n[o]||i;for(let[o,u]of t.children.entries()){let{type:a}=u,h=s(u,o);e.children.push(yn(Object.assign(Object.assign({},h),{type:a})))}}return e}var L=class extends O{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((n,i)=>this.compareFields(n,e[i]))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}};function le(r,t){return t instanceof r.constructor}function Ui(r,t){return r===t||le(r,t)}function Br(r,t){return r===t||le(r,t)&&r.bitWidth===t.bitWidth&&r.isSigned===t.isSigned}function fo(r,t){return r===t||le(r,t)&&r.precision===t.precision}function ry(r,t){return r===t||le(r,t)&&r.byteWidth===t.byteWidth}function Ja(r,t){return r===t||le(r,t)&&r.unit===t.unit}function Li(r,t){return r===t||le(r,t)&&r.unit===t.unit&&r.timezone===t.timezone}function Ni(r,t){return r===t||le(r,t)&&r.unit===t.unit&&r.bitWidth===t.bitWidth}function ny(r,t){return r===t||le(r,t)&&r.children.length===t.children.length&&ur.compareManyFields(r.children,t.children)}function iy(r,t){return r===t||le(r,t)&&r.children.length===t.children.length&&ur.compareManyFields(r.children,t.children)}function qa(r,t){return r===t||le(r,t)&&r.mode===t.mode&&r.typeIds.every((e,n)=>e===t.typeIds[n])&&ur.compareManyFields(r.children,t.children)}function sy(r,t){return r===t||le(r,t)&&r.id===t.id&&r.isOrdered===t.isOrdered&&ur.visit(r.indices,t.indices)&&ur.visit(r.dictionary,t.dictionary)}function Za(r,t){return r===t||le(r,t)&&r.unit===t.unit}function oy(r,t){return r===t||le(r,t)&&r.listSize===t.listSize&&r.children.length===t.children.length&&ur.compareManyFields(r.children,t.children)}function ay(r,t){return r===t||le(r,t)&&r.keysSorted===t.keysSorted&&r.children.length===t.children.length&&ur.compareManyFields(r.children,t.children)}L.prototype.visitNull=Ui;L.prototype.visitBool=Ui;L.prototype.visitInt=Br;L.prototype.visitInt8=Br;L.prototype.visitInt16=Br;L.prototype.visitInt32=Br;L.prototype.visitInt64=Br;L.prototype.visitUint8=Br;L.prototype.visitUint16=Br;L.prototype.visitUint32=Br;L.prototype.visitUint64=Br;L.prototype.visitFloat=fo;L.prototype.visitFloat16=fo;L.prototype.visitFloat32=fo;L.prototype.visitFloat64=fo;L.prototype.visitUtf8=Ui;L.prototype.visitBinary=Ui;L.prototype.visitFixedSizeBinary=ry;L.prototype.visitDate=Ja;L.prototype.visitDateDay=Ja;L.prototype.visitDateMillisecond=Ja;L.prototype.visitTimestamp=Li;L.prototype.visitTimestampSecond=Li;L.prototype.visitTimestampMillisecond=Li;L.prototype.visitTimestampMicrosecond=Li;L.prototype.visitTimestampNanosecond=Li;L.prototype.visitTime=Ni;L.prototype.visitTimeSecond=Ni;L.prototype.visitTimeMillisecond=Ni;L.prototype.visitTimeMicrosecond=Ni;L.prototype.visitTimeNanosecond=Ni;L.prototype.visitDecimal=Ui;L.prototype.visitList=ny;L.prototype.visitStruct=iy;L.prototype.visitUnion=qa;L.prototype.visitDenseUnion=qa;L.prototype.visitSparseUnion=qa;L.prototype.visitDictionary=sy;L.prototype.visitInterval=Za;L.prototype.visitIntervalDayTime=Za;L.prototype.visitIntervalYearMonth=Za;L.prototype.visitFixedSizeList=oy;L.prototype.visitMap=ay;var ur=new L;function bn(r,t){return ur.compareSchemas(r,t)}function Ld(r,t){return ur.compareFields(r,t)}function Nd(r,t){return ur.visit(r,t)}function ho(r,t){return cy(r,t.map(e=>e.data.concat()))}function cy(r,t){let e=[...r.fields],n=[],i={numBatches:t.reduce((g,S)=>Math.max(g,S.length),0)},s=0,o=0,u=-1,a=t.length,h,m=[];for(;i.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,u=-1;++u<a;)m[u]=h=t[u].shift(),o=Math.min(o,h?h.length:o);Number.isFinite(o)&&(m=uy(e,o,m,t,i),o>0&&(n[s++]=P({type:new _t(e),length:o,nullCount:0,children:m.slice()})))}return[r=r.assign(e),n.map(g=>new ft(r,g))]}function uy(r,t,e,n,i){var s;let o=(t+63&-64)>>3;for(let u=-1,a=n.length;++u<a;){let h=e[u],m=h==null?void 0:h.length;if(m>=t)m===t?e[u]=h:(e[u]=h.slice(0,t),i.numBatches=Math.max(i.numBatches,n[u].unshift(h.slice(t,m-t))));else{let g=r[u];r[u]=g.clone({nullable:!0}),e[u]=(s=h==null?void 0:h._changeLengthAndBackfillNullBitmap(t))!==null&&s!==void 0?s:P({type:g.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return e}var Cd,Dt=class{constructor(...t){var e,n;if(t.length===0)return this.batches=[],this.schema=new Q([]),this._offsets=[0],this;let i,s;t[0]instanceof Q&&(i=t.shift()),t[t.length-1]instanceof Uint32Array&&(s=t.pop());let o=a=>{if(a){if(a instanceof ft)return[a];if(a instanceof Dt)return a.batches;if(a instanceof nt){if(a.type instanceof _t)return[new ft(new Q(a.type.children),a)]}else{if(Array.isArray(a))return a.flatMap(h=>o(h));if(typeof a[Symbol.iterator]=="function")return[...a].flatMap(h=>o(h));if(typeof a=="object"){let h=Object.keys(a),m=h.map(I=>new C([a[I]])),g=new Q(h.map((I,Z)=>new W(String(I),m[Z].type))),[,S]=ho(g,m);return S.length===0?[new ft(a)]:S}}}return[]},u=t.flatMap(a=>o(a));if(i=(n=i!=null?i:(e=u[0])===null||e===void 0?void 0:e.schema)!==null&&n!==void 0?n:new Q([]),!(i instanceof Q))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let a of u){if(!(a instanceof ft))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!bn(i,a.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=u,this._offsets=s!=null?s:Cs(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,e)=>t+e.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Ns(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return Pn.visit(new C(this.data))}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let e=this.schema,n=this.data.concat(t.flatMap(({data:i})=>i));return new Dt(e,n.map(i=>new ft(e,i)))}slice(t,e){let n=this.schema;[t,e]=vi({length:this.numRows},t,e);let i=Ps(this.data,this._offsets,t,e);return new Dt(n,i.map(s=>new ft(n,s)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(e=>e.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let e=this.data.map(n=>n.children[t]);if(e.length===0){let{type:n}=this.schema.fields[t],i=P({type:n,length:0,nullCount:0});e.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new C(e)}return null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),e)}setChildAt(t,e){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new C([P({type:new ce,length:this.numRows})]));let s=n.fields.slice(),o=s[t].clone({type:e.type}),u=this.schema.fields.map((a,h)=>this.getChildAt(h));[s[t],u[t]]=[o,e],[n,i]=ho(n,u)}return new Dt(n,i)}select(t){let e=this.schema.fields.reduce((n,i,s)=>n.set(i.name,s),new Map);return this.selectAt(t.map(n=>e.get(n)).filter(n=>n>-1))}selectAt(t){let e=this.schema.selectAt(t),n=this.batches.map(i=>i.selectAt(t));return new Dt(e,n)}assign(t){let e=this.schema.fields,[n,i]=t.schema.fields.reduce((u,a,h)=>{let[m,g]=u,S=e.findIndex(I=>I.name===a.name);return~S?g[S]=h:m.push(h),u},[[],[]]),s=this.schema.assign(t.schema),o=[...e.map((u,a)=>[a,i[a]]).map(([u,a])=>a===void 0?this.getChildAt(u):t.getChildAt(a)),...n.map(u=>t.getChildAt(u))].filter(Boolean);return new Dt(...ho(s,o))}};Cd=Symbol.toStringTag;Dt[Cd]=(r=>(r.schema=null,r.batches=[],r._offsets=new Uint32Array([0]),r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,r.isValid=Gr(Ii),r.get=Gr(Mt.getVisitFn(p.Struct)),r.set=Vs($t.getVisitFn(p.Struct)),r.indexOf=Hs(pn.getVisitFn(p.Struct)),r.getByteLength=Gr(Xe.getVisitFn(p.Struct)),"Table"))(Dt.prototype);var Vd,ft=class{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof Q))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=P({nullCount:0,type:new _t(this.schema.fields),children:this.schema.fields.map(e=>P({type:e.type,nullCount:0}))})]=t,!(this.data instanceof nt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Pd(this.schema,this.data.children);break}case 1:{let[e]=t,{fields:n,children:i,length:s}=Object.keys(e).reduce((a,h,m)=>(a.children[m]=e[h],a.length=Math.max(a.length,e[h].length),a.fields[m]=W.new({name:h,type:e[h].type,nullable:!0}),a),{length:0,fields:new Array,children:new Array}),o=new Q(n),u=P({type:new _t(n),length:s,children:i,nullCount:0});[this.schema,this.data]=Pd(o,u.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Hd(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Mt.visit(this.data,t)}set(t,e){return $t.visit(this.data,t,e)}indexOf(t,e){return pn.visit(this.data,t,e)}getByteLength(t){return Xe.visit(this.data,t)}[Symbol.iterator](){return Pn.visit(new C([this.data]))}toArray(){return[...this]}concat(...t){return new Dt(this.schema,[this,...t])}slice(t,e){let[n]=new C([this.data]).slice(t,e).data;return new ft(this.schema,n)}getChild(t){var e;return this.getChildAt((e=this.schema.fields)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new C([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),e)}setChildAt(t,e){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){e||(e=new C([P({type:new ce,length:this.numRows})]));let s=n.fields.slice(),o=i.children.slice(),u=s[t].clone({type:e.type});[s[t],o[t]]=[u,e.data[0]],n=new Q(s,new Map(this.schema.metadata)),i=P({type:new _t(s),children:o})}return new ft(n,i)}select(t){let e=this.schema.select(t),n=new _t(e.fields),i=[];for(let s of t){let o=this.schema.fields.findIndex(u=>u.name===s);~o&&(i[o]=this.data.children[o])}return new ft(e,P({type:n,length:this.numRows,children:i}))}selectAt(t){let e=this.schema.selectAt(t),n=t.map(s=>this.data.children[s]).filter(Boolean),i=P({type:new _t(e.fields),length:this.numRows,children:n});return new ft(e,i)}};Vd=Symbol.toStringTag;ft[Vd]=(r=>(r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(ft.prototype);function Pd(r,t,e=t.reduce((n,i)=>Math.max(n,i.length),0)){var n;let i=[...r.fields],s=[...t],o=(e+63&-64)>>3;for(let[u,a]of r.fields.entries()){let h=t[u];(!h||h.length!==e)&&(i[u]=a.clone({nullable:!0}),s[u]=(n=h==null?void 0:h._changeLengthAndBackfillNullBitmap(e))!==null&&n!==void 0?n:P({type:a.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)}))}return[r.assign(i),P({type:new _t(i),length:e,children:s})]}function Hd(r,t,e=new Map){for(let n=-1,i=r.length;++n<i;){let o=r[n].type,u=t[n];if(F.isDictionary(o)){if(!e.has(o.id))u.dictionary&&e.set(o.id,u.dictionary);else if(e.get(o.id)!==u.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&Hd(o.children,u.children,e)}return e}var Xn=class extends ft{constructor(t){let e=t.fields.map(i=>P({type:i.type})),n=P({type:new _t(t.fields),nullCount:0,children:e});super(t,n)}};var Ci;(function(r){r[r.BUFFER=0]="BUFFER"})(Ci||(Ci={}));var Pi;(function(r){r[r.LZ4_FRAME=0]="LZ4_FRAME",r[r.ZSTD=1]="ZSTD"})(Pi||(Pi={}));var lr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new lr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new lr).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Pi.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Ci.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Pi.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Ci.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return lr.startBodyCompression(t),lr.addCodec(t,e),lr.addMethod(t,n),lr.endBodyCompression(t)}};var Vi=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}};var Hi=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}};var se=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new se).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new se).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){let n=this.bb.__offset(this.bb_pos,6);return n?(e||new Hi).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new Vi).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let e=this.bb.__offset(this.bb_pos,10);return e?(t||new lr).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}};var qe=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new qe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new qe).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new se).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}};var Kn;(function(r){r[r.NONE=0]="NONE",r[r.Schema=1]="Schema",r[r.DictionaryBatch=2]="DictionaryBatch",r[r.RecordBatch=3]="RecordBatch",r[r.Tensor=4]="Tensor",r[r.SparseTensor=5]="SparseTensor"})(Kn||(Kn={}));var Rt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new Rt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new Rt).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Kr.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Kn.NONE}header(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,12);return n?(e||new yt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Kr.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,Kn.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,i,s,o){return Rt.startMessage(t),Rt.addVersion(t,e),Rt.addHeaderType(t,n),Rt.addHeader(t,i),Rt.addBodyLength(t,s),Rt.addCustomMetadata(t,o),Rt.endMessage(t)}};var dy=Ct,zd=class extends O{visit(t,e){return t==null||e==null?void 0:super.visit(t,e)}visitNull(t,e){return vr.startNull(e),vr.endNull(e)}visitInt(t,e){return Kt.startInt(e),Kt.addBitWidth(e,t.bitWidth),Kt.addIsSigned(e,t.isSigned),Kt.endInt(e)}visitFloat(t,e){return be.startFloatingPoint(e),be.addPrecision(e,t.precision),be.endFloatingPoint(e)}visitBinary(t,e){return br.startBinary(e),br.endBinary(e)}visitBool(t,e){return gr.startBool(e),gr.endBool(e)}visitUtf8(t,e){return Ir.startUtf8(e),Ir.endUtf8(e)}visitDecimal(t,e){return Jt.startDecimal(e),Jt.addScale(e,t.scale),Jt.addPrecision(e,t.precision),Jt.addBitWidth(e,t.bitWidth),Jt.endDecimal(e)}visitDate(t,e){return me.startDate(e),me.addUnit(e,t.unit),me.endDate(e)}visitTime(t,e){return re.startTime(e),re.addUnit(e,t.unit),re.addBitWidth(e,t.bitWidth),re.endTime(e)}visitTimestamp(t,e){let n=t.timezone&&e.createString(t.timezone)||void 0;return ne.startTimestamp(e),ne.addUnit(e,t.unit),n!==void 0&&ne.addTimezone(e,n),ne.endTimestamp(e)}visitInterval(t,e){return ge.startInterval(e),ge.addUnit(e,t.unit),ge.endInterval(e)}visitList(t,e){return wr.startList(e),wr.endList(e)}visitStruct(t,e){return Sr.startStruct_(e),Sr.endStruct_(e)}visitUnion(t,e){qt.startTypeIdsVector(e,t.typeIds.length);let n=qt.createTypeIdsVector(e,t.typeIds);return qt.startUnion(e),qt.addMode(e,t.mode),qt.addTypeIds(e,n),qt.endUnion(e)}visitDictionary(t,e){let n=this.visit(t.indices,e);return Ne.startDictionaryEncoding(e),Ne.addId(e,new dy(t.id,0)),Ne.addIsOrdered(e,t.isOrdered),n!==void 0&&Ne.addIndexType(e,n),Ne.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return _e.startFixedSizeBinary(e),_e.addByteWidth(e,t.byteWidth),_e.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return ye.startFixedSizeList(e),ye.addListSize(e,t.listSize),ye.endFixedSizeList(e)}visitMap(t,e){return we.startMap(e),we.addKeysSorted(e,t.keysSorted),we.endMap(e)}},po=new zd;function Gd(r,t=new Map){return new Q(fy(r,t),mo(r.customMetadata),t)}function Qa(r){return new Qt(r.count,Xd(r.columns),Kd(r.columns))}function $d(r){return new Ae(Qa(r.data),r.id,r.isDelta)}function fy(r,t){return(r.fields||[]).filter(Boolean).map(e=>W.fromJSON(e,t))}function Wd(r,t){return(r.children||[]).filter(Boolean).map(e=>W.fromJSON(e,t))}function Xd(r){return(r||[]).reduce((t,e)=>[...t,new dr(e.count,hy(e.VALIDITY)),...Xd(e.children)],[])}function Kd(r,t=[]){for(let e=-1,n=(r||[]).length;++e<n;){let i=r[e];i.VALIDITY&&t.push(new Ie(t.length,i.VALIDITY.length)),i.TYPE&&t.push(new Ie(t.length,i.TYPE.length)),i.OFFSET&&t.push(new Ie(t.length,i.OFFSET.length)),i.DATA&&t.push(new Ie(t.length,i.DATA.length)),t=Kd(i.children,t)}return t}function hy(r){return(r||[]).reduce((t,e)=>t+ +(e===0),0)}function Jd(r,t){let e,n,i,s,o,u;return!t||!(s=r.dictionary)?(o=Yd(r,Wd(r,t)),i=new W(r.name,o,r.nullable,mo(r.customMetadata))):t.has(e=s.id)?(n=(n=s.indexType)?jd(n):new hr,u=new ke(t.get(e),n,e,s.isOrdered),i=new W(r.name,u,r.nullable,mo(r.customMetadata))):(n=(n=s.indexType)?jd(n):new hr,t.set(e,o=Yd(r,Wd(r,t))),u=new ke(o,n,e,s.isOrdered),i=new W(r.name,u,r.nullable,mo(r.customMetadata))),i||null}function mo(r){return new Map(Object.entries(r||{}))}function jd(r){return new Ot(r.isSigned,r.bitWidth)}function Yd(r,t){let e=r.type.name;switch(e){case"NONE":return new ce;case"null":return new ce;case"binary":return new Lr;case"utf8":return new Nr;case"bool":return new Cr;case"list":return new nr((t||[])[0]);case"struct":return new _t(t||[]);case"struct_":return new _t(t||[])}switch(e){case"int":{let n=r.type;return new Ot(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=r.type;return new he(mt[n.precision])}case"decimal":{let n=r.type;return new Pr(n.scale,n.precision,n.bitWidth)}case"date":{let n=r.type;return new Vr(Gt[n.unit])}case"time":{let n=r.type;return new rr(q[n.unit],n.bitWidth)}case"timestamp":{let n=r.type;return new Hr(q[n.unit],n.timezone)}case"interval":{let n=r.type;return new zr(ee[n.unit])}case"union":{let n=r.type;return new ir(It[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{let n=r.type;return new Wr(n.byteWidth)}case"fixedsizelist":{let n=r.type;return new sr(n.listSize,(t||[])[0])}case"map":{let n=r.type;return new or((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${e}"`)}var gn=Ct,py=Xr,my=ue,Vt=class{constructor(t,e,n,i){this._version=e,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,e){let n=new Vt(0,Wt.V4,e);return n._createHeader=_y(t,e),n}static decode(t){t=new my(M(t));let e=Rt.getRootAsMessage(t),n=e.bodyLength(),i=e.version(),s=e.headerType(),o=new Vt(n,i,s);return o._createHeader=yy(e,s),o}static encode(t){let e=new py,n=-1;return t.isSchema()?n=Q.encode(e,t.header()):t.isRecordBatch()?n=Qt.encode(e,t.header()):t.isDictionaryBatch()&&(n=Ae.encode(e,t.header())),Rt.startMessage(e),Rt.addVersion(e,Wt.V4),Rt.addHeader(e,n),Rt.addHeaderType(e,t.headerType),Rt.addBodyLength(e,new gn(t.bodyLength,0)),Rt.finishMessageBuffer(e,Rt.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof Q)return new Vt(0,Wt.V4,et.Schema,t);if(t instanceof Qt)return new Vt(e,Wt.V4,et.RecordBatch,t);if(t instanceof Ae)return new Vt(e,Wt.V4,et.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===et.Schema}isRecordBatch(){return this.headerType===et.RecordBatch}isDictionaryBatch(){return this.headerType===et.DictionaryBatch}},Qt=class{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}},Ae=class{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id=typeof e=="number"?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}},Ie=class{constructor(t,e){this.offset=typeof t=="number"?t:t.low,this.length=typeof e=="number"?e:e.low}},dr=class{constructor(t,e){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof e=="number"?e:e.low}};function _y(r,t){return()=>{switch(t){case et.Schema:return Q.fromJSON(r);case et.RecordBatch:return Qt.fromJSON(r);case et.DictionaryBatch:return Ae.fromJSON(r)}throw new Error(`Unrecognized Message type: { name: ${et[t]}, type: ${t} }`)}}function yy(r,t){return()=>{switch(t){case et.Schema:return Q.decode(r.header(new xt));case et.RecordBatch:return Qt.decode(r.header(new se),r.version());case et.DictionaryBatch:return Ae.decode(r.header(new qe),r.version())}throw new Error(`Unrecognized Message type: { name: ${et[t]}, type: ${t} }`)}}W.encode=Ty;W.decode=By;W.fromJSON=Jd;Q.encode=Fy;Q.decode=by;Q.fromJSON=Gd;Qt.encode=Dy;Qt.decode=gy;Qt.fromJSON=Qa;Ae.encode=Ey;Ae.decode=wy;Ae.fromJSON=$d;dr.encode=Oy;dr.decode=Sy;Ie.encode=My;Ie.decode=vy;function by(r,t=new Map){let e=xy(r,t);return new Q(e,_o(r),t)}function gy(r,t=Wt.V4){return new Qt(r.length(),Iy(r),Ay(r,t))}function wy(r,t=Wt.V4){return new Ae(Qt.decode(r.data(),t),r.id(),r.isDelta())}function vy(r){return new Ie(r.offset(),r.length())}function Sy(r){return new dr(r.length(),r.nullCount())}function Iy(r){let t=[];for(let e,n=-1,i=-1,s=r.nodesLength();++n<s;)(e=r.nodes(n))&&(t[++i]=dr.decode(e));return t}function Ay(r,t){let e=[];for(let n,i=-1,s=-1,o=r.buffersLength();++i<o;)(n=r.buffers(i))&&(t<Wt.V4&&(n.bb_pos+=8*(i+1)),e[++s]=Ie.decode(n));return e}function xy(r,t){let e=[];for(let n,i=-1,s=-1,o=r.fieldsLength();++i<o;)(n=r.fields(i))&&(e[++s]=W.decode(n,t));return e}function qd(r,t){let e=[];for(let n,i=-1,s=-1,o=r.childrenLength();++i<o;)(n=r.children(i))&&(e[++s]=W.decode(n,t));return e}function By(r,t){let e,n,i,s,o,u;return!t||!(u=r.dictionary())?(i=Qd(r,qd(r,t)),n=new W(r.name(),i,r.nullable(),_o(r))):t.has(e=u.id().low)?(s=(s=u.indexType())?Zd(s):new hr,o=new ke(t.get(e),s,e,u.isOrdered()),n=new W(r.name(),o,r.nullable(),_o(r))):(s=(s=u.indexType())?Zd(s):new hr,t.set(e,i=Qd(r,qd(r,t))),o=new ke(i,s,e,u.isOrdered()),n=new W(r.name(),o,r.nullable(),_o(r))),n||null}function _o(r){let t=new Map;if(r)for(let e,n,i=-1,s=Math.trunc(r.customMetadataLength());++i<s;)(e=r.customMetadata(i))&&(n=e.key())!=null&&t.set(n,e.value());return t}function Zd(r){return new Ot(r.isSigned(),r.bitWidth())}function Qd(r,t){let e=r.typeType();switch(e){case bt.NONE:return new ce;case bt.Null:return new ce;case bt.Binary:return new Lr;case bt.Utf8:return new Nr;case bt.Bool:return new Cr;case bt.List:return new nr((t||[])[0]);case bt.Struct_:return new _t(t||[])}switch(e){case bt.Int:{let n=r.type(new Kt);return new Ot(n.isSigned(),n.bitWidth())}case bt.FloatingPoint:{let n=r.type(new be);return new he(n.precision())}case bt.Decimal:{let n=r.type(new Jt);return new Pr(n.scale(),n.precision(),n.bitWidth())}case bt.Date:{let n=r.type(new me);return new Vr(n.unit())}case bt.Time:{let n=r.type(new re);return new rr(n.unit(),n.bitWidth())}case bt.Timestamp:{let n=r.type(new ne);return new Hr(n.unit(),n.timezone())}case bt.Interval:{let n=r.type(new ge);return new zr(n.unit())}case bt.Union:{let n=r.type(new qt);return new ir(n.mode(),n.typeIdsArray()||[],t||[])}case bt.FixedSizeBinary:{let n=r.type(new _e);return new Wr(n.byteWidth())}case bt.FixedSizeList:{let n=r.type(new ye);return new sr(n.listSize(),(t||[])[0])}case bt.Map:{let n=r.type(new we);return new or((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${bt[e]}" (${e})`)}function Fy(r,t){let e=t.fields.map(s=>W.encode(r,s));xt.startFieldsVector(r,e.length);let n=xt.createFieldsVector(r,e),i=t.metadata&&t.metadata.size>0?xt.createCustomMetadataVector(r,[...t.metadata].map(([s,o])=>{let u=r.createString(`${s}`),a=r.createString(`${o}`);return yt.startKeyValue(r),yt.addKey(r,u),yt.addValue(r,a),yt.endKeyValue(r)})):-1;return xt.startSchema(r),xt.addFields(r,n),xt.addEndianness(r,Ry?Jr.Little:Jr.Big),i!==-1&&xt.addCustomMetadata(r,i),xt.endSchema(r)}function Ty(r,t){let e=-1,n=-1,i=-1,s=t.type,o=t.typeId;F.isDictionary(s)?(o=s.dictionary.typeId,i=po.visit(s,r),n=po.visit(s.dictionary,r)):n=po.visit(s,r);let u=(s.children||[]).map(m=>W.encode(r,m)),a=Pt.createChildrenVector(r,u),h=t.metadata&&t.metadata.size>0?Pt.createCustomMetadataVector(r,[...t.metadata].map(([m,g])=>{let S=r.createString(`${m}`),I=r.createString(`${g}`);return yt.startKeyValue(r),yt.addKey(r,S),yt.addValue(r,I),yt.endKeyValue(r)})):-1;return t.name&&(e=r.createString(t.name)),Pt.startField(r),Pt.addType(r,n),Pt.addTypeType(r,o),Pt.addChildren(r,a),Pt.addNullable(r,!!t.nullable),e!==-1&&Pt.addName(r,e),i!==-1&&Pt.addDictionary(r,i),h!==-1&&Pt.addCustomMetadata(r,h),Pt.endField(r)}function Dy(r,t){let e=t.nodes||[],n=t.buffers||[];se.startNodesVector(r,e.length);for(let o of e.slice().reverse())dr.encode(r,o);let i=r.endVector();se.startBuffersVector(r,n.length);for(let o of n.slice().reverse())Ie.encode(r,o);let s=r.endVector();return se.startRecordBatch(r),se.addLength(r,new gn(t.length,0)),se.addNodes(r,i),se.addBuffers(r,s),se.endRecordBatch(r)}function Ey(r,t){let e=Qt.encode(r,t.data);return qe.startDictionaryBatch(r),qe.addId(r,new gn(t.id,0)),qe.addIsDelta(r,t.isDelta),qe.addData(r,e),qe.endDictionaryBatch(r)}function Oy(r,t){return Hi.createFieldNode(r,new gn(t.length,0),new gn(t.nullCount,0))}function My(r,t){return Vi.createBuffer(r,new gn(t.offset,0),new gn(t.length,0))}var Ry=(()=>{let r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256})();var ec=r=>`Expected ${et[r]} Message in stream, but was null or length 0.`,rc=r=>`Header pointer of flatbuffer-encoded ${et[r]} Message is null or length 0.`,tf=(r,t)=>`Expected to read ${r} metadata bytes, but only read ${t}.`,ef=(r,t)=>`Expected to read ${r} bytes for message body, but only read ${t}.`,zi=class{constructor(t){this.source=t instanceof xr?t:new xr(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done?dt:t.value===-1&&(t=this.readMetadataLength()).done?dt:(t=this.readMetadata(t.value)).done?dt:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(ec(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let e=M(this.source.read(t));if(e.byteLength<t)throw new Error(ef(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){let e=et.Schema,n=this.readMessage(e),i=n==null?void 0:n.header();if(t&&!i)throw new Error(rc(e));return i}readMetadataLength(){let t=this.source.read(go),e=t&&new ue(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}}readMetadata(t){let e=this.source.read(t);if(!e)return dt;if(e.byteLength<t)throw new Error(tf(t,e.byteLength));return{done:!1,value:Vt.decode(e)}}},yo=class{constructor(t,e){this.source=t instanceof ve?t:ps(t)?new _n(t,e):new ve(t)}[Symbol.asyncIterator](){return this}next(){return A(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done?dt:t.value===-1&&(t=yield this.readMetadataLength()).done?dt:(t=yield this.readMetadata(t.value)).done?dt:t})}throw(t){return A(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return A(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return A(this,void 0,void 0,function*(){let e;if((e=yield this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(ec(t));return e.value})}readMessageBody(t){return A(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let e=M(yield this.source.read(t));if(e.byteLength<t)throw new Error(ef(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()})}readSchema(t=!1){return A(this,void 0,void 0,function*(){let e=et.Schema,n=yield this.readMessage(e),i=n==null?void 0:n.header();if(t&&!i)throw new Error(rc(e));return i})}readMetadataLength(){return A(this,void 0,void 0,function*(){let t=yield this.source.read(go),e=t&&new ue(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}})}readMetadata(t){return A(this,void 0,void 0,function*(){let e=yield this.source.read(t);if(!e)return dt;if(e.byteLength<t)throw new Error(tf(t,e.byteLength));return{done:!1,value:Vt.decode(e)}})}},bo=class extends zi{constructor(t){super(new Uint8Array(0));this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Gs?t:new Gs(t)}next(){let{_json:t}=this;if(!this._schema){this._schema=!0;let e=Vt.fromJSON(t.schema,et.Schema);return{done:!1,value:e}}if(this._dictionaryIndex<t.dictionaries.length){let e=t.dictionaries[this._dictionaryIndex++];this._body=e.data.columns;let n=Vt.fromJSON(e,et.DictionaryBatch);return{done:!1,value:n}}if(this._batchIndex<t.batches.length){let e=t.batches[this._batchIndex++];this._body=e.columns;let n=Vt.fromJSON(e,et.RecordBatch);return{done:!1,value:n}}return this._body=[],dt}readMessageBody(t){return e(this._body);function e(n){return(n||[]).reduce((i,s)=>[...i,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE&&[s.TYPE]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...e(s.children)],[])}}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(ec(t));return e.value}readSchema(){let t=et.Schema,e=this.readMessage(t),n=e==null?void 0:e.header();if(!e||!n)throw new Error(rc(t));return n}},go=4,tc="ARROW1",Jn=new Uint8Array(tc.length);for(let r=0;r<tc.length;r+=1)Jn[r]=tc.codePointAt(r);function wo(r,t=0){for(let e=-1,n=Jn.length;++e<n;)if(Jn[e]!==r[t+e])return!1;return!0}var qn=Jn.length,nc=qn+go,rf=qn*2+go;var kt=class extends zn{constructor(t){super();this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let e=this._impl.open(t);return ze(e)?e.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Yt.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Yt.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof kt?t:fs(t)?Uy(t):ps(t)?Cy(t):ze(t)?(()=>A(this,void 0,void 0,function*(){return yield kt.from(yield t)}))():ms(t)||yi(t)||ys(t)||Me(t)?Ny(new ve(t)):Ly(new xr(t))}static readAll(t){return t instanceof kt?t.isSync()?nf(t):sf(t):fs(t)||ArrayBuffer.isView(t)||We(t)||hs(t)?nf(t):sf(t)}},Fr=class extends kt{constructor(t){super(t);this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return ae(this,arguments,function*(){yield j(yield*Fn(Oe(this[Symbol.iterator]())))})}},wn=class extends kt{constructor(t){super(t);this._impl=t}readAll(){var t,e;return A(this,void 0,void 0,function*(){let n=new Array;try{for(var i=Oe(this),s;s=yield i.next(),!s.done;){let o=s.value;n.push(o)}}catch(o){t={error:o}}finally{try{s&&!s.done&&(e=i.return)&&(yield e.call(i))}finally{if(t)throw t.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},vn=class extends Fr{constructor(t){super(t);this._impl=t}},vo=class extends wn{constructor(t){super(t);this._impl=t}},ic=class{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){let n=this._loadVectors(t,e,this.schema.fields),i=P({type:new _t(this.schema.fields),length:t.length,children:n});return new ft(this.schema,i)}_loadDictionaryBatch(t,e){let{id:n,isDelta:i}=t,{dictionaries:s,schema:o}=this,u=s.get(n);if(i||!u){let a=o.dictionaries.get(n),h=this._loadVectors(t.data,e,[a]);return(u&&i?u.concat(new C(h)):new C(h)).memoize()}return u.memoize()}_loadVectors(t,e,n){return new Ks(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}},Wi=class extends ic{constructor(t,e){super(e);this._reader=fs(t)?new bo(this._handle=t):new zi(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=cf(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):dt}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):dt}next(){if(this.closed)return dt;let t,{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=e.readMessageBody(t.bodyLength),s=this._loadRecordBatch(n,i);return{done:!1,value:s}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Xn(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},ji=class extends ic{constructor(t,e){super(e);this._reader=new yo(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return A(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return A(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=cf(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return A(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):dt})}return(t){return A(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):dt})}next(){return A(this,void 0,void 0,function*(){if(this.closed)return dt;let t,{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=yield e.readMessageBody(t.bodyLength),s=this._loadRecordBatch(n,i);return{done:!1,value:s}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=yield e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Xn(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return A(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},sc=class extends Wi{constructor(t,e){super(t instanceof $s?t:new $s(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();let n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(et.RecordBatch);if(i!=null&&i.isRecordBatch()){let s=i.header(),o=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,o)}}return null}_readDictionaryBatch(t){var e;let n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(et.DictionaryBatch);if(i!=null&&i.isDictionaryBatch()){let s=i.header(),o=this._reader.readMessageBody(i.bodyLength),u=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,u)}}}_readFooter(){let{_handle:t}=this,e=t.size-nc,n=t.readInt32(e),i=t.readAt(e-n,n);return Zr.decode(i)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}},of=class extends ji{constructor(t,...e){let n=typeof e[0]!="number"?e.shift():void 0,i=e[0]instanceof Map?e.shift():void 0;super(t instanceof _n?t:new _n(t,n),i)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){let e=Object.create(null,{open:{get:()=>super.open}});return A(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let n of this._footer.dictionaryBatches())n&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)})}readRecordBatch(t){var e;return A(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(et.RecordBatch);if(i!=null&&i.isRecordBatch()){let s=i.header(),o=yield this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,o)}}return null})}_readDictionaryBatch(t){var e;return A(this,void 0,void 0,function*(){let n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(et.DictionaryBatch);if(i!=null&&i.isDictionaryBatch()){let s=i.header(),o=yield this._reader.readMessageBody(i.bodyLength),u=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,u)}}})}_readFooter(){return A(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let e=t.size-nc,n=yield t.readInt32(e),i=yield t.readAt(e-n,n);return Zr.decode(i)})}_readNextMessageAndValidate(t){return A(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null})}},af=class extends Wi{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new Da(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}};function cf(r,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:r.autoDestroy}function*nf(r){let t=kt.from(r);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function sf(r){return ae(this,arguments,function*(){let e=yield j(kt.from(r));try{if(!(yield j(e.open({autoDestroy:!1}))).closed)do yield yield j(e);while(!(yield j(e.reset().open())).closed)}finally{yield j(e.cancel())}})}function Uy(r){return new Fr(new af(r))}function Ly(r){let t=r.peek(qn+7&-8);return t&&t.byteLength>=4?wo(t)?new vn(new sc(r.read())):new Fr(new Wi(r)):new Fr(new Wi(function*(){}()))}function Ny(r){return A(this,void 0,void 0,function*(){let t=yield r.peek(qn+7&-8);return t&&t.byteLength>=4?wo(t)?new vn(new sc(yield r.read())):new wn(new ji(r)):new wn(new ji(function(){return ae(this,arguments,function*(){})}()))})}function Cy(r){return A(this,void 0,void 0,function*(){let{size:t}=yield r.stat(),e=new _n(r,t);return t>=rf&&wo(yield e.readAt(0,qn+7&-8))?new vo(new of(e)):new wn(new ji(e))})}var Bt=class extends O{constructor(){super();this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){let e=i=>i.flatMap(s=>Array.isArray(s)?e(s):s instanceof ft?s.data.children:s.data),n=new Bt;return n.visitMany(e(t)),n}visit(t){if(t instanceof C)return this.visitMany(t.data),this;let{type:e}=t;if(!F.isDictionary(e)){let{length:n,nullCount:i}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");F.isNull(e)||Ze.call(this,i<=0?new Uint8Array(0):Ln(t.offset,n,t.nullBitmap)),this.nodes.push(new dr(n,i))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function Ze(r){let t=r.byteLength+7&-8;return this.buffers.push(r),this.bufferRegions.push(new Ie(this._byteLength,t)),this._byteLength+=t,this}function Py(r){let{type:t,length:e,typeIds:n,valueOffsets:i}=r;if(Ze.call(this,n),t.mode===It.Sparse)return oc.call(this,r);if(t.mode===It.Dense){if(r.offset<=0)return Ze.call(this,i),oc.call(this,r);{let s=n.reduce((m,g)=>Math.max(m,g),n[0]),o=new Int32Array(s+1),u=new Int32Array(s+1).fill(-1),a=new Int32Array(e),h=bi(-i[0],e,i);for(let m,g,S=-1;++S<e;)(g=u[m=n[S]])===-1&&(g=u[m]=h[m]),a[S]=h[S]-g,++o[m];Ze.call(this,a);for(let m,g=-1,S=t.children.length;++g<S;)if(m=r.children[g]){let I=t.typeIds[g],Z=Math.min(e,o[I]);this.visit(m.slice(u[I],Z))}}}return this}function Vy(r){let t;return r.nullCount>=r.length?Ze.call(this,new Uint8Array(0)):(t=r.values)instanceof Uint8Array?Ze.call(this,Ln(r.offset,r.length,t)):Ze.call(this,hn(r.values))}function rn(r){return Ze.call(this,r.values.subarray(0,r.length*r.stride))}function uf(r){let{length:t,values:e,valueOffsets:n}=r,i=n[0],s=n[t],o=Math.min(s-i,e.byteLength-i);return Ze.call(this,bi(-n[0],t,n)),Ze.call(this,e.subarray(i,i+o)),this}function ac(r){let{length:t,valueOffsets:e}=r;return e&&Ze.call(this,bi(e[0],t,e)),this.visit(r.children[0])}function oc(r){return this.visitMany(r.type.children.map((t,e)=>r.children[e]).filter(Boolean))[0]}Bt.prototype.visitBool=Vy;Bt.prototype.visitInt=rn;Bt.prototype.visitFloat=rn;Bt.prototype.visitUtf8=uf;Bt.prototype.visitBinary=uf;Bt.prototype.visitFixedSizeBinary=rn;Bt.prototype.visitDate=rn;Bt.prototype.visitTimestamp=rn;Bt.prototype.visitTime=rn;Bt.prototype.visitDecimal=rn;Bt.prototype.visitList=ac;Bt.prototype.visitStruct=oc;Bt.prototype.visitUnion=Py;Bt.prototype.visitInterval=rn;Bt.prototype.visitFixedSizeList=ac;Bt.prototype.visitMap=ac;var Sn=class extends zn{constructor(t){super();this._position=0,this._started=!1,this._sink=new Ar,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,te(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return ze(t)?t.then(e=>this.writeAll(e)):Me(t)?uc(this,t):cc(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){return t===this._sink||t instanceof Ar?this._sink=t:(this._sink=new Ar,t&&wl(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&vl(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!e||!bn(e,this._schema))&&(e==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof Dt&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof ft&&!(e=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(e&&!bn(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof ft?t instanceof Xn||this._writeRecordBatch(t):t instanceof Dt?this.writeAll(t.batches):We(t)&&this.writeAll(t)}_writeMessage(t,e=8){let n=e-1,i=Vt.encode(t),s=i.byteLength,o=this._writeLegacyIpcFormat?4:8,u=s+o+n&~n,a=u-s-o;return t.headerType===et.RecordBatch?this._recordBatchBlocks.push(new cr(u,t.bodyLength,this._position)):t.headerType===et.DictionaryBatch&&this._dictionaryBlocks.push(new cr(u,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(u-o)),s>0&&this._write(i),this._writePadding(a)}_write(t){if(this._started){let e=M(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(Vt.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Jn)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:e,nodes:n,bufferRegions:i,buffers:s}=Bt.assemble(t),o=new Qt(t.numRows,n,i),u=Vt.from(o,e);return this._writeDictionaries(t)._writeMessage(u)._writeBodyBuffers(s)}_writeDictionaryBatch(t,e,n=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));let{byteLength:i,nodes:s,bufferRegions:o,buffers:u}=Bt.assemble(new C([t])),a=new Qt(t.length,s,o),h=new Ae(a,e,n),m=Vt.from(h,i);return this._writeMessage(m)._writeBodyBuffers(u)}_writeBodyBuffers(t){let e,n,i;for(let s=-1,o=t.length;++s<o;)(e=t[s])&&(n=e.byteLength)>0&&(this._write(e),(i=(n+7&-8)-n)>0&&this._writePadding(i));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let i=this._dictionaryDeltaOffsets.get(e)||0;if(i===0||(n=n==null?void 0:n.slice(i)).length>0)for(let s of n.data)this._writeDictionaryBatch(s,e,i>0),i+=s.length}return this}},Tr=class extends Sn{static writeAll(t,e){let n=new Tr(e);return ze(t)?t.then(i=>n.writeAll(i)):Me(t)?uc(n,t):cc(n,t)}},In=class extends Sn{static writeAll(t){let e=new In;return ze(t)?t.then(n=>e.writeAll(n)):Me(t)?uc(e,t):cc(e,t)}constructor(){super();this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let e=Zr.encode(new Zr(t,Wt.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}};function cc(r,t){let e=t;t instanceof Dt&&(e=t.batches,r.reset(void 0,t.schema));for(let n of e)r.write(n);return r.finish()}function uc(r,t){var e,n,i,s;return A(this,void 0,void 0,function*(){try{for(e=Oe(t);n=yield e.next(),!n.done;){let o=n.value;r.write(o)}}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=e.return)&&(yield s.call(e))}finally{if(i)throw i.error}}return r.finish()})}function lf(r,t){if(Me(r))return zy(r,t);if(We(r))return Hy(r,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function Hy(r,t){let e=null,n=(t==null?void 0:t.type)==="bytes"||!1,i=(t==null?void 0:t.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){s(o,e||(e=r[Symbol.iterator]()))},pull(o){e?s(o,e):o.close()},cancel(){((e==null?void 0:e.return)&&e.return()||!0)&&(e=null)}}),Object.assign({highWaterMark:n?i:void 0},t));function s(o,u){let a,h=null,m=o.desiredSize||null;for(;!(h=u.next(n?m:null)).done;)if(ArrayBuffer.isView(h.value)&&(a=M(h.value))&&(m!=null&&n&&(m=m-a.byteLength+1),h.value=a),o.enqueue(h.value),m!=null&&--m<=0)return;o.close()}}function zy(r,t){let e=null,n=(t==null?void 0:t.type)==="bytes"||!1,i=(t==null?void 0:t.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){return A(this,void 0,void 0,function*(){yield s(o,e||(e=r[Symbol.asyncIterator]()))})},pull(o){return A(this,void 0,void 0,function*(){e?yield s(o,e):o.close()})},cancel(){return A(this,void 0,void 0,function*(){((e==null?void 0:e.return)&&(yield e.return())||!0)&&(e=null)})}}),Object.assign({highWaterMark:n?i:void 0},t));function s(o,u){return A(this,void 0,void 0,function*(){let a,h=null,m=o.desiredSize||null;for(;!(h=yield u.next(n?m:null)).done;)if(ArrayBuffer.isView(h.value)&&(a=M(h.value))&&(m!=null&&n&&(m=m-a.byteLength+1),h.value=a),o.enqueue(h.value),m!=null&&--m<=0)return;o.close()})}}function hf(r){return new pf(r)}var pf=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:e,["writableStrategy"]:n,["queueingStrategy"]:i="count"}=t,s=bl(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=yn(s),this._getSize=i!=="bytes"?df:ff;let{["highWaterMark"]:o=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},e),{["highWaterMark"]:u=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},n);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:a=>{this._maybeFlush(this._builder,this._controller=a)},start:a=>{this._maybeFlush(this._builder,this._controller=a)}},{highWaterMark:o,size:i!=="bytes"?df:ff}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:u,size:a=>this._writeValueAndReturnChunkSize(a)})}_writeValueAndReturnChunkSize(t){let e=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-e}_maybeFlush(t,e){e!=null&&(this._bufferedSize>=e.desiredSize&&++this._numChunks&&this._enqueue(e,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(e,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(e,null)))}_enqueue(t,e){this._bufferedSize=0,this._controller=null,e==null?t.close():t.enqueue(e)}},df=r=>{var t;return(t=r==null?void 0:r.length)!==null&&t!==void 0?t:0},ff=r=>{var t;return(t=r==null?void 0:r.byteLength)!==null&&t!==void 0?t:0};function So(r,t){let e=new Ar,n=null,i=new ReadableStream({cancel(){return A(this,void 0,void 0,function*(){yield e.close()})},start(u){return A(this,void 0,void 0,function*(){yield o(u,n||(n=yield s()))})},pull(u){return A(this,void 0,void 0,function*(){n?yield o(u,n):u.close()})}});return{writable:new WritableStream(e,Object.assign({highWaterMark:Math.pow(2,14)},r)),readable:i};function s(){return A(this,void 0,void 0,function*(){return yield(yield kt.from(e)).open(t)})}function o(u,a){return A(this,void 0,void 0,function*(){let h=u.desiredSize,m=null;for(;!(m=yield a.next()).done;)if(u.enqueue(m.value),h!=null&&--h<=0)return;u.close()})}}function Io(r,t){let e=new this(r),n=new ve(e),i=new ReadableStream({cancel(){return A(this,void 0,void 0,function*(){yield n.cancel()})},pull(o){return A(this,void 0,void 0,function*(){yield s(o)})},start(o){return A(this,void 0,void 0,function*(){yield s(o)})}},Object.assign({highWaterMark:Math.pow(2,14)},t));return{writable:new WritableStream(e,r),readable:i};function s(o){return A(this,void 0,void 0,function*(){let u=null,a=o.desiredSize;for(;u=yield n.read(a||null);)if(o.enqueue(u),a!=null&&(a-=u.byteLength)<=0)return;o.close()})}}var Gy=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo),Ta),va),la),Jo),wa),{compareSchemas:bn,compareFields:Ld,compareTypes:Nd});Yt.toDOMStream=lf;wt.throughDOM=hf;kt.throughDOM=So;vn.throughDOM=So;Fr.throughDOM=So;Sn.throughDOM=Io;In.throughDOM=Io;Tr.throughDOM=Io;function Zn(r){switch(r.typeId){case p.Binary:return{sqlType:"binary"};case p.Bool:return{sqlType:"bool"};case p.Date:return{sqlType:"date"};case p.DateDay:return{sqlType:"date32[d]"};case p.DateMillisecond:return{sqlType:"date64[ms]"};case p.Decimal:{let t=r;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case p.Float:return{sqlType:"float"};case p.Float16:return{sqlType:"float16"};case p.Float32:return{sqlType:"float32"};case p.Float64:return{sqlType:"float64"};case p.Int:return{sqlType:"int32"};case p.Int16:return{sqlType:"int16"};case p.Int32:return{sqlType:"int32"};case p.Int64:return{sqlType:"int64"};case p.Uint16:return{sqlType:"uint16"};case p.Uint32:return{sqlType:"uint32"};case p.Uint64:return{sqlType:"uint64"};case p.Uint8:return{sqlType:"uint8"};case p.IntervalDayTime:return{sqlType:"interval[dt]"};case p.IntervalYearMonth:return{sqlType:"interval[m]"};case p.List:return{sqlType:"list",valueType:Zn(r.valueType)};case p.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:r.byteWidth};case p.Null:return{sqlType:"null"};case p.Utf8:return{sqlType:"utf8"};case p.Struct:return{sqlType:"struct",fields:r.children.map(e=>Ao(e.name,e.type))};case p.Map:{let t=r;return{sqlType:"map",keyType:Zn(t.keyType),valueType:Zn(t.valueType)}}case p.Time:return{sqlType:"time[s]"};case p.TimeMicrosecond:return{sqlType:"time[us]"};case p.TimeMillisecond:return{sqlType:"time[ms]"};case p.TimeNanosecond:return{sqlType:"time[ns]"};case p.TimeSecond:return{sqlType:"time[s]"};case p.Timestamp:return{sqlType:"timestamp",timezone:r.timezone||void 0};case p.TimestampSecond:return{sqlType:"timestamp[s]",timezone:r.timezone||void 0};case p.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:r.timezone||void 0};case p.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:r.timezone||void 0};case p.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:r.timezone||void 0}}throw new Error(`unsupported arrow type: ${r.toString()}`)}function Ao(r,t){let e=Zn(t);return e.name=r,e}var lc=class{constructor(){this._bindings=null;this._nextMessageId=0}log(t){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:"LOG",data:t},[])}sendOK(t){this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"OK",data:null},[])}failWith(t,e){let n={name:e.name,message:e.message,stack:e.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"ERROR",data:n},[])}async onMessage(t){switch(t.type){case"PING":this.sendOK(t);return;case"INSTANTIATE":this._bindings!=null&&this.failWith(t,new Error("duckdb already initialized"));try{this._bindings=await this.instantiate(t.data[0],t.data[1],e=>{this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"INSTANTIATE_PROGRESS",data:e},[])}),this.sendOK(t)}catch(e){this._bindings=null,this.failWith(t,e)}return;default:break}if(!this._bindings)return this.failWith(t,new Error("duckdb is not initialized"));try{switch(t.type){case"GET_VERSION":this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"VERSION_STRING",data:this._bindings.getVersion()},[]);break;case"GET_FEATURE_FLAGS":this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FEATURE_FLAGS",data:this._bindings.getFeatureFlags()},[]);break;case"RESET":this._bindings.reset(),this.sendOK(t);break;case"OPEN":this._bindings.open(t.data),this.sendOK(t);break;case"DROP_FILE":this._bindings.dropFile(t.data),this.sendOK(t);break;case"DROP_FILES":this._bindings.dropFiles(),this.sendOK(t);break;case"FLUSH_FILES":this._bindings.flushFiles(),this.sendOK(t);break;case"CONNECT":{let e=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"CONNECTION_INFO",data:e.useUnsafe((n,i)=>i)},[]);break}case"DISCONNECT":this._bindings.disconnect(t.data),this.sendOK(t);break;case"CREATE_PREPARED":{let e=this._bindings.createPrepared(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"PREPARED_STATEMENT_ID",data:e},[]);break}case"CLOSE_PREPARED":{this._bindings.closePrepared(t.data[0],t.data[1]),this.sendOK(t);break}case"RUN_PREPARED":{let e=this._bindings.runPrepared(t.data[0],t.data[1],t.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT",data:e},[e.buffer]);break}case"RUN_QUERY":{let e=this._bindings.runQuery(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT",data:e},[e.buffer]);break}case"SEND_PREPARED":{let e=this._bindings.sendPrepared(t.data[0],t.data[1],t.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_START",data:e},[e.buffer]);break}case"SEND_QUERY":{let e=this._bindings.sendQuery(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_START",data:e},[e.buffer]);break}case"FETCH_QUERY_RESULTS":{let e=this._bindings.fetchQueryResults(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT_CHUNK",data:e},[e.buffer]);break}case"GET_TABLE_NAMES":{let e=this._bindings.getTableNames(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"TABLE_NAMES",data:e},[]);break}case"GLOB_FILE_INFOS":{let e=this._bindings.globFiles(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_INFOS",data:e},[]);break}case"REGISTER_FILE_URL":this._bindings.registerFileURL(t.data[0],t.data[1]),this.sendOK(t);break;case"REGISTER_FILE_BUFFER":this._bindings.registerFileBuffer(t.data[0],t.data[1]),this.sendOK(t);break;case"REGISTER_FILE_HANDLE":this._bindings.registerFileHandle(t.data[0],t.data[1]),this.sendOK(t);break;case"COPY_FILE_TO_PATH":this._bindings.copyFileToPath(t.data[0],t.data[1]),this.sendOK(t);break;case"COPY_FILE_TO_BUFFER":{let e=this._bindings.copyFileToBuffer(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_BUFFER",data:e},[]);break}case"COLLECT_FILE_STATISTICS":this._bindings.collectFileStatistics(t.data[0],t.data[1]),this.sendOK(t);break;case"EXPORT_FILE_STATISTICS":{this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_STATISTICS",data:this._bindings.exportFileStatistics(t.data)},[]);break}case"INSERT_ARROW_FROM_IPC_STREAM":{this._bindings.insertArrowFromIPCStream(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"IMPORT_CSV_FROM_PATH":{this._bindings.insertCSVFromPath(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"IMPORT_JSON_FROM_PATH":{this._bindings.insertJSONFromPath(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"TOKENIZE":{let e=this._bindings.tokenize(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"SCRIPT_TOKENS",data:e},[]);break}}}catch(e){return this.failWith(t,e)}}};var fc={},$y=(()=>{var r=fc.url;return function(t){t=t||{};function e(){return St.buffer!=de&&Or(St.buffer),Dc}function n(){return St.buffer!=de&&Or(St.buffer),Ec}function i(){return St.buffer!=de&&Or(St.buffer),Oc}function s(){return St.buffer!=de&&Or(St.buffer),Mc}function o(){return St.buffer!=de&&Or(St.buffer),Rc}function u(){return St.buffer!=de&&Or(St.buffer),kc}var a=typeof t<"u"?t:{},h=Object.assign,m,g;a.ready=new Promise(function(c,l){m=c,g=l});var S=h({},a),I=[],Z="./this.program",X=(c,l)=>{throw l},ht=typeof window=="object",lt=typeof importScripts=="function",vt=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",x=a.ENVIRONMENT_IS_PTHREAD||!1,jt="";function An(c){return a.locateFile?a.locateFile(c,jt):jt+c}var ti,ei,Dr,Ht;function oe(c){if(c instanceof li)return;Lt("exiting due to exception: "+c)}var Et,Ce,Er;if(vt){lt?jt=dc().dirname(jt)+"/":jt=__dirname+"/",Er=function(){Ce||(Et=_f(),Ce=dc())},ti=function(d,f){return Er(),d=Ce.normalize(d),Et.readFileSync(d,f?null:"utf8")},Dr=function(d){var f=ti(d,!0);return f.buffer||(f=new Uint8Array(f)),f},ei=function(d,f,_){Er(),d=Ce.normalize(d),Et.readFile(d,function(y,b){y?_(y):f(b.buffer)})},process.argv.length>1&&(Z=process.argv[1].replace(/\\/g,"/")),I=process.argv.slice(2),process.on("uncaughtException",function(l){if(!(l instanceof li))throw l}),process.on("unhandledRejection",function(l){throw l}),X=(l,d)=>{if(Gi())throw process.exitCode=l,d;oe(d),process.exit(l)},a.inspect=function(){return"[Emscripten Module object]"};let c;try{c=yf()}catch(l){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),l}global.Worker=c.Worker}else(ht||lt)&&(lt?jt=self.location.href:typeof document<"u"&&document.currentScript&&(jt=document.currentScript.src),r&&(jt=r),jt.indexOf("blob:")!==0?jt=jt.substr(0,jt.replace(/[?#].*/,"").lastIndexOf("/")+1):jt="",vt||(ti=function(c){var l=new XMLHttpRequest;return l.open("GET",c,!1),l.send(null),l.responseText},lt&&(Dr=function(c){var l=new XMLHttpRequest;return l.open("GET",c,!1),l.responseType="arraybuffer",l.send(null),new Uint8Array(l.response)}),ei=function(c,l,d){var f=new XMLHttpRequest;f.open("GET",c,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){l(f.response);return}d()},f.onerror=d,f.send(null)}),Ht=c=>document.title=c);vt&&typeof performance>"u"&&(global.performance=bf().performance);var Pe=console.log.bind(console),Ut=console.warn.bind(console);vt&&(Er(),Pe=c=>Et.writeSync(1,c+`
`),Ut=c=>Et.writeSync(2,c+`
`));var xe=a.print||Pe,Lt=a.printErr||Ut;h(a,S),S=null,a.arguments&&(I=a.arguments),a.thisProgram&&(Z=a.thisProgram),a.quit&&(X=a.quit);function ri(c){ri.shown||(ri.shown={}),ri.shown[c]||(ri.shown[c]=1,Lt(c))}var nb=Atomics.load,ib=Atomics.store,sb=Atomics.compareExchange,ni;a.wasmBinary&&(ni=a.wasmBinary);var wc=a.noExitRuntime||!0;typeof WebAssembly!="object"&&Ve("no native wasm support detected");var St,vc,Fo=!1,ii;function Sc(c,l){c||Ve(l)}function Mf(c){var l=a["_"+c];return l}function Rf(c,l,d,f,_){var y={string:function(Tt){var He=0;if(Tt!=null&&Tt!==0){var Qe=(Tt.length<<2)+1;He=xn(Qe),Yi(Tt,He,Qe)}return He},array:function(Tt){var He=xn(Tt.length);return Tc(Tt,He),He}};function b(Tt){return l==="string"?Be(Tt):l==="boolean"?Boolean(Tt):Tt}var w=Mf(c),B=[],st=0;if(f)for(var rt=0;rt<f.length;rt++){var De=y[d[rt]];De?(st===0&&(st=zo()),B[rt]=De(f[rt])):B[rt]=f[rt]}var pt=w.apply(null,B);function Ee(Tt){return st!==0&&ss(st),b(Tt)}return pt=Ee(pt),pt}function Ic(c){var l=new TextDecoder(c);this.decode=d=>(d.buffer instanceof SharedArrayBuffer&&(d=new Uint8Array(d)),l.decode.call(l,d))}var Ac=typeof TextDecoder<"u"?new Ic("utf8"):void 0;function xc(c,l,d){for(var f=l+d,_=l;c[_]&&!(_>=f);)++_;if(_-l>16&&c.subarray&&Ac)return Ac.decode(c.subarray(l,_));for(var y="";l<_;){var b=c[l++];if(!(b&128)){y+=String.fromCharCode(b);continue}var w=c[l++]&63;if((b&224)==192){y+=String.fromCharCode((b&31)<<6|w);continue}var B=c[l++]&63;if((b&240)==224?b=(b&15)<<12|w<<6|B:b=(b&7)<<18|w<<12|B<<6|c[l++]&63,b<65536)y+=String.fromCharCode(b);else{var st=b-65536;y+=String.fromCharCode(55296|st>>10,56320|st&1023)}}return y}function Be(c,l){return c?xc(n(),c,l):""}function Bc(c,l,d,f){if(!(f>0))return 0;for(var _=d,y=d+f-1,b=0;b<c.length;++b){var w=c.charCodeAt(b);if(w>=55296&&w<=57343){var B=c.charCodeAt(++b);w=65536+((w&1023)<<10)|B&1023}if(w<=127){if(d>=y)break;l[d++]=w}else if(w<=2047){if(d+1>=y)break;l[d++]=192|w>>6,l[d++]=128|w&63}else if(w<=65535){if(d+2>=y)break;l[d++]=224|w>>12,l[d++]=128|w>>6&63,l[d++]=128|w&63}else{if(d+3>=y)break;l[d++]=240|w>>18,l[d++]=128|w>>12&63,l[d++]=128|w>>6&63,l[d++]=128|w&63}}return l[d]=0,d-_}function Yi(c,l,d){return Bc(c,n(),l,d)}function Fc(c){for(var l=0,d=0;d<c.length;++d){var f=c.charCodeAt(d);f>=55296&&f<=57343&&(f=65536+((f&1023)<<10)|c.charCodeAt(++d)&1023),f<=127?++l:f<=2047?l+=2:f<=65535?l+=3:l+=4}return l}var ob=typeof TextDecoder<"u"?new Ic("utf-16le"):void 0;function Tc(c,l){e().set(c,l)}function kf(c,l,d){for(var f=0;f<c.length;++f)e()[l++>>0]=c.charCodeAt(f);d||(e()[l>>0]=0)}function Uf(c,l){return c%l>0&&(c+=l-c%l),c}var de,Dc,Ec,Oc,Mc,Rc,Lf,Nf,kc;x&&(de=a.buffer);function Or(c){de=c,a.HEAP8=Dc=new Int8Array(c),a.HEAP16=Oc=new Int16Array(c),a.HEAP32=Rc=new Int32Array(c),a.HEAPU8=Ec=new Uint8Array(c),a.HEAPU16=Mc=new Uint16Array(c),a.HEAPU32=Lf=new Uint32Array(c),a.HEAPF32=Nf=new Float32Array(c),a.HEAPF64=kc=new Float64Array(c)}var Uc=a.INITIAL_MEMORY||16777216;if(x)St=a.wasmMemory,de=a.buffer;else if(a.wasmMemory)St=a.wasmMemory;else if(St=new WebAssembly.Memory({initial:Uc/65536,maximum:32768,shared:!0}),!(St.buffer instanceof SharedArrayBuffer))throw Lt("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),vt&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");St&&(de=St.buffer),Uc=de.byteLength,Or(de);var Lc,Nc=[],Cc=[],Cf=[],Pf=[],Pc=[],Vf=!1,Hf=!1,zf=0;function Gi(){return wc||zf>0}function Wf(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)$f(a.preRun.shift());$i(Nc)}function Vc(){Vf=!0,!x&&$i(Cc)}function jf(){x||$i(Cf)}function Yf(){x||(D.terminateAllThreads(),Hf=!0)}function Gf(){if(!x){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)Kf(a.postRun.shift());$i(Pc)}}function $f(c){Nc.unshift(c)}function Xf(c){Cc.unshift(c)}function Kf(c){Pc.unshift(c)}var an=0,To=null,si=null;function Jf(c){an++,a.monitorRunDependencies&&a.monitorRunDependencies(an)}function qf(c){if(an--,a.monitorRunDependencies&&a.monitorRunDependencies(an),an==0&&(To!==null&&(clearInterval(To),To=null),si)){var l=si;si=null,l()}}a.preloadedImages={},a.preloadedAudios={};function Ve(c){x?postMessage({cmd:"onAbort",arg:c}):a.onAbort&&a.onAbort(c),c="Aborted("+c+")",Lt(c),Fo=!0,ii=1,c+=". Build with -s ASSERTIONS=1 for more info.";var l=new WebAssembly.RuntimeError(c);throw g(l),l}var Zf="data:application/octet-stream;base64,";function Hc(c){return c.startsWith(Zf)}var Fe;a.locateFile?(Fe="./duckdb-coi.wasm",Hc(Fe)||(Fe=An(Fe))):Fe=new URL("./duckdb-coi.wasm",fc.url).toString();function zc(c){try{if(c==Fe&&ni)return new Uint8Array(ni);if(Dr)return Dr(c);throw"both async and sync fetching of the wasm failed"}catch(l){Ve(l)}}function Qf(){return!ni&&(ht||lt)&&typeof fetch=="function"?fetch(Fe,{credentials:"same-origin"}).then(function(c){if(!c.ok)throw"failed to load wasm binary file at '"+Fe+"'";return c.arrayBuffer()}).catch(function(){return zc(Fe)}):Promise.resolve().then(function(){return zc(Fe)})}function th(){var c={a:fp};function l(b,w){var B=b.exports;if(a.asm=B,oh(a.asm.hb),Lc=a.asm.xa,Xf(a.asm.va),vc=w,!x){var st=D.unusedWorkers.length;D.unusedWorkers.forEach(function(rt){D.loadWasmModuleToWorker(rt,function(){--st||qf("wasm-instantiate")})})}}x||Jf("wasm-instantiate");function d(b){l(b.instance,b.module)}function f(b){return Qf().then(function(w){return WebAssembly.instantiate(w,c)}).then(function(w){return w}).then(b,function(w){Lt("failed to asynchronously prepare wasm: "+w),Ve(w)})}function _(){return!ni&&typeof WebAssembly.instantiateStreaming=="function"&&!Hc(Fe)&&typeof fetch=="function"?fetch(Fe,{credentials:"same-origin"}).then(function(b){var w=WebAssembly.instantiateStreaming(b,c);return w.then(d,function(B){return Lt("wasm streaming compile failed: "+B),Lt("falling back to ArrayBuffer instantiation"),f(d)})}):f(d)}if(a.instantiateWasm)try{var y=a.instantiateWasm(c,l);return y}catch(b){return Lt("Module.instantiateWasm callback failed with error: "+b),!1}return _().catch(g),{}}var eh={};function $i(c){for(;c.length>0;){var l=c.shift();if(typeof l=="function"){l(a);continue}var d=l.func;typeof d=="number"?l.arg===void 0?Eo(d)():Eo(d)(l.arg):d(l.arg===void 0?null:l.arg)}}function Do(c){var l=zo(),d=c();return ss(l),d}function rh(c){o()[c>>2]=0;var l=D.pthreads[c];delete D.pthreads[c],l.worker.terminate(),Ho(c),D.runningWorkers.splice(D.runningWorkers.indexOf(l.worker),1),l.worker.pthread=void 0}function nh(c){var l=D.pthreads[c];l.worker.postMessage({cmd:"cancel"})}function Wc(c){var l=D.pthreads[c];if(l){o()[c>>2]=0;var d=l.worker;D.returnWorkerToPool(d)}}function jc(c,l){n().fill(0,c,c+l)}function Yc(c){zu(c)}function Gc(c){if(c instanceof li||c=="unwind")return ii;X(1,c)}var D={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],initMainThread:function(){for(var c=4,l=0;l<c;++l)D.allocateUnusedWorker()},initWorker:function(){},pthreads:{},setExitStatus:function(c){ii=c},terminateAllThreads:function(){for(var c in D.pthreads){var l=D.pthreads[c];l&&l.worker&&D.returnWorkerToPool(l.worker)}for(var d=0;d<D.unusedWorkers.length;++d){var f=D.unusedWorkers[d];f.terminate()}D.unusedWorkers=[]},returnWorkerToPool:function(c){D.runWithoutMainThreadQueuedCalls(function(){delete D.pthreads[c.pthread.threadInfoStruct],D.unusedWorkers.push(c),D.runningWorkers.splice(D.runningWorkers.indexOf(c),1),Ho(c.pthread.threadInfoStruct),c.pthread=void 0})},runWithoutMainThreadQueuedCalls:function(c){o()[Hu>>2]=0;try{c()}finally{o()[Hu>>2]=1}},receiveObjectTransfer:function(c){},threadInit:function(){for(var c in D.tlsInitFunctions)D.tlsInitFunctions[c]()},loadWasmModuleToWorker:function(c,l){c.onmessage=function(d){var f=d.data,_=f.cmd;if(c.pthread&&(D.currentProxiedOperationCallerThread=c.pthread.threadInfoStruct),f.targetThread&&f.targetThread!=is()){var y=D.pthreads[f.targetThread];y?y.worker.postMessage(f,f.transferList):Lt('Internal error! Worker sent a message "'+_+'" to target pthread '+f.targetThread+", but that thread no longer exists!"),D.currentProxiedOperationCallerThread=void 0;return}_==="processQueuedMainThreadWork"?Co():_==="spawnThread"?Kc(f):_==="cleanupThread"?Wc(f.thread):_==="killThread"?rh(f.thread):_==="cancelThread"?nh(f.thread):_==="loaded"?(c.loaded=!0,l&&l(c),c.runPthread&&(c.runPthread(),delete c.runPthread)):_==="print"?xe("Thread "+f.threadId+": "+f.text):_==="printErr"?Lt("Thread "+f.threadId+": "+f.text):_==="alert"?alert("Thread "+f.threadId+": "+f.text):_==="detachedExit"?D.returnWorkerToPool(c):f.target==="setimmediate"?c.postMessage(f):_==="onAbort"?a.onAbort&&a.onAbort(f.arg):Lt("worker sent an unknown command "+_),D.currentProxiedOperationCallerThread=void 0},c.onerror=function(d){var f="worker sent an error!";throw Lt(f+" "+d.filename+":"+d.lineno+": "+d.message),d},vt&&(c.on("message",function(d){c.onmessage({data:d})}),c.on("error",function(d){c.onerror(d)}),c.on("detachedExit",function(){})),c.postMessage({cmd:"load",urlOrBlob:a.mainScriptUrlOrBlob,wasmMemory:St,wasmModule:vc})},allocateUnusedWorker:function(){if(!a.locateFile){D.unusedWorkers.push(new Worker(new URL("duckdb_wasm.worker.js",fc.url)));return}var c=An("duckdb_wasm.worker.js");D.unusedWorkers.push(new Worker(c))},getNewWorker:function(){return D.unusedWorkers.length==0&&(D.allocateUnusedWorker(),D.loadWasmModuleToWorker(D.unusedWorkers[0])),D.unusedWorkers.pop()}};function ih(){var c=is(),l=o()[c+44>>2],d=o()[c+48>>2],f=l-d;Pu(l,f),ss(l)}a.establishStackSpace=ih;function $c(c){if(x)return tt(1,0,c);try{Yc(c)}catch(l){Gc(l)}}var Xi=[];function Eo(c){var l=Xi[c];return l||(c>=Xi.length&&(Xi.length=c+1),Xi[c]=l=Lc.get(c)),l}function sh(c,l){return Eo(c)(l)}a.invokeEntryPoint=sh;function oh(c,l,d){D.tlsInitFunctions.push(c)}function ah(c,l,d,f){Ve("Assertion failed: "+Be(c)+", at: "+[l?Be(l):"unknown filename",d,f?Be(f):"unknown function"])}var oi;vt?oi=()=>{var c=process.hrtime();return c[0]*1e3+c[1]/1e6}:x?oi=()=>performance.now()-a.__performance_now_clock_drift:oi=()=>performance.now();var ch=!0;function uh(c){return o()[Uu()>>2]=c,c}function Xc(c,l){var d;if(c===0)d=Date.now();else if((c===1||c===4)&&ch)d=oi();else return uh(28),-1;return o()[l>>2]=d/1e3|0,o()[l+4>>2]=d%1e3*1e3*1e3|0,0}function lh(c,l){return Xc(c,l)}function dh(c){Lu(c,!lt,1,!ht),D.threadInit()}function fh(c){x?postMessage({cmd:"cleanupThread",thread:c}):Wc(c)}function Kc(c){var l=D.getNewWorker();if(!l)return 6;D.runningWorkers.push(l);var d=D.pthreads[c.pthread_ptr]={worker:l,threadInfoStruct:c.pthread_ptr};l.pthread=d;var f={cmd:"run",start_routine:c.startRoutine,arg:c.arg,threadInfoStruct:c.pthread_ptr};return l.runPthread=function(){f.time=performance.now(),l.postMessage(f,c.transferList)},l.loaded&&(l.runPthread(),delete l.runPthread),0}function hh(c,l,d,f){if(typeof SharedArrayBuffer>"u")return Lt("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var _=[],y=0;if(x&&(_.length===0||y))return Nu(687865856,c,l,d,f);if(y)return y;var b={startRoutine:d,pthread_ptr:c,arg:f,transferList:_};return x?(b.cmd="spawnThread",postMessage(b,_),0):Kc(b)}function ph(){postMessage({cmd:"detachedExit"})}var zt={mappings:{},buffers:[null,[],[]],printChar:function(c,l){var d=zt.buffers[c];l===0||l===10?((c===1?xe:Lt)(xc(d,0)),d.length=0):d.push(l)},varargs:void 0,get:function(){zt.varargs+=4;var c=o()[zt.varargs-4>>2];return c},getStr:function(c){var l=Be(c);return l},get64:function(c,l){return c}};function Jc(c,l,d,f,_){if(x)return tt(2,1,c,l,d,f,_)}function qc(c,l){return x?tt(3,1,c,l):(c=zt.getStr(c),zt.doAccess(c,l))}function mh(){Lt("missing function: $SOCKFS"),Ve(-1)}function Zc(){Lt("missing function: $FS"),Ve(-1)}function ai(c){var l=mh.getSocket(c);if(!l)throw new Zc.ErrnoError(8);return l}function Oo(c){return(c&255)+"."+(c>>8&255)+"."+(c>>16&255)+"."+(c>>24&255)}function Qc(c){var l="",d=0,f=0,_=0,y=0,b=0,w=0,B=[c[0]&65535,c[0]>>16,c[1]&65535,c[1]>>16,c[2]&65535,c[2]>>16,c[3]&65535,c[3]>>16],st=!0,rt="";for(w=0;w<5;w++)if(B[w]!==0){st=!1;break}if(st){if(rt=Oo(B[6]|B[7]<<16),B[5]===-1)return l="::ffff:",l+=rt,l;if(B[5]===0)return l="::",rt==="0.0.0.0"&&(rt=""),rt==="0.0.0.1"&&(rt="1"),l+=rt,l}for(d=0;d<8;d++)B[d]===0&&(d-_>1&&(b=0),_=d,b++),b>f&&(f=b,y=d-f+1);for(d=0;d<8;d++){if(f>1&&B[d]===0&&d>=y&&d<y+f){d===y&&(l+=":",y===0&&(l+=":"));continue}l+=Number(Vo(B[d]&65535)).toString(16),l+=d<7?":":""}return l}function tu(c,l){var d=i()[c>>1],f=Vo(s()[c+2>>1]),_;switch(d){case 2:if(l!==16)return{errno:28};_=o()[c+4>>2],_=Oo(_);break;case 10:if(l!==28)return{errno:28};_=[o()[c+8>>2],o()[c+12>>2],o()[c+16>>2],o()[c+20>>2]],_=Qc(_);break;default:return{errno:5}}return{family:d,addr:_,port:f}}function Ki(c){for(var l=c.split("."),d=0;d<4;d++){var f=Number(l[d]);if(isNaN(f))return null;l[d]=f}return(l[0]|l[1]<<8|l[2]<<16|l[3]<<24)>>>0}function Ji(c){return parseInt(c)}function Mo(c){var l,d,f,_,y=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,b=[];if(!y.test(c))return null;if(c==="::")return[0,0,0,0,0,0,0,0];for(c.startsWith("::")?c=c.replace("::","Z:"):c=c.replace("::",":Z:"),c.indexOf(".")>0?(c=c.replace(new RegExp("[.]","g"),":"),l=c.split(":"),l[l.length-4]=Ji(l[l.length-4])+Ji(l[l.length-3])*256,l[l.length-3]=Ji(l[l.length-2])+Ji(l[l.length-1])*256,l=l.slice(0,l.length-2)):l=c.split(":"),f=0,_=0,d=0;d<l.length;d++)if(typeof l[d]=="string")if(l[d]==="Z"){for(_=0;_<8-l.length+1;_++)b[d+_]=0;f=_-1}else b[d+f]=ns(parseInt(l[d],16));else b[d+f]=l[d];return[b[1]<<16|b[0],b[3]<<16|b[2],b[5]<<16|b[4],b[7]<<16|b[6]]}var Te={address_map:{id:1,addrs:{},names:{}},lookup_name:function(c){var l=Ki(c);if(l!==null||(l=Mo(c),l!==null))return c;var d;if(Te.address_map.addrs[c])d=Te.address_map.addrs[c];else{var f=Te.address_map.id++;Sc(f<65535,"exceeded max address mappings of 65535"),d="172.29."+(f&255)+"."+(f&65280),Te.address_map.names[d]=c,Te.address_map.addrs[c]=d}return d},lookup_addr:function(c){return Te.address_map.names[c]?Te.address_map.names[c]:null}};function eu(c,l,d){if(d&&c===0)return null;var f=tu(c,l);if(f.errno)throw new Zc.ErrnoError(f.errno);return f.addr=Te.lookup_addr(f.addr)||f.addr,f}function ru(c,l,d){if(x)return tt(4,1,c,l,d);var f=ai(c),_=eu(l,d);return f.sock_ops.bind(f,_.addr,_.port),0}function nu(c,l,d){if(x)return tt(5,1,c,l,d);var f=ai(c),_=eu(l,d);return f.sock_ops.connect(f,_.addr,_.port),0}function iu(c,l,d){return x?tt(6,1,c,l,d):(zt.varargs=d,0)}function su(c,l){if(x)return tt(7,1,c,l)}function ou(c,l,d,f){if(x)return tt(8,1,c,l,d,f)}function au(c,l,d){if(x)return tt(9,1,c,l,d)}function cu(c,l,d){if(x)return tt(10,1,c,l,d)}function Ro(c,l,d,f,_){switch(l){case 2:d=Ki(d),jc(c,16),_&&(o()[_>>2]=16),i()[c>>1]=l,o()[c+4>>2]=d,i()[c+2>>1]=ns(f);break;case 10:d=Mo(d),jc(c,28),_&&(o()[_>>2]=28),o()[c>>2]=l,o()[c+8>>2]=d[0],o()[c+12>>2]=d[1],o()[c+16>>2]=d[2],o()[c+20>>2]=d[3],i()[c+2>>1]=ns(f);break;default:return 5}return 0}function uu(c,l,d){if(x)return tt(11,1,c,l,d);var f=ai(c);if(!f.daddr)return-53;var _=Ro(l,f.family,Te.lookup_name(f.daddr),f.dport,d);return 0}function lu(c,l,d,f,_){if(x)return tt(12,1,c,l,d,f,_);var y=ai(c);return l===1&&d===4?(o()[f>>2]=y.error,o()[_>>2]=4,y.error=null,0):-50}function du(c,l,d){return x?tt(13,1,c,l,d):(zt.varargs=d,0)}function fu(c,l){if(x)return tt(14,1,c,l)}function hu(c,l){return x?tt(15,1,c,l):(c=zt.getStr(c),zt.doMkdir(c,l))}function pu(c,l,d){if(x)return tt(16,1,c,l,d);zt.varargs=d}function mu(c,l,d,f,_,y){if(x)return tt(17,1,c,l,d,f,_,y);var b=ai(c),w=b.sock_ops.recvmsg(b,d);if(!w)return 0;if(_)var B=Ro(_,b.family,Te.lookup_name(w.addr),w.port,y);return n().set(w.buffer,l),w.buffer.byteLength}function _u(c,l){if(x)return tt(18,1,c,l)}function yu(c){if(x)return tt(19,1,c)}function bu(c,l,d,f,_,y){if(x)return tt(20,1,c,l,d,f,_,y)}function gu(c,l,d){if(x)return tt(21,1,c,l,d)}function wu(c,l){if(x)return tt(22,1,c,l)}function vu(c){if(x)return tt(23,1,c)}function _h(c,l){Ve("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function yh(c,l){Ve("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function bh(){return 2097152}function gh(c,l,d){for(var f=performance.now(),_=f+d,y=Atomics.exchange(o(),os>>2,c);;){if(f=performance.now(),f>_)return y=Atomics.exchange(o(),os>>2,0),-73;if(y=Atomics.exchange(o(),os>>2,0),y==0)break;if(Co(),Atomics.load(o(),c>>2)!=l)return-6;y=Atomics.exchange(o(),os>>2,c)}return 0}function wh(c,l){if(c==l)postMessage({cmd:"processQueuedMainThreadWork"});else if(x)postMessage({targetThread:c,cmd:"processThreadQueue"});else{var d=D.pthreads[c],f=d&&d.worker;if(!f)return;f.postMessage({cmd:"processThreadQueue"})}return 1}function vh(){Ve("")}function Sh(c,l){return globalThis.DUCKDB_RUNTIME.createDirectory(a,c,l)}function Ih(c,l){return globalThis.DUCKDB_RUNTIME.checkDirectory(a,c,l)}function Ah(c,l){return globalThis.DUCKDB_RUNTIME.listDirectoryEntries(a,c,l)}function xh(c,l){return globalThis.DUCKDB_RUNTIME.removeDirectory(a,c,l)}function Bh(c){return globalThis.DUCKDB_RUNTIME.closeFile(a,c)}function Fh(c,l){return globalThis.DUCKDB_RUNTIME.checkFile(a,c,l)}function Th(c){return globalThis.DUCKDB_RUNTIME.getLastFileModificationTime(a,c)}function Dh(c,l,d,f){return globalThis.DUCKDB_RUNTIME.moveFile(a,c,l,d,f)}function Eh(c,l){return globalThis.DUCKDB_RUNTIME.openFile(a,c,l)}function Oh(c,l,d,f){return globalThis.DUCKDB_RUNTIME.readFile(a,c,l,d,f)}function Mh(c,l){return globalThis.DUCKDB_RUNTIME.truncateFile(a,c,l)}function Rh(c,l,d,f){return globalThis.DUCKDB_RUNTIME.writeFile(a,c,l,d,f)}function kh(c,l){return globalThis.DUCKDB_RUNTIME.glob(a,c,l)}function Uh(c){return globalThis.DUCKDB_RUNTIME.testPlatformFeature(a,c)}function Lh(c,l,d,f,_,y){return globalThis.DUCKDB_RUNTIME.callScalarUDF(a,c,l,d,f,_,y)}function Nh(){vt||lt||ri("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function Ch(){return 2147483648}function Ph(c,l,d){n().copyWithin(c,l,l+d)}function Vh(){return vt?gf().cpus().length:navigator.hardwareConcurrency}function tt(c,l){var d=arguments.length-2,f=arguments;return Do(function(){for(var _=d,y=xn(_*8),b=y>>3,w=0;w<d;w++){var B=f[2+w];u()[b+w]=B}return Cu(c,_,y,l)})}var ko=[];function Hh(c,l,d){ko.length=l;for(var f=d>>3,_=0;_<l;_++)ko[_]=u()[f+_];var y=c<0,b=y?eh[-c-1]:lp[c];return b.apply(null,ko)}function zh(c){try{return St.grow(c-de.byteLength+65535>>>16),Or(St.buffer),1}catch(l){}}function Wh(c){var l=n().length;if(c=c>>>0,c<=l)return!1;var d=2147483648;if(c>d)return!1;for(var f=1;f<=4;f*=2){var _=l*(1+.2/f);_=Math.min(_,c+100663296);var y=Math.min(d,Uf(Math.max(c,_),65536)),b=zh(y);if(b)return!0}return!1}var J={inEventHandler:0,removeAllEventListeners:function(){for(var c=J.eventHandlers.length-1;c>=0;--c)J._removeHandler(c);J.eventHandlers=[],J.deferredCalls=[]},registerRemoveEventListeners:function(){J.removeEventListenersRegistered||(Pf.push(J.removeAllEventListeners),J.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(c,l,d){function f(b,w){if(b.length!=w.length)return!1;for(var B in b)if(b[B]!=w[B])return!1;return!0}for(var _ in J.deferredCalls){var y=J.deferredCalls[_];if(y.targetFunction==c&&f(y.argsList,d))return}J.deferredCalls.push({targetFunction:c,precedence:l,argsList:d}),J.deferredCalls.sort(function(b,w){return b.precedence<w.precedence})},removeDeferredCalls:function(c){for(var l=0;l<J.deferredCalls.length;++l)J.deferredCalls[l].targetFunction==c&&(J.deferredCalls.splice(l,1),--l)},canPerformEventHandlerRequests:function(){return J.inEventHandler&&J.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(!!J.canPerformEventHandlerRequests())for(var c=0;c<J.deferredCalls.length;++c){var l=J.deferredCalls[c];J.deferredCalls.splice(c,1),--c,l.targetFunction.apply(null,l.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(c,l){for(var d=0;d<J.eventHandlers.length;++d)J.eventHandlers[d].target==c&&(!l||l==J.eventHandlers[d].eventTypeString)&&J._removeHandler(d--)},_removeHandler:function(c){var l=J.eventHandlers[c];l.target.removeEventListener(l.eventTypeString,l.eventListenerFunc,l.useCapture),J.eventHandlers.splice(c,1)},registerOrRemoveHandler:function(c){var l=function(_){++J.inEventHandler,J.currentEventHandler=c,J.runDeferredCalls(),c.handlerFunc(_),J.runDeferredCalls(),--J.inEventHandler};if(c.callbackfunc)c.eventListenerFunc=l,c.target.addEventListener(c.eventTypeString,l,c.useCapture),J.eventHandlers.push(c),J.registerRemoveEventListeners();else for(var d=0;d<J.eventHandlers.length;++d)J.eventHandlers[d].target==c.target&&J.eventHandlers[d].eventTypeString==c.eventTypeString&&J._removeHandler(d--)},queueEventHandlerOnThread_iiii:function(c,l,d,f,_){Do(function(){var y=xn(12);o()[y>>2]=d,o()[y+4>>2]=f,o()[y+8>>2]=_,Po(c,637534208,l,f,y)})},getTargetThreadForEventCallback:function(c){switch(c){case 1:return 0;case 2:return D.currentProxiedOperationCallerThread;default:return c}},getNodeNameForTarget:function(c){return c?c==window?"#window":c==screen?"#screen":c&&c.nodeName?c.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function jh(c){var l=Fc(c)+1,d=ui(l);return Yi(c,d,l),d}function Yh(c,l,d,f){Do(function(){var _=xn(12),y=0;l&&(y=jh(l)),o()[_>>2]=y,o()[_+4>>2]=d,o()[_+8>>2]=f,Po(c,657457152,0,y,_)})}function Gh(c,l,d,f){l=l?Be(l):"",Yh(c,l,d,f)}function $h(c){return c>2?Be(c):c}var Xh=[0,typeof document<"u"?document:0,typeof window<"u"?window:0];function Kh(c){c=$h(c);var l=Xh[c]||(typeof document<"u"?document.querySelector(c):void 0);return l}function Uo(c){return Kh(c)}function Su(c,l,d){var f=Uo(c);if(!f)return-4;if(f.canvasSharedPtr&&(o()[f.canvasSharedPtr>>2]=l,o()[f.canvasSharedPtr+4>>2]=d),f.offscreenCanvas||!f.controlTransferredOffscreen){f.offscreenCanvas&&(f=f.offscreenCanvas);var _=!1;if(f.GLctxObject&&f.GLctxObject.GLctx){var y=f.GLctxObject.GLctx.getParameter(2978);_=y[0]===0&&y[1]===0&&y[2]===f.width&&y[3]===f.height}f.width=l,f.height=d,_&&f.GLctxObject.GLctx.viewport(0,0,l,d)}else if(f.canvasSharedPtr){var b=o()[f.canvasSharedPtr+8>>2];return Gh(b,c,l,d),1}else return-4;return 0}function Iu(c,l,d){return x?tt(24,1,c,l,d):Su(c,l,d)}function Jh(c,l,d){var f=Uo(c);return f?Su(c,l,d):Iu(c,l,d)}function qh(){throw"unwind"}function Zh(c){var l=c.getExtension("ANGLE_instanced_arrays");if(l)return c.vertexAttribDivisor=function(d,f){l.vertexAttribDivisorANGLE(d,f)},c.drawArraysInstanced=function(d,f,_,y){l.drawArraysInstancedANGLE(d,f,_,y)},c.drawElementsInstanced=function(d,f,_,y,b){l.drawElementsInstancedANGLE(d,f,_,y,b)},1}function Qh(c){var l=c.getExtension("OES_vertex_array_object");if(l)return c.createVertexArray=function(){return l.createVertexArrayOES()},c.deleteVertexArray=function(d){l.deleteVertexArrayOES(d)},c.bindVertexArray=function(d){l.bindVertexArrayOES(d)},c.isVertexArray=function(d){return l.isVertexArrayOES(d)},1}function tp(c){var l=c.getExtension("WEBGL_draw_buffers");if(l)return c.drawBuffers=function(d,f){l.drawBuffersWEBGL(d,f)},1}function ep(c){return!!(c.multiDrawWebgl=c.getExtension("WEBGL_multi_draw"))}var At={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:{},offscreenCanvases:{},queries:[],stringCache:{},unpackAlignment:4,recordError:function(l){At.lastError||(At.lastError=l)},getNewId:function(c){for(var l=At.counter++,d=c.length;d<l;d++)c[d]=null;return l},getSource:function(c,l,d,f){for(var _="",y=0;y<l;++y){var b=f?o()[f+y*4>>2]:-1;_+=Be(o()[d+y*4>>2],b<0?void 0:b)}return _},createContext:function(c,l){c.getContextSafariWebGL2Fixed||(c.getContextSafariWebGL2Fixed=c.getContext,c.getContext=function(_,y){var b=c.getContextSafariWebGL2Fixed(_,y);return _=="webgl"==b instanceof WebGLRenderingContext?b:null});var d=c.getContext("webgl",l);if(!d)return 0;var f=At.registerContext(d,l);return f},registerContext:function(c,l){var d=ui(8);o()[d+4>>2]=is();var f={handle:d,attributes:l,version:l.majorVersion,GLctx:c};return c.canvas&&(c.canvas.GLctxObject=f),At.contexts[d]=f,(typeof l.enableExtensionsByDefault>"u"||l.enableExtensionsByDefault)&&At.initExtensions(f),d},makeContextCurrent:function(c){return At.currentContext=At.contexts[c],a.ctx=ku=At.currentContext&&At.currentContext.GLctx,!(c&&!ku)},getContext:function(c){return At.contexts[c]},deleteContext:function(c){At.currentContext===At.contexts[c]&&(At.currentContext=null),typeof J=="object"&&J.removeAllHandlersOnTarget(At.contexts[c].GLctx.canvas),At.contexts[c]&&At.contexts[c].GLctx.canvas&&(At.contexts[c].GLctx.canvas.GLctxObject=void 0),Vu(At.contexts[c].handle),At.contexts[c]=null},initExtensions:function(c){if(c||(c=At.currentContext),!c.initExtensionsDone){c.initExtensionsDone=!0;var l=c.GLctx;Zh(l),Qh(l),tp(l),l.disjointTimerQueryExt=l.getExtension("EXT_disjoint_timer_query"),ep(l);var d=l.getSupportedExtensions()||[];d.forEach(function(f){!f.includes("lose_context")&&!f.includes("debug")&&l.getExtension(f)})}}},rp=["default","low-power","high-performance"];function np(c,l){var d=l>>2,f=o()[d+6],_={alpha:!!o()[d+0],depth:!!o()[d+1],stencil:!!o()[d+2],antialias:!!o()[d+3],premultipliedAlpha:!!o()[d+4],preserveDrawingBuffer:!!o()[d+5],powerPreference:rp[f],failIfMajorPerformanceCaveat:!!o()[d+7],majorVersion:o()[d+8],minorVersion:o()[d+9],enableExtensionsByDefault:o()[d+10],explicitSwapControl:o()[d+11],proxyContextToMainThread:o()[d+12],renderViaOffscreenBackBuffer:o()[d+13]},y=Uo(c);if(!y||_.explicitSwapControl)return 0;var b=At.createContext(y,_);return b}function ip(c,l){return np(c,l)}var Lo={};function sp(){return Z||"./this.program"}function ci(){if(!ci.strings){var c=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",l={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:c,_:sp()};for(var d in Lo)Lo[d]===void 0?delete l[d]:l[d]=Lo[d];var f=[];for(var d in l)f.push(d+"="+l[d]);ci.strings=f}return ci.strings}function Au(c,l){if(x)return tt(25,1,c,l);var d=0;return ci().forEach(function(f,_){var y=l+d;o()[c+_*4>>2]=y,kf(f,y),d+=f.length+1}),0}function xu(c,l){if(x)return tt(26,1,c,l);var d=ci();o()[c>>2]=d.length;var f=0;return d.forEach(function(_){f+=_.length+1}),o()[l>>2]=f,0}function Bu(c){return x?tt(27,1,c):0}function Fu(c,l,d,f,_,y){if(x)return tt(28,1,c,l,d,f,_,y);var b=zt.getStreamFromFD(c),w=zt.doReadv(b,l,d,f);return o()[y>>2]=w,0}function Tu(c,l,d,f,_,y){if(x)return tt(29,1,c,l,d,f,_,y);var b=zt.getStreamFromFD(c),w=zt.doWritev(b,l,d,f);return o()[y>>2]=w,0}function Du(c,l,d,f){if(x)return tt(30,1,c,l,d,f);var _=zt.getStreamFromFD(c),y=zt.doReadv(_,l,d);return o()[f>>2]=y,0}function Eu(c,l,d,f,_){if(x)return tt(31,1,c,l,d,f,_)}function Ou(c){if(x)return tt(32,1,c);var l=zt.getStreamFromFD(c);return l.stream_ops&&l.stream_ops.fsync?-l.stream_ops.fsync(l):0}function Mu(c,l,d,f){if(x)return tt(33,1,c,l,d,f);for(var _=0,y=0;y<d;y++){var b=o()[l>>2],w=o()[l+4>>2];l+=8;for(var B=0;B<w;B++)zt.printChar(c,n()[b+B]);_+=w}return o()[f>>2]=_,0}function Ru(c,l,d,f){if(x)return tt(34,1,c,l,d,f);var _=0,y=0,b=0,w=0,B=0,st=0,rt;function De(pt,Ee,Tt,He,Qe,di){var v,E,ot,ct;return E=pt===10?28:16,Qe=pt===10?Qc(Qe):Oo(Qe),v=ui(E),ct=Ro(v,pt,Qe,di),Sc(!ct),ot=ui(32),o()[ot+4>>2]=pt,o()[ot+8>>2]=Ee,o()[ot+12>>2]=Tt,o()[ot+24>>2]=He,o()[ot+20>>2]=v,pt===10?o()[ot+16>>2]=28:o()[ot+16>>2]=16,o()[ot+28>>2]=0,ot}if(d&&(b=o()[d>>2],w=o()[d+4>>2],B=o()[d+8>>2],st=o()[d+12>>2]),B&&!st&&(st=B===2?17:6),!B&&st&&(B=st===17?2:1),st===0&&(st=6),B===0&&(B=1),!c&&!l)return-2;if(b&-1088||d!==0&&o()[d>>2]&2&&!c)return-1;if(b&32)return-2;if(B!==0&&B!==1&&B!==2)return-7;if(w!==0&&w!==2&&w!==10)return-6;if(l&&(l=Be(l),y=parseInt(l,10),isNaN(y)))return b&1024?-2:-8;if(!c)return w===0&&(w=2),(b&1)===0&&(w===2?_=rs(2130706433):_=[0,0,0,1]),rt=De(w,B,st,null,_,y),o()[f>>2]=rt,0;if(c=Be(c),_=Ki(c),_!==null)if(w===0||w===2)w=2;else if(w===10&&b&8)_=[0,0,rs(65535),_],w=10;else return-2;else if(_=Mo(c),_!==null)if(w===0||w===10)w=10;else return-2;return _!=null?(rt=De(w,B,st,c,_,y),o()[f>>2]=rt,0):b&4?-2:(c=Te.lookup_name(c),_=Ki(c),w===0?w=2:w===10&&(_=[0,0,rs(65535),_]),rt=De(w,B,st,null,_,y),o()[f>>2]=rt,0)}function op(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var c=new Uint8Array(1);return function(){return crypto.getRandomValues(c),c[0]}}else if(vt)try{var l=dm("crypto");return function(){return l.randomBytes(1)[0]}}catch(d){}return function(){Ve("randomDevice")}}function qi(c,l){qi.randomDevice||(qi.randomDevice=op());for(var d=0;d<l;d++)e()[c+d>>0]=qi.randomDevice();return 0}function ap(c,l,d,f,_,y,b){var w=tu(c,l);if(w.errno)return-6;var B=w.port,st=w.addr,rt=!1;if(d&&f){var De;if(b&1||!(De=Te.lookup_addr(st))){if(b&8)return-2}else st=De;var pt=Yi(st,d,f);pt+1>=f&&(rt=!0)}if(_&&y){B=""+B;var pt=Yi(B,_,y);pt+1>=y&&(rt=!0)}return rt?-12:0}function Zi(c){return c%4===0&&(c%100!==0||c%400===0)}function No(c,l){for(var d=0,f=0;f<=l;d+=c[f++]);return d}var Qi=[31,29,31,30,31,30,31,31,30,31,30,31],ts=[31,28,31,30,31,30,31,31,30,31,30,31];function es(c,l){for(var d=new Date(c.getTime());l>0;){var f=Zi(d.getFullYear()),_=d.getMonth(),y=(f?Qi:ts)[_];if(l>y-d.getDate())l-=y-d.getDate()+1,d.setDate(1),_<11?d.setMonth(_+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else return d.setDate(d.getDate()+l),d}return d}function cp(c,l,d,f){var _=o()[f+40>>2],y={tm_sec:o()[f>>2],tm_min:o()[f+4>>2],tm_hour:o()[f+8>>2],tm_mday:o()[f+12>>2],tm_mon:o()[f+16>>2],tm_year:o()[f+20>>2],tm_wday:o()[f+24>>2],tm_yday:o()[f+28>>2],tm_isdst:o()[f+32>>2],tm_gmtoff:o()[f+36>>2],tm_zone:_?Be(_):""},b=Be(d),w={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var B in w)b=b.replace(new RegExp(B,"g"),w[B]);var st=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],rt=["January","February","March","April","May","June","July","August","September","October","November","December"];function De(v,E,ot){for(var ct=typeof v=="number"?v.toString():v||"";ct.length<E;)ct=ot[0]+ct;return ct}function pt(v,E){return De(v,E,"0")}function Ee(v,E){function ot(tr){return tr<0?-1:tr>0?1:0}var ct;return(ct=ot(v.getFullYear()-E.getFullYear()))===0&&(ct=ot(v.getMonth()-E.getMonth()))===0&&(ct=ot(v.getDate()-E.getDate())),ct}function Tt(v){switch(v.getDay()){case 0:return new Date(v.getFullYear()-1,11,29);case 1:return v;case 2:return new Date(v.getFullYear(),0,3);case 3:return new Date(v.getFullYear(),0,2);case 4:return new Date(v.getFullYear(),0,1);case 5:return new Date(v.getFullYear()-1,11,31);case 6:return new Date(v.getFullYear()-1,11,30)}}function He(v){var E=es(new Date(v.tm_year+1900,0,1),v.tm_yday),ot=new Date(E.getFullYear(),0,4),ct=new Date(E.getFullYear()+1,0,4),tr=Tt(ot),Mr=Tt(ct);return Ee(tr,E)<=0?Ee(Mr,E)<=0?E.getFullYear()+1:E.getFullYear():E.getFullYear()-1}var Qe={"%a":function(v){return st[v.tm_wday].substring(0,3)},"%A":function(v){return st[v.tm_wday]},"%b":function(v){return rt[v.tm_mon].substring(0,3)},"%B":function(v){return rt[v.tm_mon]},"%C":function(v){var E=v.tm_year+1900;return pt(E/100|0,2)},"%d":function(v){return pt(v.tm_mday,2)},"%e":function(v){return De(v.tm_mday,2," ")},"%g":function(v){return He(v).toString().substring(2)},"%G":function(v){return He(v)},"%H":function(v){return pt(v.tm_hour,2)},"%I":function(v){var E=v.tm_hour;return E==0?E=12:E>12&&(E-=12),pt(E,2)},"%j":function(v){return pt(v.tm_mday+No(Zi(v.tm_year+1900)?Qi:ts,v.tm_mon-1),3)},"%m":function(v){return pt(v.tm_mon+1,2)},"%M":function(v){return pt(v.tm_min,2)},"%n":function(){return`
`},"%p":function(v){return v.tm_hour>=0&&v.tm_hour<12?"AM":"PM"},"%S":function(v){return pt(v.tm_sec,2)},"%t":function(){return"	"},"%u":function(v){return v.tm_wday||7},"%U":function(v){var E=new Date(v.tm_year+1900,0,1),ot=E.getDay()===0?E:es(E,7-E.getDay()),ct=new Date(v.tm_year+1900,v.tm_mon,v.tm_mday);if(Ee(ot,ct)<0){var tr=No(Zi(ct.getFullYear())?Qi:ts,ct.getMonth()-1)-31,Mr=31-ot.getDate(),cn=Mr+tr+ct.getDate();return pt(Math.ceil(cn/7),2)}return Ee(ot,E)===0?"01":"00"},"%V":function(v){var E=new Date(v.tm_year+1900,0,4),ot=new Date(v.tm_year+1901,0,4),ct=Tt(E),tr=Tt(ot),Mr=es(new Date(v.tm_year+1900,0,1),v.tm_yday);if(Ee(Mr,ct)<0)return"53";if(Ee(tr,Mr)<=0)return"01";var cn;return ct.getFullYear()<v.tm_year+1900?cn=v.tm_yday+32-ct.getDate():cn=v.tm_yday+1-ct.getDate(),pt(Math.ceil(cn/7),2)},"%w":function(v){return v.tm_wday},"%W":function(v){var E=new Date(v.tm_year,0,1),ot=E.getDay()===1?E:es(E,E.getDay()===0?1:7-E.getDay()+1),ct=new Date(v.tm_year+1900,v.tm_mon,v.tm_mday);if(Ee(ot,ct)<0){var tr=No(Zi(ct.getFullYear())?Qi:ts,ct.getMonth()-1)-31,Mr=31-ot.getDate(),cn=Mr+tr+ct.getDate();return pt(Math.ceil(cn/7),2)}return Ee(ot,E)===0?"01":"00"},"%y":function(v){return(v.tm_year+1900).toString().substring(2)},"%Y":function(v){return v.tm_year+1900},"%z":function(v){var E=v.tm_gmtoff,ot=E>=0;return E=Math.abs(E)/60,E=E/60*100+E%60,(ot?"+":"-")+String("0000"+E).slice(-4)},"%Z":function(v){return v.tm_zone},"%%":function(){return"%"}};for(var B in Qe)b.includes(B)&&(b=b.replace(new RegExp(B,"g"),Qe[B](y)));var di=dp(b,!1);return di.length>l?0:(Tc(di,c),di.length-1)}function up(c,l,d,f){return cp(c,l,d,f)}x||D.initMainThread();var ku,lp=[null,$c,Jc,qc,ru,nu,iu,su,ou,au,cu,uu,lu,du,fu,hu,pu,mu,_u,yu,bu,gu,wu,vu,Iu,Au,xu,Bu,Fu,Tu,Du,Eu,Ou,Mu,Ru];function dp(c,l,d){var f=d>0?d:Fc(c)+1,_=new Array(f),y=Bc(c,_,0,_.length);return l&&(_.length=y),_}var fp={b:ah,ua:lh,ra:dh,ka:fh,r:hh,_:ph,W:Jc,P:qc,Y:ru,X:nu,c:iu,fa:su,da:ou,aa:au,ba:cu,R:uu,V:lu,ha:du,ca:fu,ga:hu,s:pu,T:mu,N:_u,p:yu,U:bu,l:gu,ea:wu,q:vu,n:_h,Z:yh,oa:bh,A:gh,w:wh,e:vh,o:Xc,G:Sh,H:Ih,E:Ah,F:xh,k:Bh,C:Fh,J:Th,D:Dh,L:Eh,g:Oh,I:Mh,h:Rh,B:kh,j:Uh,M:Lh,u:Nh,ia:Ch,f:oi,pa:Ph,ja:Vh,sa:Hh,qa:Wh,ta:Jh,K:qh,v:ip,ma:Au,na:xu,S:Yc,d:Bu,y:Fu,x:Tu,t:Du,z:Eu,O:Ou,i:Mu,m:Ru,$:qi,Q:ap,a:St||a.wasmMemory,la:up},ab=th(),hp=a.___wasm_call_ctors=function(){return(hp=a.___wasm_call_ctors=a.asm.va).apply(null,arguments)},pp=a._main=function(){return(pp=a._main=a.asm.wa).apply(null,arguments)},mp=a._duckdb_web_fs_glob_add_path=function(){return(mp=a._duckdb_web_fs_glob_add_path=a.asm.ya).apply(null,arguments)},_p=a._duckdb_web_clear_response=function(){return(_p=a._duckdb_web_clear_response=a.asm.za).apply(null,arguments)},yp=a._duckdb_web_fail_with=function(){return(yp=a._duckdb_web_fail_with=a.asm.Aa).apply(null,arguments)},bp=a._duckdb_web_reset=function(){return(bp=a._duckdb_web_reset=a.asm.Ba).apply(null,arguments)},gp=a._duckdb_web_connect=function(){return(gp=a._duckdb_web_connect=a.asm.Ca).apply(null,arguments)},wp=a._duckdb_web_disconnect=function(){return(wp=a._duckdb_web_disconnect=a.asm.Da).apply(null,arguments)},vp=a._duckdb_web_flush_files=function(){return(vp=a._duckdb_web_flush_files=a.asm.Ea).apply(null,arguments)},Sp=a._duckdb_web_flush_file=function(){return(Sp=a._duckdb_web_flush_file=a.asm.Fa).apply(null,arguments)},Ip=a._duckdb_web_open=function(){return(Ip=a._duckdb_web_open=a.asm.Ga).apply(null,arguments)},Ap=a._duckdb_web_get_global_file_info=function(){return(Ap=a._duckdb_web_get_global_file_info=a.asm.Ha).apply(null,arguments)},xp=a._duckdb_web_collect_file_stats=function(){return(xp=a._duckdb_web_collect_file_stats=a.asm.Ia).apply(null,arguments)},Bp=a._duckdb_web_export_file_stats=function(){return(Bp=a._duckdb_web_export_file_stats=a.asm.Ja).apply(null,arguments)},Fp=a._duckdb_web_fs_drop_file=function(){return(Fp=a._duckdb_web_fs_drop_file=a.asm.Ka).apply(null,arguments)},Tp=a._duckdb_web_fs_drop_files=function(){return(Tp=a._duckdb_web_fs_drop_files=a.asm.La).apply(null,arguments)},Dp=a._duckdb_web_fs_glob_file_infos=function(){return(Dp=a._duckdb_web_fs_glob_file_infos=a.asm.Ma).apply(null,arguments)},Ep=a._duckdb_web_fs_get_file_info_by_id=function(){return(Ep=a._duckdb_web_fs_get_file_info_by_id=a.asm.Na).apply(null,arguments)},Op=a._duckdb_web_fs_get_file_info_by_name=function(){return(Op=a._duckdb_web_fs_get_file_info_by_name=a.asm.Oa).apply(null,arguments)},Mp=a._duckdb_web_fs_set_file_descriptor=function(){return(Mp=a._duckdb_web_fs_set_file_descriptor=a.asm.Pa).apply(null,arguments)},Rp=a._duckdb_web_fs_register_file_url=function(){return(Rp=a._duckdb_web_fs_register_file_url=a.asm.Qa).apply(null,arguments)},kp=a._duckdb_web_fs_register_file_buffer=function(){return(kp=a._duckdb_web_fs_register_file_buffer=a.asm.Ra).apply(null,arguments)},Up=a._duckdb_web_copy_file_to_buffer=function(){return(Up=a._duckdb_web_copy_file_to_buffer=a.asm.Sa).apply(null,arguments)},Lp=a._duckdb_web_copy_file_to_path=function(){return(Lp=a._duckdb_web_copy_file_to_path=a.asm.Ta).apply(null,arguments)},Np=a._duckdb_web_get_version=function(){return(Np=a._duckdb_web_get_version=a.asm.Ua).apply(null,arguments)},Cp=a._duckdb_web_get_feature_flags=function(){return(Cp=a._duckdb_web_get_feature_flags=a.asm.Va).apply(null,arguments)},Pp=a._duckdb_web_tokenize=function(){return(Pp=a._duckdb_web_tokenize=a.asm.Wa).apply(null,arguments)},Vp=a._duckdb_web_udf_scalar_create=function(){return(Vp=a._duckdb_web_udf_scalar_create=a.asm.Xa).apply(null,arguments)},Hp=a._duckdb_web_prepared_create=function(){return(Hp=a._duckdb_web_prepared_create=a.asm.Ya).apply(null,arguments)},zp=a._duckdb_web_prepared_close=function(){return(zp=a._duckdb_web_prepared_close=a.asm.Za).apply(null,arguments)},Wp=a._duckdb_web_prepared_run=function(){return(Wp=a._duckdb_web_prepared_run=a.asm._a).apply(null,arguments)},jp=a._duckdb_web_prepared_send=function(){return(jp=a._duckdb_web_prepared_send=a.asm.$a).apply(null,arguments)},Yp=a._duckdb_web_query_run=function(){return(Yp=a._duckdb_web_query_run=a.asm.ab).apply(null,arguments)},Gp=a._duckdb_web_query_send=function(){return(Gp=a._duckdb_web_query_send=a.asm.bb).apply(null,arguments)},$p=a._duckdb_web_query_fetch_results=function(){return($p=a._duckdb_web_query_fetch_results=a.asm.cb).apply(null,arguments)},Xp=a._duckdb_web_get_tablenames=function(){return(Xp=a._duckdb_web_get_tablenames=a.asm.db).apply(null,arguments)},Kp=a._duckdb_web_insert_arrow_from_ipc_stream=function(){return(Kp=a._duckdb_web_insert_arrow_from_ipc_stream=a.asm.eb).apply(null,arguments)},Jp=a._duckdb_web_insert_csv_from_path=function(){return(Jp=a._duckdb_web_insert_csv_from_path=a.asm.fb).apply(null,arguments)},qp=a._duckdb_web_insert_json_from_path=function(){return(qp=a._duckdb_web_insert_json_from_path=a.asm.gb).apply(null,arguments)},Zp=a._emscripten_tls_init=function(){return(Zp=a._emscripten_tls_init=a.asm.hb).apply(null,arguments)},Uu=a.___errno_location=function(){return(Uu=a.___errno_location=a.asm.ib).apply(null,arguments)},Lu=a.__emscripten_thread_init=function(){return(Lu=a.__emscripten_thread_init=a.asm.jb).apply(null,arguments)},rs=a._htonl=function(){return(rs=a._htonl=a.asm.kb).apply(null,arguments)},ns=a._htons=function(){return(ns=a._htons=a.asm.lb).apply(null,arguments)},Qp=a._emscripten_current_thread_process_queued_calls=function(){return(Qp=a._emscripten_current_thread_process_queued_calls=a.asm.mb).apply(null,arguments)},Nu=a._emscripten_sync_run_in_main_thread_4=function(){return(Nu=a._emscripten_sync_run_in_main_thread_4=a.asm.nb).apply(null,arguments)},Co=a._emscripten_main_thread_process_queued_calls=function(){return(Co=a._emscripten_main_thread_process_queued_calls=a.asm.ob).apply(null,arguments)},Cu=a._emscripten_run_in_main_runtime_thread_js=function(){return(Cu=a._emscripten_run_in_main_runtime_thread_js=a.asm.pb).apply(null,arguments)},Po=a._emscripten_dispatch_to_thread_=function(){return(Po=a._emscripten_dispatch_to_thread_=a.asm.qb).apply(null,arguments)},Vo=a._ntohs=function(){return(Vo=a._ntohs=a.asm.rb).apply(null,arguments)},Ho=a.__emscripten_thread_free_data=function(){return(Ho=a.__emscripten_thread_free_data=a.asm.sb).apply(null,arguments)},tm=a.__emscripten_thread_exit=function(){return(tm=a.__emscripten_thread_exit=a.asm.tb).apply(null,arguments)},is=a._pthread_self=function(){return(is=a._pthread_self=a.asm.ub).apply(null,arguments)},Pu=a._emscripten_stack_set_limits=function(){return(Pu=a._emscripten_stack_set_limits=a.asm.vb).apply(null,arguments)},zo=a.stackSave=function(){return(zo=a.stackSave=a.asm.wb).apply(null,arguments)},ss=a.stackRestore=function(){return(ss=a.stackRestore=a.asm.xb).apply(null,arguments)},xn=a.stackAlloc=function(){return(xn=a.stackAlloc=a.asm.yb).apply(null,arguments)},ui=a._malloc=function(){return(ui=a._malloc=a.asm.zb).apply(null,arguments)},Vu=a._free=function(){return(Vu=a._free=a.asm.Ab).apply(null,arguments)},os=a.__emscripten_main_thread_futex=1295040,Hu=a.__emscripten_allow_main_runtime_queued_calls=1042192;a.ccall=Rf,a.keepRuntimeAlive=Gi,a.PThread=D,a.PThread=D,a.wasmMemory=St,a.ExitStatus=li;var as;function li(c){this.name="ExitStatus",this.message="Program terminated with exit("+c+")",this.status=c}var em=!1;si=function c(){as||Wo(),as||(si=c)};function rm(c){var l=a._main,d=0,f=0;try{var _=l(d,f);return zu(_,!0),_}catch(y){return Gc(y)}finally{em=!0}}function Wo(c){if(c=c||I,an>0)return;if(x){m(a),Vc(),postMessage({cmd:"loaded"});return}if(Wf(),an>0)return;function l(){as||(as=!0,a.calledRun=!0,!Fo&&(Vc(),jf(),m(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),Wu&&rm(c),Gf()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),l()},1)):l()}a.run=Wo;function zu(c,l){if(ii=c,!l&&x)throw $c(c),"unwind";Gi()||Yf(),nm(c)}function nm(c){ii=c,Gi()||(D.terminateAllThreads(),a.onExit&&a.onExit(c),Fo=!0),X(c,new li(c))}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();var Wu=!0;return a.noInitialRun&&(Wu=!1),x&&(wc=!1,D.initWorker()),Wo(),t.ready}})(),wf=$y;var hc=class{constructor(t,e){this._bindings=t,this._conn=e}close(){this._bindings.disconnect(this._conn)}useUnsafe(t){return t(this._bindings,this._conn)}query(t){let e=this._bindings.runQuery(this._conn,t),n=kt.from(e);return console.assert(n.isSync()),console.assert(n.isFile()),new Dt(n)}send(t){let e=this._bindings.sendQuery(this._conn,t),n=new pc(this._bindings,this._conn,e),i=kt.from(n);return console.assert(i.isSync()),console.assert(i.isStream()),i}getTableNames(t){return this._bindings.getTableNames(this._conn,t)}prepare(t){let e=this._bindings.createPrepared(this._conn,t);return new vf(this._bindings,this._conn,e)}createScalarFunction(t,e,n){this._bindings.createScalarFunction(this._conn,t,e,n)}insertArrowTable(t,e){let n=new Tr;n.writeAll(t);let i=n.toUint8Array(!0);this.insertArrowFromIPCStream(i,e)}insertArrowFromIPCStream(t,e){this._bindings.insertArrowFromIPCStream(this._conn,t,e)}insertCSVFromPath(t,e){this._bindings.insertCSVFromPath(this._conn,t,e)}insertJSONFromPath(t,e){this._bindings.insertJSONFromPath(this._conn,t,e)}},pc=class{constructor(t,e,n){this.bindings=t;this.conn=e;this.header=n;this._first=!0,this._depleted=!1}next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let t=this.bindings.fetchQueryResults(this.conn);return this._depleted=t.length==0,{done:this._depleted,value:t}}[Symbol.iterator](){return this}},vf=class{constructor(t,e,n){this.bindings=t,this.connectionId=e,this.statementId=n}close(){this.bindings.closePrepared(this.connectionId,this.statementId)}query(...t){let e=this.bindings.runPrepared(this.connectionId,this.statementId,t),n=kt.from(e);return console.assert(n.isSync()),console.assert(n.isFile()),new Dt(n)}send(...t){let e=this.bindings.sendPrepared(this.connectionId,this.statementId,t),n=new pc(this.bindings,this.connectionId,e),i=kt.from(n);return console.assert(i.isSync()),console.assert(i.isStream()),i}};var xf=new TextEncoder,Sf=new TextDecoder("utf-8");function xo(r,t,e){let n=xf.encode(e),i=r._malloc(n.byteLength),s=r.HEAPU8.subarray(i,i+n.byteLength);s.set(n),r.HEAPF64[(t>>3)+0]=1,r.HEAPF64[(t>>3)+1]=i,r.HEAPF64[(t>>3)+2]=s.byteLength}function mc(r){switch(r){case"UINT8":case"INT8":return 1;case"INT32":case"FLOAT":return 4;case"INT64":case"UINT64":case"DOUBLE":case"VARCHAR":return 8;default:return 0}}function If(r,t,e,n){let i=r.HEAPU8.subarray(t,t+n*mc(e));switch(e){case"UINT8":return new Uint8Array(i.buffer,i.byteOffset,n);case"INT8":return new Int8Array(i.buffer,i.byteOffset,n);case"INT32":return new Int32Array(i.buffer,i.byteOffset,n);case"FLOAT":return new Float32Array(i.buffer,i.byteOffset,n);case"DOUBLE":return new Float64Array(i.buffer,i.byteOffset,n);case"VARCHAR":return new Float64Array(i.buffer,i.byteOffset,n);default:return new Array(0)}}function Af(r,t,e){let n=r.HEAPU8.subarray(t,t+e);return new Uint8Array(n.buffer,n.byteOffset,e)}function Bo(r,t,e){let n=r.HEAPU8.subarray(t,t+e*8);return new Float64Array(n.buffer,n.byteOffset,e)}function Bf(r,t,e,n,i,s,o,u){try{let a=r._udfFunctions.get(n);if(!a){xo(t,e,"Unknown UDF with id: "+n);return}let h=Sf.decode(t.HEAPU8.subarray(i,i+s)),m=JSON.parse(h),g=Bo(t,o,u/8),S=[],I=[];for(let Ht=0;Ht<m.args.length;++Ht){let oe=m.args[Ht],Et=If(t,g[oe.dataBuffer],oe.physicalType,m.rows),Ce=Af(t,g[oe.validityBuffer],m.rows);if(Et.length==0||Ce.length==0){xo(t,e,"Can't create physical arrays for argument "+oe.physicalType);return}switch(S.push(Ce),oe.physicalType){case"VARCHAR":{let Er=Bo(t,g[oe.lengthBuffer],m.rows),Pe=[];for(let Ut=0;Ut<m.rows;++Ut){if(!Ce[Ut]){Pe.push(null);continue}let xe=t.HEAPU8.subarray(Et[Ut],Et[Ut]+Er[Ut]),Lt=Sf.decode(xe);Pe.push(Lt)}I.push(Pe);break}default:I.push(Et)}}let Z=m.rows*mc(m.ret.physicalType),X=t._malloc(Z),ht=If(t,X,m.ret.physicalType,m.rows),lt=t._malloc(m.rows),vt=Af(t,lt,m.rows);if(ht.length==0||vt.length==0){xo(t,e,"Can't create physical arrays for result");return}let x=ht;m.ret.physicalType=="VARCHAR"&&(x=new Array(m.rows));let jt=[];for(let Ht=0;Ht<m.args.length;++Ht)jt.push(null);for(let Ht=0;Ht<m.rows;++Ht){for(let Et=0;Et<m.args.length;++Et)jt[Et]=S[Et][Ht]?I[Et][Ht]:null;let oe=a.func(...jt);x[Ht]=oe,vt[Ht]=oe==null?0:1}let An=0;switch(m.ret.physicalType){case"VARCHAR":{let Ht=new Array(0);An=t._malloc(m.rows*mc("DOUBLE"));let oe=Bo(t,An,m.rows),Et=0;for(let Ut=0;Ut<m.rows;++Ut){let xe=xf.encode(x[Ut]||"");Ht.push(xe),oe[Ut]=xe.length,Et+=xe.length}let Ce=t._malloc(Et),Er=t.HEAPU8.subarray(Ce,Ce+Et),Pe=0;for(let Ut=0;Ut<m.rows;++Ut){ht[Ut]=Pe;let xe=Ht[Ut];Er.subarray(Pe,Pe+xe.length).set(xe),Pe+=xe.length}}}let ti=3*8,ei=t._malloc(ti),Dr=Bo(t,ei,3);Dr[0]=X,Dr[1]=lt,Dr[2]=An,t.HEAPF64[(e>>3)+0]=0,t.HEAPF64[(e>>3)+1]=ei,t.HEAPF64[(e>>3)+2]=0}catch(a){xo(t,e,a.toString())}}function Ky(){let r=new TextDecoder;return t=>(typeof SharedArrayBuffer<"u"&&t.buffer instanceof SharedArrayBuffer&&(t=new Uint8Array(t)),r.decode(t))}var Jy=Ky();function fr(r,t){r.ccall("duckdb_web_fail_with",null,["string"],[t])}function Qn(r,t,e){let n=r.HEAPU8.subarray(t,t+e),i=new Uint8Array(new ArrayBuffer(n.byteLength));return i.set(n),i}function $(r,t,e){return Jy(r.HEAPU8.subarray(t,t+e))}function at(r,t,e,n){let i=r.stackSave(),s=r.stackAlloc(3*8);e.unshift("number"),n.unshift(s),r.ccall(t,null,e,n);let o=r.HEAPF64[(s>>3)+0],u=r.HEAPF64[(s>>3)+1],a=r.HEAPF64[(s>>3)+2];return r.stackRestore(i),[o,u,a]}function gt(r){r.ccall("duckdb_web_clear_response",null,[],[])}var _c=class{constructor(t){let e=new Float64Array(t.buffer,t.byteOffset,t.byteLength/8),n=new Uint8Array(new ArrayBuffer(t.byteLength));n.set(t.subarray(7*8)),this.totalFileReadsCold=e[0],this.totalFileReadsAhead=e[1],this.totalFileReadsCached=e[2],this.totalFileWrites=e[3],this.totalPageAccesses=e[4],this.totalPageLoads=e[5],this.blockSize=e[6],this.blockStats=n}getBlockStats(t,e){return e=e||{file_reads_cold:0,file_reads_ahead:0,file_reads_cached:0,file_writes:0,page_accesses:0,page_loads:0},e.file_writes=this.blockStats[t*3+0]&15,e.file_reads_cold=this.blockStats[t*3+0]>>4,e.file_reads_ahead=this.blockStats[t*3+1]&15,e.file_reads_cached=this.blockStats[t*3+1]>>4,e.page_accesses=this.blockStats[t*3+1]&15,e.page_loads=this.blockStats[t*3+1]>>4,e}};var qy=new TextEncoder;var yc=class{constructor(t,e){this._instance=null;this._initPromise=null;this._initPromiseResolver=()=>{};this.onInstantiationProgress=[];this._logger=t,this._runtime=e,this._nextUDFId=1}get logger(){return this._logger}get mod(){return this._instance}get pthread(){return this.mod.PThread||null}async instantiate(t=e=>{}){return this._instance!=null?this:(this._initPromise!=null&&(this.onInstantiationProgress.push(t),await this._initPromise),this._initPromise=new Promise(e=>{this._initPromiseResolver=e}),this.onInstantiationProgress=[t],this._instance=await this.instantiateImpl({print:console.log.bind(console),printErr:console.log.bind(console),onRuntimeInitialized:this._initPromiseResolver}),await this._initPromise,this._initPromise=null,this.onInstantiationProgress=this.onInstantiationProgress.filter(e=>e!=t),this)}open(t){let[e,n,i]=at(this.mod,"duckdb_web_open",["string"],[JSON.stringify(t)]);if(e!==0)throw new Error($(this.mod,n,i));gt(this.mod)}reset(){let[t,e,n]=at(this.mod,"duckdb_web_reset",[],[]);if(t!==0)throw new Error($(this.mod,e,n));gt(this.mod)}getVersion(){let[t,e,n]=at(this.mod,"duckdb_web_get_version",[],[]);if(t!==0)throw new Error($(this.mod,e,n));let i=$(this.mod,e,n);return gt(this.mod),i}getFeatureFlags(){return this.mod.ccall("duckdb_web_get_feature_flags","number",[],[])}tokenize(t){let[e,n,i]=at(this.mod,"duckdb_web_tokenize",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=$(this.mod,n,i);return gt(this.mod),JSON.parse(s)}connect(){let t=this.mod.ccall("duckdb_web_connect","number",[],[]);return new hc(this,t)}disconnect(t){if(this.mod.ccall("duckdb_web_disconnect",null,["number"],[t]),this.pthread)for(let e of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])e.postMessage({cmd:"dropUDFFunctions",connectionId:t})}runQuery(t,e){let[n,i,s]=at(this.mod,"duckdb_web_query_run",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));let o=Qn(this.mod,i,s);return gt(this.mod),o}sendQuery(t,e){let[n,i,s]=at(this.mod,"duckdb_web_query_send",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));let o=Qn(this.mod,i,s);return gt(this.mod),o}fetchQueryResults(t){let[e,n,i]=at(this.mod,"duckdb_web_query_fetch_results",["number"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=Qn(this.mod,n,i);return gt(this.mod),s}getTableNames(t,e){let[n,i,s]=at(this.mod,"duckdb_web_get_tablenames",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));let o=$(this.mod,i,s);return gt(this.mod),JSON.parse(o)}createScalarFunction(t,e,n,i){let s={functionId:this._nextUDFId,name:e,returnType:Zn(n)},o={functionId:s.functionId,connectionId:t,name:e,returnType:n,func:i};this._nextUDFId+=1;let[u,a,h]=at(this.mod,"duckdb_web_udf_scalar_create",["number","string"],[t,JSON.stringify(s)]);if(u!==0)throw new Error($(this.mod,a,h));if(gt(this.mod),globalThis.DUCKDB_RUNTIME._udfFunctions=(globalThis.DUCKDB_RUNTIME._udfFunctions||new Map).set(o.functionId,o),this.pthread)for(let m of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])m.postMessage({cmd:"registerUDFFunction",udf:o})}createPrepared(t,e){let[n,i,s]=at(this.mod,"duckdb_web_prepared_create",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));return gt(this.mod),i}closePrepared(t,e){let[n,i,s]=at(this.mod,"duckdb_web_prepared_close",["number","number"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));gt(this.mod)}runPrepared(t,e,n){let[i,s,o]=at(this.mod,"duckdb_web_prepared_run",["number","number","string"],[t,e,JSON.stringify(n)]);if(i!==0)throw new Error($(this.mod,s,o));let u=Qn(this.mod,s,o);return gt(this.mod),u}sendPrepared(t,e,n){let[i,s,o]=at(this.mod,"duckdb_web_prepared_send",["number","number","string"],[t,e,JSON.stringify(n)]);if(i!==0)throw new Error($(this.mod,s,o));let u=Qn(this.mod,s,o);return gt(this.mod),u}insertArrowFromIPCStream(t,e,n){if(e.length==0)return;let i=this.mod._malloc(e.length);this.mod.HEAPU8.subarray(i,i+e.length).set(e);let o=n?JSON.stringify(n):"",[u,a,h]=at(this.mod,"duckdb_web_insert_arrow_from_ipc_stream",["number","number","number","string"],[t,i,e.length,o]);if(u!==0)throw new Error($(this.mod,a,h))}insertCSVFromPath(t,e,n){if(n.columns!==void 0){n.columnsFlat=[];for(let h in n.columns)n.columnsFlat.push(Ao(h,n.columns[h]))}let i=Rr({},n);i.columns=i.columnsFlat,delete i.columnsFlat;let s=JSON.stringify(i),[o,u,a]=at(this.mod,"duckdb_web_insert_csv_from_path",["number","string","string"],[t,e,s]);if(o!==0)throw new Error($(this.mod,u,a))}insertJSONFromPath(t,e,n){if(n.columns!==void 0){n.columnsFlat=[];for(let h in n.columns)n.columnsFlat.push(Ao(h,n.columns[h]))}let i=Rr({},n);i.columns=i.columnsFlat,delete i.columnsFlat;let s=JSON.stringify(i),[o,u,a]=at(this.mod,"duckdb_web_insert_json_from_path",["number","string","string"],[t,e,s]);if(o!==0)throw new Error($(this.mod,u,a))}globFiles(t){let[e,n,i]=at(this.mod,"duckdb_web_fs_glob_file_infos",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=$(this.mod,n,i);gt(this.mod);let o=JSON.parse(s);return o==null?[]:o}registerFileURL(t,e){e===void 0&&(e=t);let[n,i,s]=at(this.mod,"duckdb_web_fs_register_file_url",["string","string","number"],[t,e,-1]);if(n!==0)throw new Error($(this.mod,i,s));gt(this.mod)}registerFileText(t,e){let n=qy.encode(e);this.registerFileBuffer(t,n)}registerFileBuffer(t,e){let n=this.mod._malloc(e.length);this.mod.HEAPU8.subarray(n,n+e.length).set(e);let[s,o,u]=at(this.mod,"duckdb_web_fs_register_file_buffer",["string","number","number"],[t,n,e.length]);if(s!==0)throw new Error($(this.mod,o,u));gt(this.mod)}registerFileHandle(t,e){let[n,i,s]=at(this.mod,"duckdb_web_fs_register_file_url",["string","string","number"],[t,t,-1]);if(n!==0)throw new Error($(this.mod,i,s));if(gt(this.mod),globalThis.DUCKDB_RUNTIME._files=(globalThis.DUCKDB_RUNTIME._files||new Map).set(t,e),this.pthread){for(let o of this.pthread.runningWorkers)o.postMessage({cmd:"registerFileHandle",fileName:t,fileHandle:e});for(let o of this.pthread.unusedWorkers)o.postMessage({cmd:"dropFileHandle",fileName:t})}}dropFile(t){let[e,n,i]=at(this.mod,"duckdb_web_fs_drop_file",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));gt(this.mod)}dropFiles(){let[t,e,n]=at(this.mod,"duckdb_web_fs_drop_files",[],[]);if(t!==0)throw new Error($(this.mod,e,n));gt(this.mod)}flushFiles(){this.mod.ccall("duckdb_web_flush_files",null,[],[])}copyFileToPath(t,e){let[n,i,s]=at(this.mod,"duckdb_web_copy_file_to_path",["string","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));gt(this.mod)}copyFileToBuffer(t){let[e,n,i]=at(this.mod,"duckdb_web_copy_file_to_buffer",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=this.mod.HEAPU8.subarray(n,n+i),o=new Uint8Array(s.length);return o.set(s),gt(this.mod),o}collectFileStatistics(t,e){let[n,i,s]=at(this.mod,"duckdb_web_collect_file_stats",["string","boolean"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s))}exportFileStatistics(t){let[e,n,i]=at(this.mod,"duckdb_web_export_file_stats",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));return new _c(this.mod.HEAPU8.subarray(n,n+i))}};var bc=class extends yc{constructor(t,e,n,i){super(t,e);this.mainModuleURL=n,this.pthreadWorkerURL=i}locateFile(t,e){if(t.endsWith(".wasm"))return this.mainModuleURL;if(t.endsWith(".worker.js")){if(!this.pthreadWorkerURL)throw new Error("Missing DuckDB worker URL!");return this.pthreadWorkerURL}throw new Error(`WASM instantiation requested unexpected file: prefix=${e} path=${t}`)}instantiateWasm(t,e){globalThis.DUCKDB_RUNTIME=this._runtime;let n=this.onInstantiationProgress;if(typeof TransformStream=="function"&&ReadableStream.prototype.pipeThrough&&WebAssembly.instantiateStreaming){let s=(async()=>{var Z;let o=new Request(this.mainModuleURL),u=await fetch(o),a=u.headers.get("content-length"),h=a&&parseInt(a,10)||0,m=new Date,g={startedAt:m,updatedAt:m,bytesTotal:h||0,bytesLoaded:0},S={transform(X,ht){g.bytesLoaded+=X.byteLength;let lt=new Date;if(lt.getTime()-g.updatedAt.getTime()<20){g.updatedAt=lt,ht.enqueue(X);return}for(let vt of n)vt(g);ht.enqueue(X)}},I=new TransformStream(S);return new Response((Z=u.body)==null?void 0:Z.pipeThrough(I),u)})();WebAssembly.instantiateStreaming(s,t).then(o=>{e(o.instance,o.module)})}else{let i=new XMLHttpRequest,s=this.mainModuleURL,o=new Date,u={startedAt:o,updatedAt:o,bytesTotal:0,bytesLoaded:0};i.open("GET",s),i.responseType="arraybuffer",i.onerror=a=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to load WASM: "+a}),new Error(a.toString())},i.onprogress=a=>{u.bytesTotal=a.total,u.bytesLoaded=a.loaded;let h=new Date;if(h.getTime()-u.updatedAt.getTime()<20){u.updatedAt=h;return}for(let m of n)m(u)},i.onload=()=>{WebAssembly.instantiate(i.response,t).then(a=>{e(a.instance,a.module)}).catch(a=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to instantiate WASM: "+a}),new Error(a)})},i.send()}return[]}};var gc=class extends bc{constructor(t,e,n,i=null){super(t,e,n,i)}instantiateImpl(t){return wf(hi(Rr({},t),{instantiateWasm:this.instantiateWasm.bind(this),locateFile:this.locateFile.bind(this)}))}};var nn=Ku(Ff()),Tf=function(r,t,e){var n;if((n=r==null?void 0:r.endpoint)!=null&&n.startsWith("http")){let i=`${r==null?void 0:r.endpoint}`,s=i.indexOf("://")+3;return i.substring(s)}else return r!=null&&r.endpoint?`${e}.${r==null?void 0:r.endpoint}`:`${e}.s3.amazonaws.com`};function Zy(r,t,e){var i,s,o,u;let n=Df(t);return{url:n.path,query:"",host:Tf(r,t,n.bucket),region:(i=r==null?void 0:r.region)!=null?i:"",service:"s3",method:e,accessKeyId:(s=r==null?void 0:r.accessKeyId)!=null?s:"",secretAccessKey:(o=r==null?void 0:r.secretAccessKey)!=null?o:"",sessionToken:(u=r==null?void 0:r.sessionToken)!=null?u:"",dateNow:new Date().toISOString().replace(/-/g,"").split("T")[0],datetimeNow:new Date().toISOString().replace(/-/g,"").replace(/:/g,"").split(".")[0]+"Z"}}function Qy(r,t=!1){let e="0123456789ABCDEF",n="";for(let i=0;i<r.length;i++){let s=r[i];s>="A"&&s<="Z"||s>="a"&&s<="z"||s>="0"&&s<="9"||s=="_"||s=="-"||s=="~"||s=="."?n+=s:s=="/"?t?n+="%2F":n+=s:(n+="%",n+=e[s.charCodeAt(0)>>4],n+=e[s.charCodeAt(0)&15])}return n}function tb(r,t=null){var Z;let e=(Z=t==null?void 0:t.contentHash)!=null?Z:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",n=new Map;n.set("x-amz-date",r.datetimeNow),n.set("x-amz-content-sha256",e),r.sessionToken&&n.set("x-amz-security-token",r.sessionToken);let i="";t!=null&&t.contentType&&(i+="content-type;"),i+="host;x-amz-content-sha256;x-amz-date",r.sessionToken&&(i+=";x-amz-security-token");let s=r.method+`
`+Qy(r.url)+`
`+r.query;t!=null&&t.contentType&&(s+=`
content-type:`+(t==null?void 0:t.contentType)),s+=`
host:`+r.host+`
x-amz-content-sha256:`+e+`
x-amz-date:`+r.datetimeNow,r.sessionToken&&r.sessionToken.length>0&&(s+=`
x-amz-security-token:`+r.sessionToken),s+=`

`+i+`
`+e;let o=(0,nn.sha256)(s),u=`AWS4-HMAC-SHA256
`+r.datetimeNow+`
`+r.dateNow+"/"+r.region+"/"+r.service+`/aws4_request
`+o,a="AWS4"+r.secretAccessKey,h=nn.sha256.hmac.arrayBuffer(a,r.dateNow),m=nn.sha256.hmac.arrayBuffer(h,r.region),g=nn.sha256.hmac.arrayBuffer(m,r.service),S=nn.sha256.hmac.arrayBuffer(g,"aws4_request"),I=nn.sha256.hmac(S,u);return n.set("Authorization","AWS4-HMAC-SHA256 Credential="+r.accessKeyId+"/"+r.dateNow+"/"+r.region+"/"+r.service+"/aws4_request, SignedHeaders="+i+", Signature="+I),n}var eb=function(r,t,e,n=null,i=null){let s=Zy(r,t,e),o={contentType:n,contentHash:i?nn.sha256.hex(i):null};return tb(s,o)};function sn(r,t,e,n,i=null,s=null){((t==null?void 0:t.accessKeyId)||(t==null?void 0:t.sessionToken))&&(eb(t,e,n,i,s).forEach((u,a)=>{r.setRequestHeader(a,u)}),i&&r.setRequestHeader("content-type",i))}function Df(r){if(r.indexOf("s3://")!=0)throw new Error("URL needs to start with s3://");let t=r.indexOf("/",5);if(t==-1)throw new Error("URL needs to contain a '/' after the host");let e=r.substring(5,t);if(!e)throw new Error("URL needs to contain a bucket name");let n=r.substring(t);if(!n)throw new Error("URL needs to contain key");return{bucket:e,path:n}}function on(r,t){var n;let e=Df(t);return(n=r==null?void 0:r.endpoint)!=null&&n.startsWith("http")?`${r==null?void 0:r.endpoint}/${e.bucket}`+e.path:"https://"+Tf(r,t,e.bucket)+e.path}var Ft={_files:new Map,_fileInfoCache:new Map,_udfFunctions:new Map,_globalFileInfo:null,getFileInfo(r,t){try{let e=Ft._fileInfoCache.get(t),[n,i,s]=at(r,"duckdb_web_fs_get_file_info_by_id",["number","number"],[t,(e==null?void 0:e.cacheEpoch)||0]);if(n!==0)return null;if(s===0)return e;let o=$(r,i,s);gt(r);let u=JSON.parse(o);if(u==null)return null;let a=hi(Rr({},u),{blob:null});return Ft._fileInfoCache.set(t,a),a}catch(e){return null}},getGlobalFileInfo(r){var t;try{let[e,n,i]=at(r,"duckdb_web_get_global_file_info",["number"],[((t=Ft._globalFileInfo)==null?void 0:t.cacheEpoch)||0]);if(e!==0)return null;if(i===0)return Ft._globalFileInfo;let s=$(r,n,i);gt(r);let o=JSON.parse(s);return o==null?null:(Ft._globalFileInfo=hi(Rr({},o),{blob:null}),Ft._globalFileInfo)}catch(e){return null}},testPlatformFeature:(r,t)=>{switch(t){case 1:return typeof BigInt64Array<"u";default:return console.warn(`test for unknown feature: ${t}`),!1}},openFile:(r,t,e)=>{var n;try{Ft._fileInfoCache.delete(t);let i=Ft.getFileInfo(r,t);switch(i==null?void 0:i.dataProtocol){case 3:case 4:{if(e&1&&e&2)throw new Error(`Opening file ${i.fileName} failed: cannot open file with both read and write flags set`);if(e&32)throw new Error(`Opening file ${i.fileName} failed: appending to HTTP/S3 files is not supported`);if(e&2){let o=new XMLHttpRequest;if(i.dataProtocol==4?(o.open("HEAD",on(i.s3Config,i.dataUrl),!1),sn(o,i.s3Config,i.dataUrl,"HEAD")):o.open("HEAD",i.dataUrl,!1),o.send(null),o.status!=200&&o.status!=404)throw new Error(`Opening file ${i.fileName} failed: Unexpected return status from server (${o.status})`);if(o.status==404&&!(e&8||e&16))throw new Error(`Opening file ${i.fileName} failed: Cannot write to non-existent file without FILE_FLAGS_FILE_CREATE or FILE_FLAGS_FILE_CREATE_NEW flag.`);let u=r._malloc(1),a=new Uint8Array;r.HEAPU8.set(a,u);let h=r._malloc(2*8);return r.HEAPF64[(h>>3)+0]=1,r.HEAPF64[(h>>3)+1]=u,h}else if(e!=1)throw new Error(`Opening file ${i.fileName} failed: unsupported file flags: ${e}`);let s=null;try{let o=new XMLHttpRequest;i.dataProtocol==4?(o.open("HEAD",on(i.s3Config,i.dataUrl),!1),sn(o,i.s3Config,i.dataUrl,"HEAD")):o.open("HEAD",i.dataUrl,!1),o.setRequestHeader("Range","bytes=0-"),o.send(null);let u=o.getResponseHeader("Content-Length");if(o.status==206&&u!==null){let a=r._malloc(16);return r.HEAPF64[(a>>3)+0]=+u,r.HEAPF64[(a>>3)+1]=0,a}}catch(o){s=o,console.warn(`HEAD request with range header failed: ${o}`)}if(i.allowFullHttpReads){console.warn(`falling back to full HTTP read for: ${i.dataUrl}`);let o=new XMLHttpRequest;if(i.dataProtocol==4?(o.open("GET",on(i.s3Config,i.dataUrl),!1),sn(o,i.s3Config,i.dataUrl,"GET")):o.open("GET",i.dataUrl,!1),o.responseType="arraybuffer",o.send(null),o.status==200){let u=r._malloc(o.response.byteLength),a=new Uint8Array(o.response,0,o.response.byteLength);r.HEAPU8.set(a,u);let h=r._malloc(2*8);return r.HEAPF64[(h>>3)+0]=o.response.byteLength,r.HEAPF64[(h>>3)+1]=u,h}}if(s!=null)throw new Error(`Reading file ${i.fileName} failed with error: ${s}`);return 0}case 1:{let s=(n=Ft._files)==null?void 0:n.get(i.fileName);if(s){let a=r._malloc(16);return r.HEAPF64[(a>>3)+0]=s.size,r.HEAPF64[(a>>3)+1]=0,a}console.warn(`Buffering missing file: ${i.fileName}`);let o=r._malloc(2*8),u=r._malloc(1);return r.HEAPF64[(o>>3)+0]=1,r.HEAPF64[(o>>3)+1]=u,o}}}catch(i){console.error(i.toString()),fr(r,i.toString())}return 0},glob:(r,t,e)=>{try{let n=$(r,t,e);if(n.startsWith("http")||n.startsWith("s3://")){let i=new XMLHttpRequest;if(n.startsWith("s3://")){let s=Ft.getGlobalFileInfo(r);i.open("HEAD",on(s==null?void 0:s.s3Config,n),!1),sn(i,s==null?void 0:s.s3Config,n,"HEAD")}else i.open("HEAD",n,!1);if(i.send(null),i.status!=200&&i.status!==206){fr(r,`HEAD request failed: ${n}`);return}r.ccall("duckdb_web_fs_glob_add_path",null,["string"],[n])}}catch(n){return fr(r,n.toString()),0}},checkFile:(r,t,e)=>{try{let n=$(r,t,e);if(n.startsWith("http")||n.startsWith("s3://")){let i=new XMLHttpRequest;if(n.startsWith("s3://")){let o=Ft.getGlobalFileInfo(r);i.open("HEAD",on(o==null?void 0:o.s3Config,n),!1),sn(i,o==null?void 0:o.s3Config,n,"HEAD")}else i.open("HEAD",n,!1);i.setRequestHeader("Range","bytes=0-"),i.send(null);let s=!1;if(i.status==206)s=!0;else if(i.status==200)s=i.getResponseHeader("Accept-Ranges")==="bytes";else return!1;return!!s}}catch(n){return!1}return!1},syncFile:(r,t)=>{},closeFile:(r,t)=>{let e=Ft.getFileInfo(r,t);switch(Ft._fileInfoCache.delete(t),e==null?void 0:e.dataProtocol){case 3:case 4:break;case 1:return}},truncateFile:(r,t,e)=>{let n=Ft.getFileInfo(r,t);switch(n==null?void 0:n.dataProtocol){case 3:fr(r,"Cannot truncate a http file");return;case 4:fr(r,"Cannot truncate an s3 file");return;case 1:fr(r,"truncateFile not implemented");return}return 0},readFile(r,t,e,n,i){var s;try{let o=Ft.getFileInfo(r,t);switch(o==null?void 0:o.dataProtocol){case 3:case 4:{if(!o.dataUrl)throw new Error(`Missing data URL for file ${t}`);try{let u=new XMLHttpRequest;if(o.dataProtocol==4?(u.open("GET",on(o==null?void 0:o.s3Config,o.dataUrl),!1),sn(u,o==null?void 0:o.s3Config,o.dataUrl,"GET")):u.open("GET",o.dataUrl,!1),u.responseType="arraybuffer",u.setRequestHeader("Range",`bytes=${i}-${i+n-1}`),u.send(null),u.status==206||u.status==200&&n==u.response.byteLength&&i==0){let a=new Uint8Array(u.response,0,Math.min(u.response.byteLength,n));return r.HEAPU8.set(a,e),a.byteLength}else throw u.status==200?new Error(`Range request for ${o.dataUrl} did not return a partial response: ${u.status} "${u.statusText}"`):new Error(`Range request for ${o.dataUrl} did returned non-success status: ${u.status} "${u.statusText}"`)}catch(u){throw new Error(`Range request for ${o.dataUrl} failed with error: ${u}"`)}}case 1:{let u=(s=Ft._files)==null?void 0:s.get(o.fileName);if(!u)throw new Error(`No handle available for file: ${o.fileName}`);let a=u.slice(i,i+n),h=new Uint8Array(new FileReaderSync().readAsArrayBuffer(a));return r.HEAPU8.set(h,e),h.byteLength}}return 0}catch(o){return fr(r,o.toString()),0}},writeFile:(r,t,e,n,i)=>{let s=Ft.getFileInfo(r,t);switch(s==null?void 0:s.dataProtocol){case 3:return fr(r,"Cannot write to HTTP file"),0;case 4:{let o=r.HEAPU8.subarray(e,e+n),u=new XMLHttpRequest;return u.open("PUT",on(s==null?void 0:s.s3Config,s.dataUrl),!1),sn(u,s==null?void 0:s.s3Config,s.dataUrl,"PUT","",o),u.send(o),n}case 1:return fr(r,"writefile not implemented"),0}return 0},getLastFileModificationTime:(r,t)=>{var n;let e=Ft.getFileInfo(r,t);switch(e==null?void 0:e.dataProtocol){case 1:{if(!((n=Ft._files)==null?void 0:n.get(e.fileName)))throw Error(`No handle available for file: ${e.fileName}`);return 0}case 3:case 4:return new Date().getTime()}return 0},checkDirectory:(r,t,e)=>{let n=$(r,t,e);return console.log(`checkDirectory: ${n}`),!1},createDirectory:(r,t,e)=>{let n=$(r,t,e);console.log(`createDirectory: ${n}`)},removeDirectory:(r,t,e)=>{let n=$(r,t,e);console.log(`removeDirectory: ${n}`)},listDirectoryEntries:(r,t,e)=>{let n=$(r,t,e);return console.log(`listDirectoryEntries: ${n}`),!1},moveFile:(r,t,e,n,i)=>{},removeFile:(r,t,e)=>{},callScalarUDF:(r,t,e,n,i,s,o)=>{Bf(Ft,r,t,e,n,i,s,o)}};var Ef=class extends lc{postMessage(t,e){globalThis.postMessage(t,e)}async instantiate(t,e,n){return await new gc(this,Ft,t,e).instantiate(n)}};function Of(){let r=new Ef;globalThis.onmessage=async t=>{await r.onMessage(t.data)}}Of();return fm(rb);})();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
//# sourceMappingURL=duckdb-browser-coi.worker.js.map
